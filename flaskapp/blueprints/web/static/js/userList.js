webpackJsonp([1],{319:function(e,t,r){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var n=r(1),a=s(n),u=r(10),o=r(7);r(17),r(18);var l=r(8),i=r(320),c=s(i),d=r(19),p=s(d),f=r(321),h=s(f),m=r(20),E=(0,m.configureStore)({auth:p.default,userList:h.default}),g=(0,l.layout)({comp:c.default,forAuth:!0});(0,u.render)(a.default.createElement(o.Provider,{store:E},a.default.createElement(g,null)),document.getElementById("root"))},320:function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),l=r(1),i=function(e){return e&&e.__esModule?e:{default:e}}(l),c=r(7),d=r(23),p=r(29),f=r(8),h=function(e){function t(){return s(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"friendRequest",value:function(e){return e.preventDefault(),this.props.friendRequest(this.props.user.id)}},{key:"friendRemove",value:function(e){return e.preventDefault(),this.props.friendRemove(this.props.user.id)}},{key:"render",value:function(){var e=this.props.user.online?"success":"active",t=null;return t=null!==this.props.user.selfFriendId&&null!==this.props.user.friendUserId?i.default.createElement("button",{className:"btn btn-default",onClick:this.friendRemove.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-minus"}),"  Remove from friends"):null!==this.props.user.selfFriendId?i.default.createElement("button",{className:"btn btn-default",onClick:this.friendRequest.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-plus"}),"  Approve friend"):null!==this.props.user.friendUserId?i.default.createElement("button",{disabled:!0,className:"btn btn-default",onClick:this.friendRequest.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-plus"}),"  Add to friends"):i.default.createElement("button",{className:"btn btn-default",onClick:this.friendRequest.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-plus"}),"  Add to friends"),i.default.createElement("tr",{className:e},i.default.createElement("td",null,i.default.createElement("span",{className:"glyphicon glyphicon-user"})," ",i.default.createElement("span",null,this.props.user.login)),i.default.createElement("td",null,this.props.user.dtActive),i.default.createElement("td",{className:"text-right"},t," ",i.default.createElement("button",{className:"btn btn-default"},i.default.createElement("span",{className:"glyphicon glyphicon-envelope"}),"  Send message")))}}]),t}(i.default.Component),m=function(e){function t(e){s(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={start:r.props.userList.start,users:r.props.userList.users},r}return a(t,e),o(t,[{key:"componentWillMount",value:function(){this.changePage(this.props.userList.start)}},{key:"changePage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.props.dispatch((0,d.graphql)({type:"USER_LIST",start:e,perpage:this.props.userList.perpage}))}},{key:"friendRequest",value:function(e){this.props.dispatch((0,d.graphql)({type:"FRIEND_REQUEST",id:e}))}},{key:"friendRemove",value:function(e){this.props.dispatch((0,d.graphql)({type:"FRIEND_REMOVE",id:e}))}},{key:"getUserItems",value:function(){var e=this,t=(0,p.map)(this.props.userList.users,function(t){return i.default.createElement(h,{user:t,friendRequest:e.friendRequest.bind(e),friendRemove:e.friendRemove.bind(e)})});return i.default.createElement("table",{className:"table table-hover"},i.default.createElement("tbody",null,t))}},{key:"render",value:function(){var e=null;"error"==this.props.userList.status?e={className:"danger",text:this.props.userList.error}:"send"===this.props.userList.status&&(e={className:"info",text:"Loading, please wait"});var t={start:this.props.userList.start,perpage:this.props.userList.perpage,count:this.props.userList.count,items:this.getUserItems(),changePage:this.changePage.bind(this)};return i.default.createElement("div",null,i.default.createElement(f.AlertMessage,{opts:e}),i.default.createElement(f.PaginatorLayout,{param:t}))}}]),t}(i.default.Component),E=function(e){return u({},e)};m=(0,c.connect)(E)(m),t.default=m},321:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},n=r(29),a={userId:window.localParams.userId?parseInt(window.localParams.userId):null,start:window.localParams.start?parseInt(window.localParams.start):0,perpage:window.localParams.perpage?parseInt(window.localParams.perpage):9,users:[],count:0,status:null,error:null},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];console.log("state",e,"action",t);var r=s({},e);switch(t.type){case"USER_LIST_SEND":return r.start=t.start,r.status="send",r;case"USER_LIST_SUCCESS":return r.status="success",r.users=t.data.getUserList.users,r.count=t.data.getUserList.count,r;case"USER_LIST_ERROR":return r.status="error",r.error=t.error,r;case"FRIEND_REQUEST_SEND":return r.status="send",r;case"FRIEND_REQUEST_SUCCESS":return r.status="success",(0,n.forEach)(r.users,function(e){parseInt(e.id)==t.data.friendRequest.friendId&&(e.friendUserId=t.data.friendRequest.userId)}),r;case"FRIEND_REQUEST_ERROR":return r.status="error",r;case"FRIEND_REMOVE_SEND":return r.status="send",r;case"FRIEND_REMOVE_SUCCESS":return r.status="success",(0,n.forEach)(r.users,function(e){console.log("action.data.friendRemove.id",t.data.friendRemove.id),parseInt(e.id)==t.data.friendRemove.friendId&&(e.friendUserId=null)}),r;case"FRIEND_REMOVE_ERROR":return r.status="error",r;default:return e}};t.default=u}},[319]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vdXNlckxpc3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy91c2VyTGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL3VzZXIvTGlzdENvbXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy91c2VyL0xpc3RSZWQuanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wIiwiMzE5IiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfcmVhY3QiLCJfcmVhY3QyIiwiX3JlYWN0RG9tIiwiX3JlYWN0UmVkdXgiLCJfY29tcG9uZW50IiwiX0xpc3RDb21wIiwiX0xpc3RDb21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfTGlzdFJlZCIsIl9MaXN0UmVkMiIsIl9jb25maWd1cmVTdG9yZSIsInN0b3JlIiwiY29uZmlndXJlU3RvcmUiLCJhdXRoIiwidXNlckxpc3QiLCJDb21wIiwibGF5b3V0IiwiY29tcCIsIkxpc3RDb21wIiwiZm9yQXV0aCIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJQcm92aWRlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCIzMjAiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiZGVmaW5lUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzb3VyY2UiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfYWN0aW9uIiwiX2xvZGFzaCIsIlVzZXJJdGVtQ29tcCIsIl9SZWFjdCRDb21wb25lbnQiLCJ0aGlzIiwiZ2V0UHJvdG90eXBlT2YiLCJhcHBseSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZyaWVuZFJlcXVlc3QiLCJ1c2VyIiwiaWQiLCJmcmllbmRSZW1vdmUiLCJ0ZXh0Q2xhc3MiLCJvbmxpbmUiLCJmcmllbmRCdG4iLCJzZWxmRnJpZW5kSWQiLCJmcmllbmRVc2VySWQiLCJjbGFzc05hbWUiLCJvbkNsaWNrIiwiYmluZCIsImRpc2FibGVkIiwibG9naW4iLCJkdEFjdGl2ZSIsIlJlYWN0IiwiQ29tcG9uZW50IiwiVXNlckxpc3RDb21wIiwiX1JlYWN0JENvbXBvbmVudDIiLCJfdGhpczIiLCJzdGF0ZSIsInN0YXJ0IiwidXNlcnMiLCJjaGFuZ2VQYWdlIiwidW5kZWZpbmVkIiwiZGlzcGF0Y2giLCJncmFwaHFsIiwidHlwZSIsInBlcnBhZ2UiLCJfdGhpczMiLCJpdGVtcyIsIm1hcCIsImFsZXJ0T3B0cyIsInN0YXR1cyIsInRleHQiLCJlcnJvciIsInBhZ2VyUGFyYW0iLCJjb3VudCIsImdldFVzZXJJdGVtcyIsIkFsZXJ0TWVzc2FnZSIsIm9wdHMiLCJQYWdpbmF0b3JMYXlvdXQiLCJwYXJhbSIsIm1hcFN0YXRlVG9Qcm9wcyIsImNvbm5lY3QiLCIzMjEiLCJpbml0U3RhdGUiLCJ1c2VySWQiLCJ3aW5kb3ciLCJsb2NhbFBhcmFtcyIsInBhcnNlSW50IiwiYWN0aW9uIiwiY29uc29sZSIsImxvZyIsImRhdGEiLCJnZXRVc2VyTGlzdCIsImZvckVhY2giLCJ1IiwiZnJpZW5kSWQiXSwibWFwcGluZ3MiOiJB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QixDQUVYLFNBQ0ksTUFBT2xDLElIK1RuQm5HLEdBQVFLLFFHM1RPZ0IsS0grVFoiLCJmaWxlIjoidXNlckxpc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ3ZWJwYWNrSnNvbnAoWzFdLHtcblxuLyoqKi8gMzE5OlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfcmVhY3REb20gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7XG5cbl9fd2VicGFja19yZXF1aXJlX18oMTgpO1xuXG52YXIgX2NvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cbnZhciBfTGlzdENvbXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyMCk7XG5cbnZhciBfTGlzdENvbXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTGlzdENvbXApO1xuXG52YXIgX0xvZ2luUmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7XG5cbnZhciBfTG9naW5SZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTG9naW5SZWQpO1xuXG52YXIgX0xpc3RSZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyMSk7XG5cbnZhciBfTGlzdFJlZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9MaXN0UmVkKTtcblxudmFyIF9jb25maWd1cmVTdG9yZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjApO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgc3RvcmUgPSAoMCwgX2NvbmZpZ3VyZVN0b3JlLmNvbmZpZ3VyZVN0b3JlKSh7XG5cdGF1dGg6IF9Mb2dpblJlZDIuZGVmYXVsdCxcblx0dXNlckxpc3Q6IF9MaXN0UmVkMi5kZWZhdWx0XG59KTtcblxudmFyIENvbXAgPSAoMCwgX2NvbXBvbmVudC5sYXlvdXQpKHsgY29tcDogX0xpc3RDb21wMi5kZWZhdWx0LCBmb3JBdXRoOiB0cnVlIH0pO1xuKDAsIF9yZWFjdERvbS5yZW5kZXIpKF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuXHRfcmVhY3RSZWR1eC5Qcm92aWRlcixcblx0eyBzdG9yZTogc3RvcmUgfSxcblx0X3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tcCwgbnVsbClcbiksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzIwOlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxudmFyIF9hY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTtcblxudmFyIF9sb2Rhc2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTtcblxudmFyIF9jb21wb25lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8vIG9uZSB1c2VyIHJvd1xudmFyIFVzZXJJdGVtQ29tcCA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gICAgX2luaGVyaXRzKFVzZXJJdGVtQ29tcCwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgICBmdW5jdGlvbiBVc2VySXRlbUNvbXAoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBVc2VySXRlbUNvbXApO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVXNlckl0ZW1Db21wLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVXNlckl0ZW1Db21wKSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFVzZXJJdGVtQ29tcCwgW3tcbiAgICAgICAga2V5OiAnZnJpZW5kUmVxdWVzdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmcmllbmRSZXF1ZXN0KGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmZyaWVuZFJlcXVlc3QodGhpcy5wcm9wcy51c2VyLmlkKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZnJpZW5kUmVtb3ZlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZyaWVuZFJlbW92ZShlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5mcmllbmRSZW1vdmUodGhpcy5wcm9wcy51c2VyLmlkKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0Q2xhc3MgPSB0aGlzLnByb3BzLnVzZXIub25saW5lID8gJ3N1Y2Nlc3MnIDogJ2FjdGl2ZSc7XG4gICAgICAgICAgICB2YXIgZnJpZW5kQnRuID0gbnVsbDtcbiAgICAgICAgICAgIC8vIGlmIGJvdGggdXNlcnMgc2VuZGVkIGZyaWVuZCByZXF1ZXN0c1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMudXNlci5zZWxmRnJpZW5kSWQgIT09IG51bGwgJiYgdGhpcy5wcm9wcy51c2VyLmZyaWVuZFVzZXJJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGZyaWVuZEJ0biA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAnYnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdidG4gYnRuLWRlZmF1bHQnLCBvbkNsaWNrOiB0aGlzLmZyaWVuZFJlbW92ZS5iaW5kKHRoaXMpIH0sXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdnbHlwaGljb24gZ2x5cGhpY29uLW1pbnVzJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgJ1xceEEwIFJlbW92ZSBmcm9tIGZyaWVuZHMnXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmIHRoaXMgcm93IHNlbmRlZCByZXF1ZXN0IHRvIGN1cnJlbnQgdXNlclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wcm9wcy51c2VyLnNlbGZGcmllbmRJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBmcmllbmRCdG4gPSBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdidG4gYnRuLWRlZmF1bHQnLCBvbkNsaWNrOiB0aGlzLmZyaWVuZFJlcXVlc3QuYmluZCh0aGlzKSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tcGx1cycgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAnXFx4QTAgQXBwcm92ZSBmcmllbmQnXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGlmIGN1cnJlbnQgdXNlciBzZW5kZWQgcmVxdWVzdCB0byBjdXJyZW50IHJvd1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucHJvcHMudXNlci5mcmllbmRVc2VySWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyaWVuZEJ0biA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgZGlzYWJsZWQ6IHRydWUsIGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCcsIG9uQ2xpY2s6IHRoaXMuZnJpZW5kUmVxdWVzdC5iaW5kKHRoaXMpIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tcGx1cycgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xceEEwIEFkZCB0byBmcmllbmRzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyaWVuZEJ0biA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnYnRuIGJ0bi1kZWZhdWx0Jywgb25DbGljazogdGhpcy5mcmllbmRSZXF1ZXN0LmJpbmQodGhpcykgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAnZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFx4QTAgQWRkIHRvIGZyaWVuZHMnXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAndHInLFxuICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiB0ZXh0Q2xhc3MgfSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgJ3RkJyxcbiAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tdXNlcicgfSksXG4gICAgICAgICAgICAgICAgICAgICdcXHhBMCcsXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3NwYW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudXNlci5sb2dpblxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgJ3RkJyxcbiAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy51c2VyLmR0QWN0aXZlXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgJ3RkJyxcbiAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICd0ZXh0LXJpZ2h0JyB9LFxuICAgICAgICAgICAgICAgICAgICBmcmllbmRCdG4sXG4gICAgICAgICAgICAgICAgICAgICdcXHhBMCcsXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCcgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdnbHlwaGljb24gZ2x5cGhpY29uLWVudmVsb3BlJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdcXHhBMCBTZW5kIG1lc3NhZ2UnXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFVzZXJJdGVtQ29tcDtcbn0oX3JlYWN0Mi5kZWZhdWx0LkNvbXBvbmVudCk7XG5cbi8vIGxpc3Qgb2YgdXNlcnNcblxuXG52YXIgVXNlckxpc3RDb21wID0gZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQyKSB7XG4gICAgX2luaGVyaXRzKFVzZXJMaXN0Q29tcCwgX1JlYWN0JENvbXBvbmVudDIpO1xuXG4gICAgZnVuY3Rpb24gVXNlckxpc3RDb21wKHByb3BzKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBVc2VyTGlzdENvbXApO1xuXG4gICAgICAgIHZhciBfdGhpczIgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVXNlckxpc3RDb21wLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVXNlckxpc3RDb21wKSkuY2FsbCh0aGlzLCBwcm9wcykpO1xuXG4gICAgICAgIF90aGlzMi5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBfdGhpczIucHJvcHMudXNlckxpc3Quc3RhcnQsXG4gICAgICAgICAgICB1c2VyczogX3RoaXMyLnByb3BzLnVzZXJMaXN0LnVzZXJzXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpczI7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFVzZXJMaXN0Q29tcCwgW3tcbiAgICAgICAga2V5OiAnY29tcG9uZW50V2lsbE1vdW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlUGFnZSh0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXJ0KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY2hhbmdlUGFnZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjaGFuZ2VQYWdlKCkge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwO1xuXG4gICAgICAgICAgICB0aGlzLnByb3BzLmRpc3BhdGNoKCgwLCBfYWN0aW9uLmdyYXBocWwpKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnVVNFUl9MSVNUJyxcbiAgICAgICAgICAgICAgICBzdGFydDogc3RhcnQsXG4gICAgICAgICAgICAgICAgcGVycGFnZTogdGhpcy5wcm9wcy51c2VyTGlzdC5wZXJwYWdlXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2ZyaWVuZFJlcXVlc3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZnJpZW5kUmVxdWVzdChpZCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaCgoMCwgX2FjdGlvbi5ncmFwaHFsKSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0ZSSUVORF9SRVFVRVNUJyxcbiAgICAgICAgICAgICAgICBpZDogaWRcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZnJpZW5kUmVtb3ZlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZyaWVuZFJlbW92ZShpZCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaCgoMCwgX2FjdGlvbi5ncmFwaHFsKSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0ZSSUVORF9SRU1PVkUnLFxuICAgICAgICAgICAgICAgIGlkOiBpZFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRVc2VySXRlbXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VXNlckl0ZW1zKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBpdGVtcyA9ICgwLCBfbG9kYXNoLm1hcCkodGhpcy5wcm9wcy51c2VyTGlzdC51c2VycywgZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoVXNlckl0ZW1Db21wLCB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHVzZXIsXG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZFJlcXVlc3Q6IF90aGlzMy5mcmllbmRSZXF1ZXN0LmJpbmQoX3RoaXMzKSxcbiAgICAgICAgICAgICAgICAgICAgZnJpZW5kUmVtb3ZlOiBfdGhpczMuZnJpZW5kUmVtb3ZlLmJpbmQoX3RoaXMzKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAndGFibGUnLFxuICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAndGFibGUgdGFibGUtaG92ZXInIH0sXG4gICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICd0Ym9keScsXG4gICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgICAgIHZhciBhbGVydE9wdHMgPSBudWxsO1xuICAgICAgICAgICAgdmFyIHVzZXJzID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMudXNlckxpc3Quc3RhdHVzID09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2RhbmdlcicsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMudXNlckxpc3QuZXJyb3JcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXR1cyA9PT0gJ3NlbmQnKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdpbmZvJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYWdlclBhcmFtID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiB0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXJ0LFxuICAgICAgICAgICAgICAgIHBlcnBhZ2U6IHRoaXMucHJvcHMudXNlckxpc3QucGVycGFnZSxcbiAgICAgICAgICAgICAgICBjb3VudDogdGhpcy5wcm9wcy51c2VyTGlzdC5jb3VudCxcbiAgICAgICAgICAgICAgICBpdGVtczogdGhpcy5nZXRVc2VySXRlbXMoKSxcbiAgICAgICAgICAgICAgICBjaGFuZ2VQYWdlOiB0aGlzLmNoYW5nZVBhZ2UuYmluZCh0aGlzKVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudC5BbGVydE1lc3NhZ2UsIHsgb3B0czogYWxlcnRPcHRzIH0pLFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnQuUGFnaW5hdG9yTGF5b3V0LCB7IHBhcmFtOiBwYWdlclBhcmFtIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFVzZXJMaXN0Q29tcDtcbn0oX3JlYWN0Mi5kZWZhdWx0LkNvbXBvbmVudCk7XG5cbnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoc3RhdGUpIHtcbiAgICByZXR1cm4gX2V4dGVuZHMoe30sIHN0YXRlKTtcbn07XG5Vc2VyTGlzdENvbXAgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFwU3RhdGVUb1Byb3BzKShVc2VyTGlzdENvbXApO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBVc2VyTGlzdENvbXA7XG5cbi8qKiovIH0pLFxuXG4vKioqLyAzMjE6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxudmFyIF9sb2Rhc2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTtcblxudmFyIGluaXRTdGF0ZSA9IHtcbiAgICB1c2VySWQ6IHdpbmRvdy5sb2NhbFBhcmFtcy51c2VySWQgPyBwYXJzZUludCh3aW5kb3cubG9jYWxQYXJhbXMudXNlcklkKSA6IG51bGwsXG4gICAgc3RhcnQ6IHdpbmRvdy5sb2NhbFBhcmFtcy5zdGFydCA/IHBhcnNlSW50KHdpbmRvdy5sb2NhbFBhcmFtcy5zdGFydCkgOiAwLFxuICAgIHBlcnBhZ2U6IHdpbmRvdy5sb2NhbFBhcmFtcy5wZXJwYWdlID8gcGFyc2VJbnQod2luZG93LmxvY2FsUGFyYW1zLnBlcnBhZ2UpIDogOSxcbiAgICB1c2VyczogW10sXG4gICAgY291bnQ6IDAsXG4gICAgc3RhdHVzOiBudWxsLFxuICAgIGVycm9yOiBudWxsXG59O1xudmFyIHVzZXJMaXN0ID0gZnVuY3Rpb24gdXNlckxpc3QoKSB7XG4gICAgdmFyIHN0YXRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBpbml0U3RhdGU7XG4gICAgdmFyIGFjdGlvbiA9IGFyZ3VtZW50c1sxXTtcblxuICAgIGNvbnNvbGUubG9nKCdzdGF0ZScsIHN0YXRlLCAnYWN0aW9uJywgYWN0aW9uKTtcblxuICAgIHZhciBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ1VTRVJfTElTVF9TRU5EJzpcbiAgICAgICAgICAgIGRhdGEuc3RhcnQgPSBhY3Rpb24uc3RhcnQ7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdVU0VSX0xJU1RfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgIGRhdGEudXNlcnMgPSBhY3Rpb24uZGF0YS5nZXRVc2VyTGlzdC51c2VycztcbiAgICAgICAgICAgIGRhdGEuY291bnQgPSBhY3Rpb24uZGF0YS5nZXRVc2VyTGlzdC5jb3VudDtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdVU0VSX0xJU1RfRVJST1InOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRVFVRVNUX1NFTkQnOlxuICAgICAgICAgICAgLy8gZGF0YS5zdGFydCA9IGFjdGlvbi5zdGFydDtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3NlbmQnO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRVFVRVNUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gICAgICAgICAgICAoMCwgX2xvZGFzaC5mb3JFYWNoKShkYXRhLnVzZXJzLCBmdW5jdGlvbiAodSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCh1LmlkKSA9PSBhY3Rpb24uZGF0YS5mcmllbmRSZXF1ZXN0LmZyaWVuZElkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgc2VsZkZyaWVuZElkID0gZ3JhcGhlbmUuSW50KClcbiAgICAgICAgICAgICAgICAgICAgZnJpZW5kVXNlcklkID0gZ3JhcGhlbmUuSW50KClcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgLy8gdS5zZWxmRnJpZW5kSWQgPSBhY3Rpb24uZGF0YS5mcmllbmRSZXF1ZXN0LmlkXG4gICAgICAgICAgICAgICAgICAgIHUuZnJpZW5kVXNlcklkID0gYWN0aW9uLmRhdGEuZnJpZW5kUmVxdWVzdC51c2VySWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGRhdGEudXNlcnMgPSBhY3Rpb24uZGF0YS5nZXRVc2VyTGlzdC51c2VycztcbiAgICAgICAgICAgIC8vIGRhdGEuY291bnQgPSBhY3Rpb24uZGF0YS5nZXRVc2VyTGlzdC5jb3VudDtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdGUklFTkRfUkVRVUVTVF9FUlJPUic6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdlcnJvcic7XG4gICAgICAgICAgICAvLyBkYXRhLmVycm9yID0gYWN0aW9uLmVycm9yO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG5cbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFTU9WRV9TRU5EJzpcbiAgICAgICAgICAgIC8vIGRhdGEuc3RhcnQgPSBhY3Rpb24uc3RhcnQ7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdGUklFTkRfUkVNT1ZFX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gICAgICAgICAgICAoMCwgX2xvZGFzaC5mb3JFYWNoKShkYXRhLnVzZXJzLCBmdW5jdGlvbiAodSkge1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FjdGlvbi5kYXRhLmZyaWVuZFJlbW92ZS5pZCcsIGFjdGlvbi5kYXRhLmZyaWVuZFJlbW92ZS5pZCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQodS5pZCkgPT0gYWN0aW9uLmRhdGEuZnJpZW5kUmVtb3ZlLmZyaWVuZElkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgc2VsZkZyaWVuZElkID0gZ3JhcGhlbmUuSW50KClcbiAgICAgICAgICAgICAgICAgICAgZnJpZW5kVXNlcklkID0gZ3JhcGhlbmUuSW50KClcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgdS5mcmllbmRVc2VySWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRU1PVkVfRVJST1InOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgLy8gZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gdXNlckxpc3Q7XG5cbi8qKiovIH0pXG5cbn0sWzMxOV0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB1c2VyTGlzdC5qcyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJ3JlYWN0LWRvbSdcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAncmVhY3QtcmVkdXgnXG5cbmltcG9ydCAnYm9vdHN0cmFwL2Rpc3QvY3NzL2Jvb3RzdHJhcC5jc3MnO1xuaW1wb3J0ICcuL3N0eWxlcy9pbmRleC5zY3NzJ1xuXG5pbXBvcnQge2xheW91dH0gZnJvbSAnLi9oZWxwZXJzL2NvbXBvbmVudCdcbmltcG9ydCBMaXN0Q29tcCBmcm9tICcuL3VzZXIvTGlzdENvbXAnXG5cbmltcG9ydCBhdXRoIGZyb20gJy4vYXV0aC9Mb2dpblJlZCdcbmltcG9ydCB1c2VyTGlzdCBmcm9tICcuL3VzZXIvTGlzdFJlZCdcblxuaW1wb3J0IHtjb25maWd1cmVTdG9yZX0gZnJvbSAnLi9oZWxwZXJzL2NvbmZpZ3VyZVN0b3JlJ1xuXG5sZXQgc3RvcmUgPSBjb25maWd1cmVTdG9yZSh7XG5cdGF1dGg6IGF1dGgsXG5cdHVzZXJMaXN0OiB1c2VyTGlzdCxcbn0pO1xuXG5sZXQgQ29tcCA9IGxheW91dCh7Y29tcDogTGlzdENvbXAsIGZvckF1dGg6IHRydWV9KTtcbnJlbmRlcihcblx0PFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XG5cdFx0PENvbXAgLz5cblx0PC9Qcm92aWRlcj4sXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JylcbilcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zdGF0aWNfc3JjL3VzZXJMaXN0LmpzIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgeyBncmFwaHFsIH0gZnJvbSAnLi4vaGVscGVycy9hY3Rpb24nO1xuaW1wb3J0IHttYXAsIGlzTnVtYmVyfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHtBbGVydE1lc3NhZ2UsIFBhZ2luYXRvckxheW91dH0gZnJvbSAnLi4vaGVscGVycy9jb21wb25lbnQnO1xuXG5cblxuXG4vLyBvbmUgdXNlciByb3dcbmNsYXNzIFVzZXJJdGVtQ29tcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgZnJpZW5kUmVxdWVzdCAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLmZyaWVuZFJlcXVlc3QodGhpcy5wcm9wcy51c2VyLmlkKTtcbiAgICB9XG4gICAgZnJpZW5kUmVtb3ZlIChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZnJpZW5kUmVtb3ZlKHRoaXMucHJvcHMudXNlci5pZCk7XG4gICAgfVxuICAgIHJlbmRlciAoKSB7XG4gICAgICAgIGxldCB0ZXh0Q2xhc3MgPSB0aGlzLnByb3BzLnVzZXIub25saW5lID8gJ3N1Y2Nlc3MnIDogJ2FjdGl2ZSc7XG4gICAgICAgIGxldCBmcmllbmRCdG4gPSBudWxsO1xuICAgICAgICAvLyBpZiBib3RoIHVzZXJzIHNlbmRlZCBmcmllbmQgcmVxdWVzdHNcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy5wcm9wcy51c2VyLnNlbGZGcmllbmRJZCAhPT0gbnVsbCAmJlxuICAgICAgICAgICAgdGhpcy5wcm9wcy51c2VyLmZyaWVuZFVzZXJJZCAhPT0gbnVsbFxuICAgICAgICApIHtcbiAgICAgICAgICAgIGZyaWVuZEJ0biA9IDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCIgb25DbGljaz17Ojp0aGlzLmZyaWVuZFJlbW92ZX0gPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImdseXBoaWNvbiBnbHlwaGljb24tbWludXNcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgUmVtb3ZlIGZyb20gZnJpZW5kc1xuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIH1cbiAgICAgICAgLy8gaWYgdGhpcyByb3cgc2VuZGVkIHJlcXVlc3QgdG8gY3VycmVudCB1c2VyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMucHJvcHMudXNlci5zZWxmRnJpZW5kSWQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGZyaWVuZEJ0biA9IDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCIgb25DbGljaz17Ojp0aGlzLmZyaWVuZFJlcXVlc3R9ID5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLXBsdXNcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgQXBwcm92ZSBmcmllbmRcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICB9XG4gICAgICAgIC8vIGlmIGN1cnJlbnQgdXNlciBzZW5kZWQgcmVxdWVzdCB0byBjdXJyZW50IHJvd1xuICAgICAgICBlbHNlIGlmICh0aGlzLnByb3BzLnVzZXIuZnJpZW5kVXNlcklkICE9PSBudWxsKSB7XG4gICAgICAgICAgICBmcmllbmRCdG4gPSA8YnV0dG9uIGRpc2FibGVkIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdFwiIG9uQ2xpY2s9ezo6dGhpcy5mcmllbmRSZXF1ZXN0fSA+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIEFkZCB0byBmcmllbmRzXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZyaWVuZEJ0biA9IDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCIgb25DbGljaz17Ojp0aGlzLmZyaWVuZFJlcXVlc3R9ID5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLXBsdXNcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAgQWRkIHRvIGZyaWVuZHNcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDx0ciBjbGFzc05hbWU9e3RleHRDbGFzc30+XG4gICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZ2x5cGhpY29uIGdseXBoaWNvbi11c2VyXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIDxzcGFuPnt0aGlzLnByb3BzLnVzZXIubG9naW59PC9zcGFuPlxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICB7dGhpcy5wcm9wcy51c2VyLmR0QWN0aXZlfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJ0ZXh0LXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAge2ZyaWVuZEJ0bn1cbiAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdFwiPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLWVudmVsb3BlXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgU2VuZCBtZXNzYWdlXG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICA8L3RyPlxuICAgIH1cbn1cblxuLy8gbGlzdCBvZiB1c2Vyc1xuY2xhc3MgVXNlckxpc3RDb21wIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiB0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXJ0LFxuICAgICAgICAgICAgdXNlcnM6IHRoaXMucHJvcHMudXNlckxpc3QudXNlcnMsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsTW91bnQgKCkge1xuICAgICAgICB0aGlzLmNoYW5nZVBhZ2UodGhpcy5wcm9wcy51c2VyTGlzdC5zdGFydCk7XG4gICAgfVxuXG4gICAgY2hhbmdlUGFnZSAoc3RhcnQgPSAwKSB7XG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnVVNFUl9MSVNUJyxcbiAgICAgICAgICAgIHN0YXJ0OiBzdGFydCxcbiAgICAgICAgICAgIHBlcnBhZ2U6IHRoaXMucHJvcHMudXNlckxpc3QucGVycGFnZSxcbiAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIGZyaWVuZFJlcXVlc3QgKGlkKSB7XG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnRlJJRU5EX1JFUVVFU1QnLFxuICAgICAgICAgICAgaWQ6IGlkXG4gICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBmcmllbmRSZW1vdmUgKGlkKSB7XG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnRlJJRU5EX1JFTU9WRScsXG4gICAgICAgICAgICBpZDogaWRcbiAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIGdldFVzZXJJdGVtcyAoKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gbWFwKHRoaXMucHJvcHMudXNlckxpc3QudXNlcnMsIHVzZXIgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIDxVc2VySXRlbUNvbXBcbiAgICAgICAgICAgICAgICB1c2VyPXt1c2VyfVxuICAgICAgICAgICAgICAgIGZyaWVuZFJlcXVlc3Q9ezo6dGhpcy5mcmllbmRSZXF1ZXN0fVxuICAgICAgICAgICAgICAgIGZyaWVuZFJlbW92ZT17Ojp0aGlzLmZyaWVuZFJlbW92ZX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gPHRhYmxlIGNsYXNzTmFtZT1cInRhYmxlIHRhYmxlLWhvdmVyXCI+XG4gICAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgICAgICAge2l0ZW1zfVxuICAgICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgPC90YWJsZT5cbiAgICB9XG4gICAgXG4gICAgcmVuZGVyICgpIHtcbiAgICAgICAgbGV0IGFsZXJ0T3B0cyA9IG51bGw7XG4gICAgICAgIGxldCB1c2VycyA9IG51bGw7XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMudXNlckxpc3Quc3RhdHVzID09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMudXNlckxpc3QuZXJyb3JcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXR1cyA9PT0gJ3NlbmQnKSB7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW5mbycsXG4gICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0JyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwYWdlclBhcmFtID0ge1xuICAgICAgICAgICAgc3RhcnQ6IHRoaXMucHJvcHMudXNlckxpc3Quc3RhcnQsXG4gICAgICAgICAgICBwZXJwYWdlOiB0aGlzLnByb3BzLnVzZXJMaXN0LnBlcnBhZ2UsXG4gICAgICAgICAgICBjb3VudDogdGhpcy5wcm9wcy51c2VyTGlzdC5jb3VudCxcbiAgICAgICAgICAgIGl0ZW1zOiB0aGlzLmdldFVzZXJJdGVtcygpLFxuICAgICAgICAgICAgY2hhbmdlUGFnZTogOjp0aGlzLmNoYW5nZVBhZ2UsXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIDxkaXY+XG4gICAgICAgICAgICA8QWxlcnRNZXNzYWdlIG9wdHM9e2FsZXJ0T3B0c30gLz5cbiAgICAgICAgICAgIDxQYWdpbmF0b3JMYXlvdXQgcGFyYW09e3BhZ2VyUGFyYW19IC8+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgfVxufVxuY29uc3QgbWFwU3RhdGVUb1Byb3BzID0gKHN0YXRlKSA9PiB7XG4gICAgcmV0dXJuIHsuLi5zdGF0ZX1cbn1cblVzZXJMaXN0Q29tcCA9IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShVc2VyTGlzdENvbXApXG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJMaXN0Q29tcFxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy91c2VyL0xpc3RDb21wLmpzIiwiaW1wb3J0IHtmb3JFYWNofSBmcm9tICdsb2Rhc2gnO1xubGV0IGluaXRTdGF0ZSA9IHtcbiAgICB1c2VySWQ6IHdpbmRvdy5sb2NhbFBhcmFtcy51c2VySWQgPyBwYXJzZUludCh3aW5kb3cubG9jYWxQYXJhbXMudXNlcklkKSA6IG51bGwsXG4gICAgc3RhcnQ6IHdpbmRvdy5sb2NhbFBhcmFtcy5zdGFydCA/IHBhcnNlSW50KHdpbmRvdy5sb2NhbFBhcmFtcy5zdGFydCkgOiAwLFxuICAgIHBlcnBhZ2U6IHdpbmRvdy5sb2NhbFBhcmFtcy5wZXJwYWdlID8gcGFyc2VJbnQod2luZG93LmxvY2FsUGFyYW1zLnBlcnBhZ2UpIDogOSxcbiAgICB1c2VyczogW10sXG4gICAgY291bnQ6IDAsXG4gICAgc3RhdHVzOiBudWxsLFxuICAgIGVycm9yOiBudWxsLFxufTtcbmNvbnN0IHVzZXJMaXN0ID0gKHN0YXRlID0gaW5pdFN0YXRlLCBhY3Rpb24pID0+IHtcbiAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgJ3N0YXRlJyxzdGF0ZSxcbiAgICAgICAgJ2FjdGlvbicsYWN0aW9uXG4gICAgKTtcblxuICAgIGxldCBkYXRhID0gey4uLnN0YXRlfTtcbiAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ1VTRVJfTElTVF9TRU5EJzpcbiAgICAgICAgICAgIGRhdGEuc3RhcnQgPSBhY3Rpb24uc3RhcnQ7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdVU0VSX0xJU1RfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgIGRhdGEudXNlcnMgPSBhY3Rpb24uZGF0YS5nZXRVc2VyTGlzdC51c2VycztcbiAgICAgICAgICAgIGRhdGEuY291bnQgPSBhY3Rpb24uZGF0YS5nZXRVc2VyTGlzdC5jb3VudDtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdVU0VSX0xJU1RfRVJST1InOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRVFVRVNUX1NFTkQnOlxuICAgICAgICAgICAgLy8gZGF0YS5zdGFydCA9IGFjdGlvbi5zdGFydDtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3NlbmQnO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRVFVRVNUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gICAgICAgICAgICBmb3JFYWNoKGRhdGEudXNlcnMsIHUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCh1LmlkKSA9PSBhY3Rpb24uZGF0YS5mcmllbmRSZXF1ZXN0LmZyaWVuZElkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgc2VsZkZyaWVuZElkID0gZ3JhcGhlbmUuSW50KClcbiAgICAgICAgICAgICAgICAgICAgZnJpZW5kVXNlcklkID0gZ3JhcGhlbmUuSW50KClcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgLy8gdS5zZWxmRnJpZW5kSWQgPSBhY3Rpb24uZGF0YS5mcmllbmRSZXF1ZXN0LmlkXG4gICAgICAgICAgICAgICAgICAgIHUuZnJpZW5kVXNlcklkID0gYWN0aW9uLmRhdGEuZnJpZW5kUmVxdWVzdC51c2VySWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gZGF0YS51c2VycyA9IGFjdGlvbi5kYXRhLmdldFVzZXJMaXN0LnVzZXJzO1xuICAgICAgICAgICAgLy8gZGF0YS5jb3VudCA9IGFjdGlvbi5kYXRhLmdldFVzZXJMaXN0LmNvdW50O1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRVFVRVNUX0VSUk9SJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIC8vIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBjYXNlICdGUklFTkRfUkVNT1ZFX1NFTkQnOlxuICAgICAgICAgICAgLy8gZGF0YS5zdGFydCA9IGFjdGlvbi5zdGFydDtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3NlbmQnO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRU1PVkVfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgIGZvckVhY2goZGF0YS51c2VycywgdSA9PiB7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgJ2FjdGlvbi5kYXRhLmZyaWVuZFJlbW92ZS5pZCcsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5kYXRhLmZyaWVuZFJlbW92ZS5pZFxuICAgICAgICAgICAgICAgICk7XG5cblxuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCh1LmlkKSA9PSBhY3Rpb24uZGF0YS5mcmllbmRSZW1vdmUuZnJpZW5kSWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICBzZWxmRnJpZW5kSWQgPSBncmFwaGVuZS5JbnQoKVxuICAgICAgICAgICAgICAgICAgICBmcmllbmRVc2VySWQgPSBncmFwaGVuZS5JbnQoKVxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB1LmZyaWVuZFVzZXJJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFTU9WRV9FUlJPUic6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdlcnJvcic7XG4gICAgICAgICAgICAvLyBkYXRhLmVycm9yID0gYWN0aW9uLmVycm9yO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgdXNlckxpc3RcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zdGF0aWNfc3JjL3VzZXIvTGlzdFJlZC5qcyJdLCJzb3VyY2VSb290IjoiIn0=