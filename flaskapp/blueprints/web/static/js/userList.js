webpackJsonp([0],{322:function(e,t,r){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var n=r(1),a=s(n),u=r(10),o=r(7);r(16),r(17);var l=r(8),i=r(323),c=s(i),p=r(18),d=s(p),f=r(324),h=s(f),m=r(19),E=(0,m.configureStore)({auth:d.default,userList:h.default}),g=(0,l.layout)({comp:c.default,forAuth:!0});(0,u.render)(a.default.createElement(o.Provider,{store:E},a.default.createElement(g,null)),document.getElementById("root"))},323:function(e,t,r){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}(),l=r(1),i=function(e){return e&&e.__esModule?e:{default:e}}(l),c=r(7),p=r(21),d=r(29),f=r(8),h=function(e){function t(){return s(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),o(t,[{key:"friendRequest",value:function(e){return e.preventDefault(),this.props.friendRequest(this.props.user.id)}},{key:"friendRemove",value:function(e){return e.preventDefault(),this.props.friendRemove(this.props.user.id)}},{key:"render",value:function(){var e=this.props.user.online?"success":"active",t=null,r=null;return null!==this.props.user.selfFriendId&&null!==this.props.user.friendUserId?(t=i.default.createElement("button",{className:"btn btn-default",onClick:this.friendRemove.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-minus"}),"  Remove from friends"),r=i.default.createElement("a",{className:"btn btn-default",href:"/chat-private/"+this.props.user.id},i.default.createElement("span",{className:"glyphicon glyphicon-envelope"}),"  Send message")):t=null!==this.props.user.selfFriendId?i.default.createElement("button",{className:"btn btn-default",onClick:this.friendRequest.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-plus"}),"  Approve friend"):null!==this.props.user.friendUserId?i.default.createElement("button",{disabled:!0,className:"btn btn-default",onClick:this.friendRequest.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-plus"}),"  Add to friends"):i.default.createElement("button",{className:"btn btn-default",onClick:this.friendRequest.bind(this)},i.default.createElement("span",{className:"glyphicon glyphicon-plus"}),"  Add to friends"),i.default.createElement("tr",{className:e},i.default.createElement("td",null,i.default.createElement("span",{className:"glyphicon glyphicon-user"})," ",i.default.createElement("span",null,this.props.user.login)),i.default.createElement("td",null,this.props.user.dtActive),i.default.createElement("td",{className:"text-right"},t," ",r))}}]),t}(i.default.Component),m=function(e){function t(e){s(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={start:r.props.userList.start,users:r.props.userList.users},r}return a(t,e),o(t,[{key:"componentWillMount",value:function(){this.changePage(this.props.userList.start)}},{key:"changePage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.props.dispatch((0,p.graphql)({type:"USER_LIST",start:e,perpage:this.props.userList.perpage}))}},{key:"friendRequest",value:function(e){this.props.dispatch((0,p.graphql)({type:"FRIEND_REQUEST",id:e}))}},{key:"friendRemove",value:function(e){this.props.dispatch((0,p.graphql)({type:"FRIEND_REMOVE",id:e}))}},{key:"getUserItems",value:function(){var e=this,t=(0,d.map)(this.props.userList.users,function(t){return i.default.createElement(h,{user:t,friendRequest:e.friendRequest.bind(e),friendRemove:e.friendRemove.bind(e)})});return i.default.createElement("table",{className:"table table-hover"},i.default.createElement("tbody",null,t))}},{key:"render",value:function(){var e=null;"error"==this.props.userList.status?e={className:"danger",text:this.props.userList.error}:"send"===this.props.userList.status&&(e={className:"info",text:"Loading, please wait"});var t={start:this.props.userList.start,perpage:this.props.userList.perpage,count:this.props.userList.count,items:this.getUserItems(),changePage:this.changePage.bind(this)};return i.default.createElement("div",null,i.default.createElement(f.AlertMessage,{opts:e}),i.default.createElement(f.PaginatorLayout,{param:t}))}}]),t}(i.default.Component),E=function(e){return u({},e)};m=(0,c.connect)(E)(m),t.default=m},324:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},n=r(29),a={userId:window.localParams.userId?parseInt(window.localParams.userId):null,start:window.localParams.start?parseInt(window.localParams.start):0,perpage:window.localParams.perpage?parseInt(window.localParams.perpage):9,users:[],count:0,status:null,error:null},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];console.log("state",e,"action",t);var r=s({},e);switch(t.type){case"USER_LIST_SEND":return r.start=t.start,r.status="send",r;case"USER_LIST_SUCCESS":return r.status="success",r.users=t.data.getUserList.users,r.count=t.data.getUserList.count,r;case"USER_LIST_ERROR":return r.status="error",r.error=t.error,r;case"FRIEND_REQUEST_SEND":return r.status="send",r;case"FRIEND_REQUEST_SUCCESS":return r.status="success",(0,n.forEach)(r.users,function(e){parseInt(e.id)==t.data.friendRequest.friendId&&(e.friendUserId=t.data.friendRequest.userId)}),r;case"FRIEND_REQUEST_ERROR":return r.status="error",r;case"FRIEND_REMOVE_SEND":return r.status="send",r;case"FRIEND_REMOVE_SUCCESS":return r.status="success",(0,n.forEach)(r.users,function(e){console.log("action.data.friendRemove.id",t.data.friendRemove.id),parseInt(e.id)==t.data.friendRemove.friendId&&(e.friendUserId=null)}),r;case"FRIEND_REMOVE_ERROR":return r.status="error",r;default:return e}};t.default=u}},[322]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vdXNlckxpc3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy91c2VyTGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL3VzZXIvTGlzdENvbXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy91c2VyL0xpc3RSZWQuanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wIiwiMzIyIiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfcmVhY3QiLCJfcmVhY3QyIiwiX3JlYWN0RG9tIiwiX3JlYWN0UmVkdXgiLCJfY29tcG9uZW50IiwiX0xpc3RDb21wIiwiX0xpc3RDb21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfTGlzdFJlZCIsIl9MaXN0UmVkMiIsIl9jb25maWd1cmVTdG9yZSIsInN0b3JlIiwiY29uZmlndXJlU3RvcmUiLCJhdXRoIiwidXNlckxpc3QiLCJDb21wIiwibGF5b3V0IiwiY29tcCIsIkxpc3RDb21wIiwiZm9yQXV0aCIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJQcm92aWRlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCIzMjMiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiZGVmaW5lUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzb3VyY2UiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfYWN0aW9uIiwiX2xvZGFzaCIsIlVzZXJJdGVtQ29tcCIsIl9SZWFjdCRDb21wb25lbnQiLCJ0aGlzIiwiZ2V0UHJvdG90eXBlT2YiLCJhcHBseSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZyaWVuZFJlcXVlc3QiLCJ1c2VyIiwiaWQiLCJmcmllbmRSZW1vdmUiLCJ0ZXh0Q2xhc3MiLCJvbmxpbmUiLCJmcmllbmRCdG4iLCJtc2dCdG4iLCJzZWxmRnJpZW5kSWQiLCJmcmllbmRVc2VySWQiLCJjbGFzc05hbWUiLCJvbkNsaWNrIiwiYmluZCIsImhyZWYiLCJkaXNhYmxlZCIsImxvZ2luIiwiZHRBY3RpdmUiLCJSZWFjdCIsIkNvbXBvbmVudCIsIlVzZXJMaXN0Q29tcCIsIl9SZWFjdCRDb21wb25lbnQyIiwiX3RoaXMyIiwic3RhdGUiLCJzdGFydCIsInVzZXJzIiwiY2hhbmdlUGFnZSIsInVuZGVmaW5lZCIsImRpc3BhdGNoIiwiZ3JhcGhxbCIsInR5cGUiLCJwZXJwYWdlIiwiX3RoaXMzIiwiaXRlbXMiLCJtYXAiLCJhbGVydE9wdHMiLCJzdGF0dXMiLCJ0ZXh0IiwiZXJyb3IiLCJwYWdlclBhcmFtIiwiY291bnQiLCJnZXRVc2VySXRlbXMiLCJBbGVydE1lc3NhZ2UiLCJvcHRzIiwiUGFnaW5hdG9yTGF5b3V0IiwicGFyYW0iLCJtYXBTdGF0ZVRvUHJvcHMiLCJjb25uZWN0IiwiMzI0IiwiaW5pdFN0YXRlIiwidXNlcklkIiwid2luZG93IiwibG9jYWxQYXJhbXMiLCJwYXJzZUludCIsImFjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJkYXRhIiwiZ2V0VXNlckxpc3QiLCJmb3JFYWNoIiwidSIsImZyaWVuZElk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LEVBQU9HLEtBQUtyRCxhQUFheUQsV0FNM0NELEVBQUVsRCxhQUFlLFFBR2xCK0MsQ0FDWCxLQUFLLHNCQUdELE1BRkFBLEdBQUtyQixPQUFTLFFBRVBxQixDQUVYLFNBQ0ksTUFBT2xDLElIaVVuQnJHLEdBQVFLLFFHN1RPZ0IsS0hpVVoiLCJmaWxlIjoidXNlckxpc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ3ZWJwYWNrSnNvbnAoWzBdLHtcblxuLyoqKi8gMzIyOlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfcmVhY3REb20gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygxNik7XG5cbl9fd2VicGFja19yZXF1aXJlX18oMTcpO1xuXG52YXIgX2NvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cbnZhciBfTGlzdENvbXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyMyk7XG5cbnZhciBfTGlzdENvbXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTGlzdENvbXApO1xuXG52YXIgX0xvZ2luUmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOCk7XG5cbnZhciBfTG9naW5SZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTG9naW5SZWQpO1xuXG52YXIgX0xpc3RSZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMyNCk7XG5cbnZhciBfTGlzdFJlZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9MaXN0UmVkKTtcblxudmFyIF9jb25maWd1cmVTdG9yZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgc3RvcmUgPSAoMCwgX2NvbmZpZ3VyZVN0b3JlLmNvbmZpZ3VyZVN0b3JlKSh7XG5cdGF1dGg6IF9Mb2dpblJlZDIuZGVmYXVsdCxcblx0dXNlckxpc3Q6IF9MaXN0UmVkMi5kZWZhdWx0XG59KTtcblxudmFyIENvbXAgPSAoMCwgX2NvbXBvbmVudC5sYXlvdXQpKHsgY29tcDogX0xpc3RDb21wMi5kZWZhdWx0LCBmb3JBdXRoOiB0cnVlIH0pO1xuKDAsIF9yZWFjdERvbS5yZW5kZXIpKF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuXHRfcmVhY3RSZWR1eC5Qcm92aWRlcixcblx0eyBzdG9yZTogc3RvcmUgfSxcblx0X3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tcCwgbnVsbClcbiksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzIzOlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxudmFyIF9hY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTtcblxudmFyIF9sb2Rhc2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTtcblxudmFyIF9jb21wb25lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbi8vIG9uZSB1c2VyIHJvd1xudmFyIFVzZXJJdGVtQ29tcCA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gICAgX2luaGVyaXRzKFVzZXJJdGVtQ29tcCwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgICBmdW5jdGlvbiBVc2VySXRlbUNvbXAoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBVc2VySXRlbUNvbXApO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoVXNlckl0ZW1Db21wLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoVXNlckl0ZW1Db21wKSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFVzZXJJdGVtQ29tcCwgW3tcbiAgICAgICAga2V5OiAnZnJpZW5kUmVxdWVzdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmcmllbmRSZXF1ZXN0KGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmZyaWVuZFJlcXVlc3QodGhpcy5wcm9wcy51c2VyLmlkKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZnJpZW5kUmVtb3ZlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZyaWVuZFJlbW92ZShlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5mcmllbmRSZW1vdmUodGhpcy5wcm9wcy51c2VyLmlkKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgICAgIHZhciB0ZXh0Q2xhc3MgPSB0aGlzLnByb3BzLnVzZXIub25saW5lID8gJ3N1Y2Nlc3MnIDogJ2FjdGl2ZSc7XG4gICAgICAgICAgICB2YXIgZnJpZW5kQnRuID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBtc2dCdG4gPSBudWxsO1xuICAgICAgICAgICAgLy8gaWYgYm90aCB1c2VycyBzZW5kZWQgZnJpZW5kIHJlcXVlc3RzXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy51c2VyLnNlbGZGcmllbmRJZCAhPT0gbnVsbCAmJiB0aGlzLnByb3BzLnVzZXIuZnJpZW5kVXNlcklkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgZnJpZW5kQnRuID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCcsIG9uQ2xpY2s6IHRoaXMuZnJpZW5kUmVtb3ZlLmJpbmQodGhpcykgfSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tbWludXMnIH0pLFxuICAgICAgICAgICAgICAgICAgICAnXFx4QTAgUmVtb3ZlIGZyb20gZnJpZW5kcydcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIG1zZ0J0biA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAnYScsXG4gICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnYnRuIGJ0bi1kZWZhdWx0JywgaHJlZjogXCIvY2hhdC1wcml2YXRlL1wiICsgdGhpcy5wcm9wcy51c2VyLmlkIH0sXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdnbHlwaGljb24gZ2x5cGhpY29uLWVudmVsb3BlJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgJ1xceEEwIFNlbmQgbWVzc2FnZSdcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWYgdGhpcyByb3cgc2VuZGVkIHJlcXVlc3QgdG8gY3VycmVudCB1c2VyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnByb3BzLnVzZXIuc2VsZkZyaWVuZElkICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZEJ0biA9IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCcsIG9uQ2xpY2s6IHRoaXMuZnJpZW5kUmVxdWVzdC5iaW5kKHRoaXMpIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAnZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdcXHhBMCBBcHByb3ZlIGZyaWVuZCdcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gaWYgY3VycmVudCB1c2VyIHNlbmRlZCByZXF1ZXN0IHRvIGN1cnJlbnQgcm93XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wcm9wcy51c2VyLmZyaWVuZFVzZXJJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJpZW5kQnRuID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBkaXNhYmxlZDogdHJ1ZSwgY2xhc3NOYW1lOiAnYnRuIGJ0bi1kZWZhdWx0Jywgb25DbGljazogdGhpcy5mcmllbmRSZXF1ZXN0LmJpbmQodGhpcykgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAnZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXFx4QTAgQWRkIHRvIGZyaWVuZHMnXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJpZW5kQnRuID0gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdidG4gYnRuLWRlZmF1bHQnLCBvbkNsaWNrOiB0aGlzLmZyaWVuZFJlcXVlc3QuYmluZCh0aGlzKSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6ICdnbHlwaGljb24gZ2x5cGhpY29uLXBsdXMnIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcXHhBMCBBZGQgdG8gZnJpZW5kcydcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICd0cicsXG4gICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6IHRleHRDbGFzcyB9LFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAndGQnLFxuICAgICAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAnZ2x5cGhpY29uIGdseXBoaWNvbi11c2VyJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgJ1xceEEwJyxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnc3BhbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy51c2VyLmxvZ2luXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAndGQnLFxuICAgICAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnVzZXIuZHRBY3RpdmVcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAndGQnLFxuICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3RleHQtcmlnaHQnIH0sXG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZEJ0bixcbiAgICAgICAgICAgICAgICAgICAgJ1xceEEwJyxcbiAgICAgICAgICAgICAgICAgICAgbXNnQnRuXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBVc2VySXRlbUNvbXA7XG59KF9yZWFjdDIuZGVmYXVsdC5Db21wb25lbnQpO1xuXG4vLyBsaXN0IG9mIHVzZXJzXG5cblxudmFyIFVzZXJMaXN0Q29tcCA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50Mikge1xuICAgIF9pbmhlcml0cyhVc2VyTGlzdENvbXAsIF9SZWFjdCRDb21wb25lbnQyKTtcblxuICAgIGZ1bmN0aW9uIFVzZXJMaXN0Q29tcChwcm9wcykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXNlckxpc3RDb21wKTtcblxuICAgICAgICB2YXIgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFVzZXJMaXN0Q29tcC5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFVzZXJMaXN0Q29tcCkpLmNhbGwodGhpcywgcHJvcHMpKTtcblxuICAgICAgICBfdGhpczIuc3RhdGUgPSB7XG4gICAgICAgICAgICBzdGFydDogX3RoaXMyLnByb3BzLnVzZXJMaXN0LnN0YXJ0LFxuICAgICAgICAgICAgdXNlcnM6IF90aGlzMi5wcm9wcy51c2VyTGlzdC51c2Vyc1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXMyO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhVc2VyTGlzdENvbXAsIFt7XG4gICAgICAgIGtleTogJ2NvbXBvbmVudFdpbGxNb3VudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZVBhZ2UodGhpcy5wcm9wcy51c2VyTGlzdC5zdGFydCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NoYW5nZVBhZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbmdlUGFnZSgpIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDtcblxuICAgICAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaCgoMCwgX2FjdGlvbi5ncmFwaHFsKSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ1VTRVJfTElTVCcsXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgICAgIHBlcnBhZ2U6IHRoaXMucHJvcHMudXNlckxpc3QucGVycGFnZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdmcmllbmRSZXF1ZXN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZyaWVuZFJlcXVlc3QoaWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goKDAsIF9hY3Rpb24uZ3JhcGhxbCkoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdGUklFTkRfUkVRVUVTVCcsXG4gICAgICAgICAgICAgICAgaWQ6IGlkXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2ZyaWVuZFJlbW92ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmcmllbmRSZW1vdmUoaWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goKDAsIF9hY3Rpb24uZ3JhcGhxbCkoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdGUklFTkRfUkVNT1ZFJyxcbiAgICAgICAgICAgICAgICBpZDogaWRcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0VXNlckl0ZW1zJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFVzZXJJdGVtcygpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgaXRlbXMgPSAoMCwgX2xvZGFzaC5tYXApKHRoaXMucHJvcHMudXNlckxpc3QudXNlcnMsIGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFVzZXJJdGVtQ29tcCwge1xuICAgICAgICAgICAgICAgICAgICB1c2VyOiB1c2VyLFxuICAgICAgICAgICAgICAgICAgICBmcmllbmRSZXF1ZXN0OiBfdGhpczMuZnJpZW5kUmVxdWVzdC5iaW5kKF90aGlzMyksXG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZFJlbW92ZTogX3RoaXMzLmZyaWVuZFJlbW92ZS5iaW5kKF90aGlzMylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgJ3RhYmxlJyxcbiAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3RhYmxlIHRhYmxlLWhvdmVyJyB9LFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAndGJvZHknLFxuICAgICAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICAgICBpdGVtc1xuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbmRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICAgICAgICB2YXIgYWxlcnRPcHRzID0gbnVsbDtcbiAgICAgICAgICAgIHZhciB1c2VycyA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXR1cyA9PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnByb3BzLnVzZXJMaXN0LmVycm9yXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy51c2VyTGlzdC5zdGF0dXMgPT09ICdzZW5kJykge1xuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW5mbycsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdMb2FkaW5nLCBwbGVhc2Ugd2FpdCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcGFnZXJQYXJhbSA9IHtcbiAgICAgICAgICAgICAgICBzdGFydDogdGhpcy5wcm9wcy51c2VyTGlzdC5zdGFydCxcbiAgICAgICAgICAgICAgICBwZXJwYWdlOiB0aGlzLnByb3BzLnVzZXJMaXN0LnBlcnBhZ2UsXG4gICAgICAgICAgICAgICAgY291bnQ6IHRoaXMucHJvcHMudXNlckxpc3QuY291bnQsXG4gICAgICAgICAgICAgICAgaXRlbXM6IHRoaXMuZ2V0VXNlckl0ZW1zKCksXG4gICAgICAgICAgICAgICAgY2hhbmdlUGFnZTogdGhpcy5jaGFuZ2VQYWdlLmJpbmQodGhpcylcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9jb21wb25lbnQuQWxlcnRNZXNzYWdlLCB7IG9wdHM6IGFsZXJ0T3B0cyB9KSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50LlBhZ2luYXRvckxheW91dCwgeyBwYXJhbTogcGFnZXJQYXJhbSB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBVc2VyTGlzdENvbXA7XG59KF9yZWFjdDIuZGVmYXVsdC5Db21wb25lbnQpO1xuXG52YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7XG4gICAgcmV0dXJuIF9leHRlbmRzKHt9LCBzdGF0ZSk7XG59O1xuVXNlckxpc3RDb21wID0gKDAsIF9yZWFjdFJlZHV4LmNvbm5lY3QpKG1hcFN0YXRlVG9Qcm9wcykoVXNlckxpc3RDb21wKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVXNlckxpc3RDb21wO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzI0OlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfbG9kYXNoID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7XG5cbnZhciBpbml0U3RhdGUgPSB7XG4gICAgdXNlcklkOiB3aW5kb3cubG9jYWxQYXJhbXMudXNlcklkID8gcGFyc2VJbnQod2luZG93LmxvY2FsUGFyYW1zLnVzZXJJZCkgOiBudWxsLFxuICAgIHN0YXJ0OiB3aW5kb3cubG9jYWxQYXJhbXMuc3RhcnQgPyBwYXJzZUludCh3aW5kb3cubG9jYWxQYXJhbXMuc3RhcnQpIDogMCxcbiAgICBwZXJwYWdlOiB3aW5kb3cubG9jYWxQYXJhbXMucGVycGFnZSA/IHBhcnNlSW50KHdpbmRvdy5sb2NhbFBhcmFtcy5wZXJwYWdlKSA6IDksXG4gICAgdXNlcnM6IFtdLFxuICAgIGNvdW50OiAwLFxuICAgIHN0YXR1czogbnVsbCxcbiAgICBlcnJvcjogbnVsbFxufTtcbnZhciB1c2VyTGlzdCA9IGZ1bmN0aW9uIHVzZXJMaXN0KCkge1xuICAgIHZhciBzdGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogaW5pdFN0YXRlO1xuICAgIHZhciBhY3Rpb24gPSBhcmd1bWVudHNbMV07XG5cbiAgICBjb25zb2xlLmxvZygnc3RhdGUnLCBzdGF0ZSwgJ2FjdGlvbicsIGFjdGlvbik7XG5cbiAgICB2YXIgZGF0YSA9IF9leHRlbmRzKHt9LCBzdGF0ZSk7XG4gICAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgICAgICBjYXNlICdVU0VSX0xJU1RfU0VORCc6XG4gICAgICAgICAgICBkYXRhLnN0YXJ0ID0gYWN0aW9uLnN0YXJ0O1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc2VuZCc7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnVVNFUl9MSVNUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gICAgICAgICAgICBkYXRhLnVzZXJzID0gYWN0aW9uLmRhdGEuZ2V0VXNlckxpc3QudXNlcnM7XG4gICAgICAgICAgICBkYXRhLmNvdW50ID0gYWN0aW9uLmRhdGEuZ2V0VXNlckxpc3QuY291bnQ7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnVVNFUl9MSVNUX0VSUk9SJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBjYXNlICdGUklFTkRfUkVRVUVTVF9TRU5EJzpcbiAgICAgICAgICAgIC8vIGRhdGEuc3RhcnQgPSBhY3Rpb24uc3RhcnQ7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdGUklFTkRfUkVRVUVTVF9TVUNDRVNTJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3MnO1xuICAgICAgICAgICAgKDAsIF9sb2Rhc2guZm9yRWFjaCkoZGF0YS51c2VycywgZnVuY3Rpb24gKHUpIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQodS5pZCkgPT0gYWN0aW9uLmRhdGEuZnJpZW5kUmVxdWVzdC5mcmllbmRJZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHNlbGZGcmllbmRJZCA9IGdyYXBoZW5lLkludCgpXG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZFVzZXJJZCA9IGdyYXBoZW5lLkludCgpXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIC8vIHUuc2VsZkZyaWVuZElkID0gYWN0aW9uLmRhdGEuZnJpZW5kUmVxdWVzdC5pZFxuICAgICAgICAgICAgICAgICAgICB1LmZyaWVuZFVzZXJJZCA9IGFjdGlvbi5kYXRhLmZyaWVuZFJlcXVlc3QudXNlcklkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBkYXRhLnVzZXJzID0gYWN0aW9uLmRhdGEuZ2V0VXNlckxpc3QudXNlcnM7XG4gICAgICAgICAgICAvLyBkYXRhLmNvdW50ID0gYWN0aW9uLmRhdGEuZ2V0VXNlckxpc3QuY291bnQ7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFUVVFU1RfRVJST1InOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgLy8gZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRU1PVkVfU0VORCc6XG4gICAgICAgICAgICAvLyBkYXRhLnN0YXJ0ID0gYWN0aW9uLnN0YXJ0O1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc2VuZCc7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFTU9WRV9TVUNDRVNTJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3MnO1xuICAgICAgICAgICAgKDAsIF9sb2Rhc2guZm9yRWFjaCkoZGF0YS51c2VycywgZnVuY3Rpb24gKHUpIHtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhY3Rpb24uZGF0YS5mcmllbmRSZW1vdmUuaWQnLCBhY3Rpb24uZGF0YS5mcmllbmRSZW1vdmUuaWQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHUuaWQpID09IGFjdGlvbi5kYXRhLmZyaWVuZFJlbW92ZS5mcmllbmRJZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHNlbGZGcmllbmRJZCA9IGdyYXBoZW5lLkludCgpXG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZFVzZXJJZCA9IGdyYXBoZW5lLkludCgpXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHUuZnJpZW5kVXNlcklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdGUklFTkRfUkVNT1ZFX0VSUk9SJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIC8vIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IHVzZXJMaXN0O1xuXG4vKioqLyB9KVxuXG59LFszMjJdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gdXNlckxpc3QuanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyByZW5kZXIgfSBmcm9tICdyZWFjdC1kb20nXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gJ3JlYWN0LXJlZHV4J1xuXG5pbXBvcnQgJ2Jvb3RzdHJhcC9kaXN0L2Nzcy9ib290c3RyYXAuY3NzJztcbmltcG9ydCAnLi9zdHlsZXMvaW5kZXguc2NzcydcblxuaW1wb3J0IHtsYXlvdXR9IGZyb20gJy4vaGVscGVycy9jb21wb25lbnQnXG5pbXBvcnQgTGlzdENvbXAgZnJvbSAnLi91c2VyL0xpc3RDb21wJ1xuXG5pbXBvcnQgYXV0aCBmcm9tICcuL2F1dGgvTG9naW5SZWQnXG5pbXBvcnQgdXNlckxpc3QgZnJvbSAnLi91c2VyL0xpc3RSZWQnXG5cbmltcG9ydCB7Y29uZmlndXJlU3RvcmV9IGZyb20gJy4vaGVscGVycy9jb25maWd1cmVTdG9yZSdcblxubGV0IHN0b3JlID0gY29uZmlndXJlU3RvcmUoe1xuXHRhdXRoOiBhdXRoLFxuXHR1c2VyTGlzdDogdXNlckxpc3QsXG59KTtcblxubGV0IENvbXAgPSBsYXlvdXQoe2NvbXA6IExpc3RDb21wLCBmb3JBdXRoOiB0cnVlfSk7XG5yZW5kZXIoXG5cdDxQcm92aWRlciBzdG9yZT17c3RvcmV9PlxuXHRcdDxDb21wIC8+XG5cdDwvUHJvdmlkZXI+LFxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpXG4pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy91c2VyTGlzdC5qcyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnO1xuaW1wb3J0IHsgZ3JhcGhxbCB9IGZyb20gJy4uL2hlbHBlcnMvYWN0aW9uJztcbmltcG9ydCB7bWFwLCBpc051bWJlcn0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7QWxlcnRNZXNzYWdlLCBQYWdpbmF0b3JMYXlvdXR9IGZyb20gJy4uL2hlbHBlcnMvY29tcG9uZW50JztcblxuXG5cblxuLy8gb25lIHVzZXIgcm93XG5jbGFzcyBVc2VySXRlbUNvbXAgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGZyaWVuZFJlcXVlc3QgKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5mcmllbmRSZXF1ZXN0KHRoaXMucHJvcHMudXNlci5pZCk7XG4gICAgfVxuICAgIGZyaWVuZFJlbW92ZSAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLmZyaWVuZFJlbW92ZSh0aGlzLnByb3BzLnVzZXIuaWQpO1xuICAgIH1cbiAgICByZW5kZXIgKCkge1xuICAgICAgICBsZXQgdGV4dENsYXNzID0gdGhpcy5wcm9wcy51c2VyLm9ubGluZSA/ICdzdWNjZXNzJyA6ICdhY3RpdmUnO1xuICAgICAgICBsZXQgZnJpZW5kQnRuID0gbnVsbDtcbiAgICAgICAgbGV0IG1zZ0J0biA9IG51bGxcbiAgICAgICAgLy8gaWYgYm90aCB1c2VycyBzZW5kZWQgZnJpZW5kIHJlcXVlc3RzXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMucHJvcHMudXNlci5zZWxmRnJpZW5kSWQgIT09IG51bGwgJiZcbiAgICAgICAgICAgIHRoaXMucHJvcHMudXNlci5mcmllbmRVc2VySWQgIT09IG51bGxcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBmcmllbmRCdG4gPSA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdFwiIG9uQ2xpY2s9ezo6dGhpcy5mcmllbmRSZW1vdmV9ID5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLW1pbnVzXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIFJlbW92ZSBmcm9tIGZyaWVuZHNcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgbXNnQnRuID0gPGEgY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCIgaHJlZj17XCIvY2hhdC1wcml2YXRlL1wiICsgdGhpcy5wcm9wcy51c2VyLmlkfT5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJnbHlwaGljb24gZ2x5cGhpY29uLWVudmVsb3BlXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIFNlbmQgbWVzc2FnZVxuICAgICAgICAgICAgPC9hPlxuICAgICAgICB9XG4gICAgICAgIC8vIGlmIHRoaXMgcm93IHNlbmRlZCByZXF1ZXN0IHRvIGN1cnJlbnQgdXNlclxuICAgICAgICBlbHNlIGlmICh0aGlzLnByb3BzLnVzZXIuc2VsZkZyaWVuZElkICE9PSBudWxsKSB7XG4gICAgICAgICAgICBmcmllbmRCdG4gPSA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdFwiIG9uQ2xpY2s9ezo6dGhpcy5mcmllbmRSZXF1ZXN0fSA+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIEFwcHJvdmUgZnJpZW5kXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgfVxuICAgICAgICAvLyBpZiBjdXJyZW50IHVzZXIgc2VuZGVkIHJlcXVlc3QgdG8gY3VycmVudCByb3dcbiAgICAgICAgZWxzZSBpZiAodGhpcy5wcm9wcy51c2VyLmZyaWVuZFVzZXJJZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgZnJpZW5kQnRuID0gPGJ1dHRvbiBkaXNhYmxlZCBjbGFzc05hbWU9XCJidG4gYnRuLWRlZmF1bHRcIiBvbkNsaWNrPXs6OnRoaXMuZnJpZW5kUmVxdWVzdH0gPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImdseXBoaWNvbiBnbHlwaGljb24tcGx1c1wiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICBBZGQgdG8gZnJpZW5kc1xuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmcmllbmRCdG4gPSA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdFwiIG9uQ2xpY2s9ezo6dGhpcy5mcmllbmRSZXF1ZXN0fSA+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1wbHVzXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgICZuYnNwO1xuICAgICAgICAgICAgICAgIEFkZCB0byBmcmllbmRzXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiA8dHIgY2xhc3NOYW1lPXt0ZXh0Q2xhc3N9PlxuICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImdseXBoaWNvbiBnbHlwaGljb24tdXNlclwiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAmbmJzcDtcbiAgICAgICAgICAgICAgICA8c3Bhbj57dGhpcy5wcm9wcy51c2VyLmxvZ2lufTwvc3Bhbj5cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAge3RoaXMucHJvcHMudXNlci5kdEFjdGl2ZX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwidGV4dC1yaWdodFwiPlxuICAgICAgICAgICAgICAgIHtmcmllbmRCdG59XG4gICAgICAgICAgICAgICAgJm5ic3A7XG4gICAgICAgICAgICAgICAge21zZ0J0bn1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgIDwvdHI+XG4gICAgfVxufVxuXG4vLyBsaXN0IG9mIHVzZXJzXG5jbGFzcyBVc2VyTGlzdENvbXAgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcblxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgc3RhcnQ6IHRoaXMucHJvcHMudXNlckxpc3Quc3RhcnQsXG4gICAgICAgICAgICB1c2VyczogdGhpcy5wcm9wcy51c2VyTGlzdC51c2VycyxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxNb3VudCAoKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlUGFnZSh0aGlzLnByb3BzLnVzZXJMaXN0LnN0YXJ0KTtcbiAgICB9XG5cbiAgICBjaGFuZ2VQYWdlIChzdGFydCA9IDApIHtcbiAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaChncmFwaHFsKHtcbiAgICAgICAgICAgIHR5cGU6ICdVU0VSX0xJU1QnLFxuICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0LFxuICAgICAgICAgICAgcGVycGFnZTogdGhpcy5wcm9wcy51c2VyTGlzdC5wZXJwYWdlLFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgZnJpZW5kUmVxdWVzdCAoaWQpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaChncmFwaHFsKHtcbiAgICAgICAgICAgIHR5cGU6ICdGUklFTkRfUkVRVUVTVCcsXG4gICAgICAgICAgICBpZDogaWRcbiAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIGZyaWVuZFJlbW92ZSAoaWQpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaChncmFwaHFsKHtcbiAgICAgICAgICAgIHR5cGU6ICdGUklFTkRfUkVNT1ZFJyxcbiAgICAgICAgICAgIGlkOiBpZFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgZ2V0VXNlckl0ZW1zICgpIHtcbiAgICAgICAgY29uc3QgaXRlbXMgPSBtYXAodGhpcy5wcm9wcy51c2VyTGlzdC51c2VycywgdXNlciA9PiB7XG4gICAgICAgICAgICByZXR1cm4gPFVzZXJJdGVtQ29tcFxuICAgICAgICAgICAgICAgIHVzZXI9e3VzZXJ9XG4gICAgICAgICAgICAgICAgZnJpZW5kUmVxdWVzdD17Ojp0aGlzLmZyaWVuZFJlcXVlc3R9XG4gICAgICAgICAgICAgICAgZnJpZW5kUmVtb3ZlPXs6OnRoaXMuZnJpZW5kUmVtb3ZlfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiA8dGFibGUgY2xhc3NOYW1lPVwidGFibGUgdGFibGUtaG92ZXJcIj5cbiAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICB7aXRlbXN9XG4gICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICA8L3RhYmxlPlxuICAgIH1cbiAgICBcbiAgICByZW5kZXIgKCkge1xuICAgICAgICBsZXQgYWxlcnRPcHRzID0gbnVsbDtcbiAgICAgICAgbGV0IHVzZXJzID0gbnVsbDtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy51c2VyTGlzdC5zdGF0dXMgPT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2RhbmdlcicsXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wcm9wcy51c2VyTGlzdC5lcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMudXNlckxpc3Quc3RhdHVzID09PSAnc2VuZCcpIHtcbiAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdpbmZvJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnTG9hZGluZywgcGxlYXNlIHdhaXQnLFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHBhZ2VyUGFyYW0gPSB7XG4gICAgICAgICAgICBzdGFydDogdGhpcy5wcm9wcy51c2VyTGlzdC5zdGFydCxcbiAgICAgICAgICAgIHBlcnBhZ2U6IHRoaXMucHJvcHMudXNlckxpc3QucGVycGFnZSxcbiAgICAgICAgICAgIGNvdW50OiB0aGlzLnByb3BzLnVzZXJMaXN0LmNvdW50LFxuICAgICAgICAgICAgaXRlbXM6IHRoaXMuZ2V0VXNlckl0ZW1zKCksXG4gICAgICAgICAgICBjaGFuZ2VQYWdlOiA6OnRoaXMuY2hhbmdlUGFnZSxcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gPGRpdj5cbiAgICAgICAgICAgIDxBbGVydE1lc3NhZ2Ugb3B0cz17YWxlcnRPcHRzfSAvPlxuICAgICAgICAgICAgPFBhZ2luYXRvckxheW91dCBwYXJhbT17cGFnZXJQYXJhbX0gLz5cbiAgICAgICAgPC9kaXY+XG5cbiAgICB9XG59XG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGUpID0+IHtcbiAgICByZXR1cm4gey4uLnN0YXRlfVxufVxuVXNlckxpc3RDb21wID0gY29ubmVjdChtYXBTdGF0ZVRvUHJvcHMpKFVzZXJMaXN0Q29tcClcblxuZXhwb3J0IGRlZmF1bHQgVXNlckxpc3RDb21wXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zdGF0aWNfc3JjL3VzZXIvTGlzdENvbXAuanMiLCJpbXBvcnQge2ZvckVhY2h9IGZyb20gJ2xvZGFzaCc7XG5sZXQgaW5pdFN0YXRlID0ge1xuICAgIHVzZXJJZDogd2luZG93LmxvY2FsUGFyYW1zLnVzZXJJZCA/IHBhcnNlSW50KHdpbmRvdy5sb2NhbFBhcmFtcy51c2VySWQpIDogbnVsbCxcbiAgICBzdGFydDogd2luZG93LmxvY2FsUGFyYW1zLnN0YXJ0ID8gcGFyc2VJbnQod2luZG93LmxvY2FsUGFyYW1zLnN0YXJ0KSA6IDAsXG4gICAgcGVycGFnZTogd2luZG93LmxvY2FsUGFyYW1zLnBlcnBhZ2UgPyBwYXJzZUludCh3aW5kb3cubG9jYWxQYXJhbXMucGVycGFnZSkgOiA5LFxuICAgIHVzZXJzOiBbXSxcbiAgICBjb3VudDogMCxcbiAgICBzdGF0dXM6IG51bGwsXG4gICAgZXJyb3I6IG51bGwsXG59O1xuY29uc3QgdXNlckxpc3QgPSAoc3RhdGUgPSBpbml0U3RhdGUsIGFjdGlvbikgPT4ge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAnc3RhdGUnLHN0YXRlLFxuICAgICAgICAnYWN0aW9uJyxhY3Rpb25cbiAgICApO1xuXG4gICAgbGV0IGRhdGEgPSB7Li4uc3RhdGV9O1xuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnVVNFUl9MSVNUX1NFTkQnOlxuICAgICAgICAgICAgZGF0YS5zdGFydCA9IGFjdGlvbi5zdGFydDtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3NlbmQnO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ1VTRVJfTElTVF9TVUNDRVNTJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3MnO1xuICAgICAgICAgICAgZGF0YS51c2VycyA9IGFjdGlvbi5kYXRhLmdldFVzZXJMaXN0LnVzZXJzO1xuICAgICAgICAgICAgZGF0YS5jb3VudCA9IGFjdGlvbi5kYXRhLmdldFVzZXJMaXN0LmNvdW50O1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ1VTRVJfTElTVF9FUlJPUic6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdlcnJvcic7XG4gICAgICAgICAgICBkYXRhLmVycm9yID0gYWN0aW9uLmVycm9yO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG5cbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFUVVFU1RfU0VORCc6XG4gICAgICAgICAgICAvLyBkYXRhLnN0YXJ0ID0gYWN0aW9uLnN0YXJ0O1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc2VuZCc7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFUVVFU1RfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzJztcbiAgICAgICAgICAgIGZvckVhY2goZGF0YS51c2VycywgdSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHUuaWQpID09IGFjdGlvbi5kYXRhLmZyaWVuZFJlcXVlc3QuZnJpZW5kSWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICBzZWxmRnJpZW5kSWQgPSBncmFwaGVuZS5JbnQoKVxuICAgICAgICAgICAgICAgICAgICBmcmllbmRVc2VySWQgPSBncmFwaGVuZS5JbnQoKVxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAvLyB1LnNlbGZGcmllbmRJZCA9IGFjdGlvbi5kYXRhLmZyaWVuZFJlcXVlc3QuaWRcbiAgICAgICAgICAgICAgICAgICAgdS5mcmllbmRVc2VySWQgPSBhY3Rpb24uZGF0YS5mcmllbmRSZXF1ZXN0LnVzZXJJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBkYXRhLnVzZXJzID0gYWN0aW9uLmRhdGEuZ2V0VXNlckxpc3QudXNlcnM7XG4gICAgICAgICAgICAvLyBkYXRhLmNvdW50ID0gYWN0aW9uLmRhdGEuZ2V0VXNlckxpc3QuY291bnQ7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFUVVFU1RfRVJST1InOlxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgLy8gZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgIGNhc2UgJ0ZSSUVORF9SRU1PVkVfU0VORCc6XG4gICAgICAgICAgICAvLyBkYXRhLnN0YXJ0ID0gYWN0aW9uLnN0YXJ0O1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc2VuZCc7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnRlJJRU5EX1JFTU9WRV9TVUNDRVNTJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3MnO1xuICAgICAgICAgICAgZm9yRWFjaChkYXRhLnVzZXJzLCB1ID0+IHtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgICAnYWN0aW9uLmRhdGEuZnJpZW5kUmVtb3ZlLmlkJyxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLmRhdGEuZnJpZW5kUmVtb3ZlLmlkXG4gICAgICAgICAgICAgICAgKTtcblxuXG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHUuaWQpID09IGFjdGlvbi5kYXRhLmZyaWVuZFJlbW92ZS5mcmllbmRJZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgIHNlbGZGcmllbmRJZCA9IGdyYXBoZW5lLkludCgpXG4gICAgICAgICAgICAgICAgICAgIGZyaWVuZFVzZXJJZCA9IGdyYXBoZW5lLkludCgpXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHUuZnJpZW5kVXNlcklkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdGUklFTkRfUkVNT1ZFX0VSUk9SJzpcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIC8vIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB1c2VyTGlzdFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3N0YXRpY19zcmMvdXNlci9MaXN0UmVkLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==