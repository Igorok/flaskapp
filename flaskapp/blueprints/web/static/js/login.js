webpackJsonp([8],{314:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),o=n(r),l=a(12),s=a(8);a(24),a(25);var u=a(9),c=a(315),i=n(c),p=a(26),f=n(p),d=a(27),m=(0,d.configureStore)({auth:f.default}),h=(0,u.layout)({comp:i.default});(0,l.render)(o.default.createElement(s.Provider,{store:m},o.default.createElement(h,null)),document.getElementById("root"))},315:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(2),c=function(e){return e&&e.__esModule?e:{default:e}}(u),i=a(8),p=a(29),f=a(9),d=function(e){function t(e){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={captcha:null},a}return o(t,e),s(t,[{key:"componentDidMount",value:function(){if(this.props.isAuthenticated)return window.location="/"}},{key:"formSubmit",value:function(e){if(e.preventDefault(),!this.state.captcha)return this.props.dispatch({type:"AUTH_ERROR",error:"Captcha is not valid!"});this.props.dispatch((0,p.graphql)({type:"AUTH",login:e.target.elements.loginInput.value,password:e.target.elements.passwordInput.value}))}},{key:"componentDidUpdate",value:function(){"success"===this.props.status&&setTimeout(function(){return window.location="/"},1e3)}},{key:"checkCaptcha",value:function(e){this.setState({captcha:e})}},{key:"render",value:function(){var e=null,t=null;return"error"===this.props.status?t={className:"danger",text:this.props.error||"Error, wrong login or password"}:"send"===this.props.status?(e="disabled",t={className:"info",text:"Loading, please wait"}):"success"===this.props.status&&(t={className:"success",text:"Loginned successfully"}),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-lg-offset-3 col-lg-6"},c.default.createElement("div",{className:"panel panel-default"},c.default.createElement("div",{className:"panel-heading"},c.default.createElement("h3",{className:"panel-title"},"Authentication")),c.default.createElement("div",{className:"panel-body"},c.default.createElement("form",{onSubmit:this.formSubmit.bind(this)},c.default.createElement("div",{className:"form-group"},c.default.createElement("label",{htmlFor:"loginInput"},"Login"),c.default.createElement("input",{type:"text",className:"form-control",id:"loginInput",placeholder:"Login",defaultValue:this.props.login,disabled:e})),c.default.createElement("div",{className:"form-group"},c.default.createElement("label",{htmlFor:"passwordInput"},"Password"),c.default.createElement("input",{type:"password",className:"form-control",id:"passwordInput",placeholder:"Password",defaultValue:this.props.password,disabled:e})),c.default.createElement(f.MathCaptcha,{cb:this.checkCaptcha.bind(this)}),c.default.createElement(f.AlertMessage,{opts:t}),c.default.createElement("button",{type:"submit",className:"btn btn-default btn-block",disabled:e},"Login")),c.default.createElement("br",null),c.default.createElement("p",{className:"text-center"},c.default.createElement("a",{href:"/registration"},"Registration"))))))}}]),t}(c.default.Component),m=function(e){return l({},e.auth)};d=(0,i.connect)(m)(d),t.default=d}},[314]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbG9naW4uanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9sb2dpbi5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL2F1dGgvTG9naW5Db21wLmpzIl0sIm5hbWVzIjpbIndlYnBhY2tKc29ucCIsIjMxNCIsIm1vZHVsZSIsImV4cG9ydHMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX3JlYWN0IiwiX3JlYWN0MiIsIl9yZWFjdERvbSIsIl9yZWFjdFJlZHV4IiwiX2NvbXBvbmVudCIsIl9Mb2dpbkNvbXAiLCJfTG9naW5Db21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfY29uZmlndXJlU3RvcmUiLCJzdG9yZSIsImNvbmZpZ3VyZVN0b3JlIiwiYXV0aCIsIkNvbXAiLCJsYXlvdXQiLCJjb21wIiwiTG9naW5Db21wIiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIlByb3ZpZGVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIjMxNSIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsInNlbGYiLCJjYWxsIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJkZWZpbmVQcm9wZXJ0eSIsIl9leHRlbmRzIiwiYXNzaWduIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImtleSIsImhhc093blByb3BlcnR5IiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInByb3BzIiwiZGVzY3JpcHRvciIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsIl9hY3Rpb24iLCJfUmVhY3QkQ29tcG9uZW50IiwidGhpcyIsIl90aGlzIiwiZ2V0UHJvdG90eXBlT2YiLCJzdGF0ZSIsImNhcHRjaGEiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImRpc3BhdGNoIiwidHlwZSIsImVycm9yIiwiZ3JhcGhxbCIsImxvZ2luIiwiZWxlbWVudHMiLCJsb2dpbklucHV0IiwicGFzc3dvcmQiLCJwYXNzd29yZElucHV0Iiwic3RhdHVzIiwic2V0VGltZW91dCIsInYiLCJzZXRTdGF0ZSIsImRpc2FibGVkIiwiYWxlcnRPcHRzIiwiY2xhc3NOYW1lIiwidGV4dCIsIm9uU3VibWl0IiwiZm9ybVN1Ym1pdCIsImJpbmQiLCJodG1sRm9yIiwiaWQiLCJwbGFjZWhvbGRlciIsImRlZmF1bHRWYWx1ZSIsIk1hdGhDYXB0Y2hhIiwiY2IiLCJjaGVja0NhcHRjaGEiLCJBbGVydE1lc3NhZ2UiLCJvcHRzIiwiaHJlZiIsIlJlYWN0IiwiQ29tcG9uZW50IiwibWFwU3RhdGVUb1Byb3BzIiwiY29ubmVjdCJdLCJtYXBwaW5ncyI6IkFBQUFBLGNBQWMsSUFFUkMsSUFDQSxTQUFVQyxFQUFRQyxFQUFTQyxHQUVqQyxZQTJCQSxTQUFTQyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxRQUFTRixHQ2hDdkYsR0FBQUcsR0FBQUwsRUFBQSxHRFVJTSxFQUFVTCxFQUF1QkksR0NUckNFLEVBQUFQLEVBQUEsSUFDQVEsRUFBQVIsRUFBQSxFQUVBQSxHQUFBLElBQ0FBLEVBQUEsR0FFQSxJQUFBUyxHQUFBVCxFQUFBLEdBQ0FVLEVBQUFWLEVBQUEsS0RnQklXLEVBQWNWLEVBQXVCUyxHQ2R6Q0UsRUFBQVosRUFBQSxJRGtCSWEsRUFBYVosRUFBdUJXLEdDaEJ4Q0UsRUFBQWQsRUFBQSxJQUVJZSxHQUFRLEVBQUFELEVBQUFFLGlCQUNYQyxLQUFNQSxZQUdIQyxHQUFPLEVBQUFULEVBQUFVLFNBQVFDLEtBQU1DLGFBQ3pCLEVBQUFkLEVBQUFlLFFBQ0NoQixFQUFBRixRQUFBbUIsY0FBQ2YsRUFBQWdCLFVBQVNULE1BQU9BLEdBQ2hCVCxFQUFBRixRQUFBbUIsY0FBQ0wsRUFBRCxPQUVETyxTQUFTQyxlQUFlLFVEd0JuQkMsSUFDQSxTQUFVN0IsRUFBUUMsRUFBU0MsR0FFakMsWUF1QkEsU0FBUzRCLEdBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBRWhILFFBQVNDLEdBQTJCQyxFQUFNQyxHQUFRLElBQUtELEVBQVEsS0FBTSxJQUFJRSxnQkFBZSw0REFBZ0UsUUFBT0QsR0FBeUIsZ0JBQVRBLElBQXFDLGtCQUFUQSxHQUE4QkQsRUFBUEMsRUFFbE8sUUFBU0UsR0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJUCxXQUFVLGlFQUFvRU8sR0FBZUQsR0FBU0UsVUFBWUMsT0FBT0MsT0FBT0gsR0FBY0EsRUFBV0MsV0FBYUcsYUFBZUMsTUFBT04sRUFBVU8sWUFBWSxFQUFPQyxVQUFVLEVBQU1DLGNBQWMsS0FBZVIsSUFBWUUsT0FBT08sZUFBaUJQLE9BQU9PLGVBQWVWLEVBQVVDLEdBQWNELEVBQVNXLFVBQVlWLEdBeEJqZUUsT0FBT1MsZUFBZWxELEVBQVMsY0FDM0I0QyxPQUFPLEdBR1gsSUFBSU8sR0FBV1YsT0FBT1csUUFBVSxTQUFVQyxHQUFVLElBQUssR0FBSUMsR0FBSSxFQUFHQSxFQUFJQyxVQUFVQyxPQUFRRixJQUFLLENBQUUsR0FBSUcsR0FBU0YsVUFBVUQsRUFBSSxLQUFLLEdBQUlJLEtBQU9ELEdBQWNoQixPQUFPRCxVQUFVbUIsZUFBZXhCLEtBQUtzQixFQUFRQyxLQUFRTCxFQUFPSyxHQUFPRCxFQUFPQyxJQUFZLE1BQU9MLElBRW5QTyxFQUFlLFdBQWMsUUFBU0MsR0FBaUJSLEVBQVFTLEdBQVMsSUFBSyxHQUFJUixHQUFJLEVBQUdBLEVBQUlRLEVBQU1OLE9BQVFGLElBQUssQ0FBRSxHQUFJUyxHQUFhRCxFQUFNUixFQUFJUyxHQUFXbEIsV0FBYWtCLEVBQVdsQixhQUFjLEVBQU9rQixFQUFXaEIsY0FBZSxFQUFVLFNBQVdnQixLQUFZQSxFQUFXakIsVUFBVyxHQUFNTCxPQUFPUyxlQUFlRyxFQUFRVSxFQUFXTCxJQUFLSyxJQUFpQixNQUFPLFVBQVVoQyxFQUFhaUMsRUFBWUMsR0FBaUosTUFBOUhELElBQVlILEVBQWlCOUIsRUFBWVMsVUFBV3dCLEdBQWlCQyxHQUFhSixFQUFpQjlCLEVBQWFrQyxHQUFxQmxDLE1FM0RoaUJ6QixFQUFBTCxFQUFBLEdGK0RJTSxFQVFKLFNBQWdDSixHQUFPLE1BQU9BLElBQU9BLEVBQUlDLFdBQWFELEdBQVFFLFFBQVNGLElBUmxERyxHRTlEckNHLEVBQUFSLEVBQUEsR0FDQWlFLEVBQUFqRSxFQUFBLElBQ0FTLEVBQUFULEVBQUEsR0FHTXFCLEVGeUVVLFNBQVU2QyxHRXhFdEIsUUFBQTdDLEdBQVl3QyxHQUFPakMsRUFBQXVDLEtBQUE5QyxFQUFBLElBQUErQyxHQUFBcEMsRUFBQW1DLE1BQUE5QyxFQUFBMkIsV0FBQVIsT0FBQTZCLGVBQUFoRCxJQUFBYSxLQUFBaUMsS0FDVE4sR0FEUyxPQUVmTyxHQUFLRSxPQUNEQyxRQUFTLE1BSEVILEVGNE9uQixNQW5LQWhDLEdBQVVmLEVBQVc2QyxHQWFyQlAsRUFBYXRDLElBQ1RvQyxJQUFLLG9CQUNMZCxNQUFPLFdFakZQLEdBQUl3QixLQUFLTixNQUFNVyxnQkFBaUIsTUFBT0MsUUFBT0MsU0FBVyxPRnFGekRqQixJQUFLLGFBQ0xkLE1BQU8sU0VuRkNnQyxHQUdSLEdBRkFBLEVBQUVDLGtCQUVJVCxLQUFLRyxNQUFNQyxRQUNiLE1BQU9KLE1BQUtOLE1BQU1nQixVQUNkQyxLQUFNLGFBQ05DLE1BQU8seUJBSWZaLE1BQUtOLE1BQU1nQixVQUFTLEVBQUFaLEVBQUFlLFVBQ2hCRixLQUFNLE9BQ05HLE1BQU9OLEVBQUV2QixPQUFPOEIsU0FBU0MsV0FBV3hDLE1BQ3BDeUMsU0FBVVQsRUFBRXZCLE9BQU84QixTQUFTRyxjQUFjMUMsWUZ1RjlDYyxJQUFLLHFCQUNMZCxNQUFPLFdFbkZtQixZQUF0QndCLEtBQUtOLE1BQU15QixRQUNYQyxXQUFXLFdBQ1AsTUFBT2QsUUFBT0MsU0FBVyxLQUMxQixRRndGUGpCLElBQUssZUFDTGQsTUFBTyxTRXRGRzZDLEdBQ1ZyQixLQUFLc0IsVUFDRGxCLFFBQVNpQixPRjBGYi9CLElBQUssU0FDTGQsTUFBTyxXRXZGUCxHQUFJK0MsR0FBVyxLQUNYQyxFQUFZLElBb0JoQixPQWxCMEIsVUFBdEJ4QixLQUFLTixNQUFNeUIsT0FDWEssR0FDSUMsVUFBVyxTQUNYQyxLQUFNMUIsS0FBS04sTUFBTWtCLE9BQVMsa0NBRUQsU0FBdEJaLEtBQUtOLE1BQU15QixRQUNsQkksRUFBVyxXQUNYQyxHQUNJQyxVQUFXLE9BQ1hDLEtBQU0seUJBRW1CLFlBQXRCMUIsS0FBS04sTUFBTXlCLFNBQ2xCSyxHQUNJQyxVQUFXLFVBQ1hDLEtBQU0sMEJBSVB2RixFQUFBRixRQUFBbUIsY0FBQSxPQUFLcUUsVUFBVSxPQUNsQnRGLEVBQUFGLFFBQUFtQixjQUFBLE9BQUtxRSxVQUFVLDRCQUNYdEYsRUFBQUYsUUFBQW1CLGNBQUEsT0FBS3FFLFVBQVUsdUJBQ1h0RixFQUFBRixRQUFBbUIsY0FBQSxPQUFLcUUsVUFBVSxpQkFDWHRGLEVBQUFGLFFBQUFtQixjQUFBLE1BQUlxRSxVQUFVLGVBQWQsbUJBRUp0RixFQUFBRixRQUFBbUIsY0FBQSxPQUFLcUUsVUFBVSxjQUdYdEYsRUFBQUYsUUFBQW1CLGNBQUEsUUFBTXVFLFNBQVkzQixLQUFLNEIsV0FBakJDLEtBQVk3QixPQUNkN0QsRUFBQUYsUUFBQW1CLGNBQUEsT0FBS3FFLFVBQVUsY0FDWHRGLEVBQUFGLFFBQUFtQixjQUFBLFNBQU8wRSxRQUFRLGNBQWYsU0FDQTNGLEVBQUFGLFFBQUFtQixjQUFBLFNBQ0l1RCxLQUFLLE9BQ0xjLFVBQVUsZUFDVk0sR0FBRyxhQUNIQyxZQUFZLFFBQ1pDLGFBQWNqQyxLQUFLTixNQUFNb0IsTUFDekJTLFNBQVVBLEtBR2xCcEYsRUFBQUYsUUFBQW1CLGNBQUEsT0FBS3FFLFVBQVUsY0FDWHRGLEVBQUFGLFFBQUFtQixjQUFBLFNBQU8wRSxRQUFRLGlCQUFmLFlBQ0EzRixFQUFBRixRQUFBbUIsY0FBQSxTQUNJdUQsS0FBSyxXQUNMYyxVQUFVLGVBQ1ZNLEdBQUcsZ0JBQ0hDLFlBQVksV0FDWkMsYUFBY2pDLEtBQUtOLE1BQU11QixTQUN6Qk0sU0FBVUEsS0FHbEJwRixFQUFBRixRQUFBbUIsY0FBQ2QsRUFBQTRGLGFBQVlDLEdBQU1uQyxLQUFLb0MsYUFBWFAsS0FBTTdCLFFBQ25CN0QsRUFBQUYsUUFBQW1CLGNBQUNkLEVBQUErRixjQUFhQyxLQUFNZCxJQUNwQnJGLEVBQUFGLFFBQUFtQixjQUFBLFVBQ0l1RCxLQUFLLFNBQ0xjLFVBQVUsNEJBQ1ZGLFNBQVVBLEdBSGQsVUFNSnBGLEVBQUFGLFFBQUFtQixjQUFBLFdBQ0FqQixFQUFBRixRQUFBbUIsY0FBQSxLQUFHcUUsVUFBVSxlQUNUdEYsRUFBQUYsUUFBQW1CLGNBQUEsS0FBR21GLEtBQUssaUJBQVIseUJGcUlqQnJGLEdFN09hc0YsVUFBTUMsV0FpSHhCQyxFQUFrQixTQUFDdkMsR0FDckIsTUFBQXBCLE1BQVdvQixFQUFNckQsTUFFckJJLElBQVksRUFBQWIsRUFBQXNHLFNBQVFELEdBQWlCeEYsR0ZpSXJDdEIsRUFBUUssUUUvSE9pQixLRm1JWiIsImZpbGUiOiJsb2dpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndlYnBhY2tKc29ucChbOF0se1xuXG4vKioqLyAzMTQ6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdERvbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpO1xuXG52YXIgX3JlYWN0UmVkdXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygyNSk7XG5cbnZhciBfY29tcG9uZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblxudmFyIF9Mb2dpbkNvbXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxNSk7XG5cbnZhciBfTG9naW5Db21wMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0xvZ2luQ29tcCk7XG5cbnZhciBfTG9naW5SZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTtcblxudmFyIF9Mb2dpblJlZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Mb2dpblJlZCk7XG5cbnZhciBfY29uZmlndXJlU3RvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHN0b3JlID0gKDAsIF9jb25maWd1cmVTdG9yZS5jb25maWd1cmVTdG9yZSkoe1xuXHRhdXRoOiBfTG9naW5SZWQyLmRlZmF1bHRcbn0pO1xuXG52YXIgQ29tcCA9ICgwLCBfY29tcG9uZW50LmxheW91dCkoeyBjb21wOiBfTG9naW5Db21wMi5kZWZhdWx0IH0pO1xuKDAsIF9yZWFjdERvbS5yZW5kZXIpKF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuXHRfcmVhY3RSZWR1eC5Qcm92aWRlcixcblx0eyBzdG9yZTogc3RvcmUgfSxcblx0X3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tcCwgbnVsbClcbiksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzE1OlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblxudmFyIF9hY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTtcblxudmFyIF9jb21wb25lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBMb2dpbkNvbXAgPSBmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICAgIF9pbmhlcml0cyhMb2dpbkNvbXAsIF9SZWFjdCRDb21wb25lbnQpO1xuXG4gICAgZnVuY3Rpb24gTG9naW5Db21wKHByb3BzKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2dpbkNvbXApO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChMb2dpbkNvbXAuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihMb2dpbkNvbXApKS5jYWxsKHRoaXMsIHByb3BzKSk7XG5cbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBjYXB0Y2hhOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTG9naW5Db21wLCBbe1xuICAgICAgICBrZXk6ICdjb21wb25lbnREaWRNb3VudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmlzQXV0aGVudGljYXRlZCkgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbiA9ICcvJztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZm9ybVN1Ym1pdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtU3VibWl0KGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLnN0YXRlLmNhcHRjaGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdBVVRIX0VSUk9SJyxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdDYXB0Y2hhIGlzIG5vdCB2YWxpZCEnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goKDAsIF9hY3Rpb24uZ3JhcGhxbCkoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdBVVRIJyxcbiAgICAgICAgICAgICAgICBsb2dpbjogZS50YXJnZXQuZWxlbWVudHMubG9naW5JbnB1dC52YWx1ZSxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogZS50YXJnZXQuZWxlbWVudHMucGFzc3dvcmRJbnB1dC52YWx1ZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjb21wb25lbnREaWRVcGRhdGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuc3RhdHVzID09PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbiA9ICcvJztcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY2hlY2tDYXB0Y2hhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrQ2FwdGNoYSh2KSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBjYXB0Y2hhOiB2XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgICAgIHZhciBkaXNhYmxlZCA9IG51bGwsXG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuc3RhdHVzID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnByb3BzLmVycm9yIHx8ICdFcnJvciwgd3JvbmcgbG9naW4gb3IgcGFzc3dvcmQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5zdGF0dXMgPT09ICdzZW5kJykge1xuICAgICAgICAgICAgICAgIGRpc2FibGVkID0gJ2Rpc2FibGVkJztcbiAgICAgICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2luZm8nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnTG9hZGluZywgcGxlYXNlIHdhaXQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5zdGF0dXMgPT09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdMb2dpbm5lZCBzdWNjZXNzZnVsbHknXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAncm93JyB9LFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdjb2wtbGctb2Zmc2V0LTMgY29sLWxnLTYnIH0sXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3BhbmVsIHBhbmVsLWRlZmF1bHQnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3BhbmVsLWhlYWRpbmcnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdoMycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAncGFuZWwtdGl0bGUnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBdXRoZW50aWNhdGlvbidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdwYW5lbC1ib2R5JyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZm9ybScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgb25TdWJtaXQ6IHRoaXMuZm9ybVN1Ym1pdC5iaW5kKHRoaXMpIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2Zvcm0tZ3JvdXAnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgaHRtbEZvcjogJ2xvZ2luSW5wdXQnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xvZ2luJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdpbnB1dCcsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZm9ybS1jb250cm9sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2xvZ2luSW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnTG9naW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5wcm9wcy5sb2dpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2Zvcm0tZ3JvdXAnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgaHRtbEZvcjogJ3Bhc3N3b3JkSW5wdXQnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1Bhc3N3b3JkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdpbnB1dCcsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Zvcm0tY29udHJvbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdwYXNzd29yZElucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ1Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IHRoaXMucHJvcHMucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50Lk1hdGhDYXB0Y2hhLCB7IGNiOiB0aGlzLmNoZWNrQ2FwdGNoYS5iaW5kKHRoaXMpIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50LkFsZXJ0TWVzc2FnZSwgeyBvcHRzOiBhbGVydE9wdHMgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Ym1pdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnYnRuIGJ0bi1kZWZhdWx0IGJ0bi1ibG9jaycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0xvZ2luJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnYnInLCBudWxsKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3AnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3RleHQtY2VudGVyJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgaHJlZjogJy9yZWdpc3RyYXRpb24nIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUmVnaXN0cmF0aW9uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBMb2dpbkNvbXA7XG59KF9yZWFjdDIuZGVmYXVsdC5Db21wb25lbnQpO1xuXG52YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7XG4gICAgcmV0dXJuIF9leHRlbmRzKHt9LCBzdGF0ZS5hdXRoKTtcbn07XG5Mb2dpbkNvbXAgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFwU3RhdGVUb1Byb3BzKShMb2dpbkNvbXApO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBMb2dpbkNvbXA7XG5cbi8qKiovIH0pXG5cbn0sWzMxNF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBsb2dpbi5qcyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJ3JlYWN0LWRvbSdcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAncmVhY3QtcmVkdXgnXG5cbmltcG9ydCAnYm9vdHN0cmFwL2Rpc3QvY3NzL2Jvb3RzdHJhcC5jc3MnO1xuaW1wb3J0ICcuL3N0eWxlcy9pbmRleC5zY3NzJ1xuXG5pbXBvcnQge2xheW91dH0gZnJvbSAnLi9oZWxwZXJzL2NvbXBvbmVudCdcbmltcG9ydCBMb2dpbkNvbXAgZnJvbSAnLi9hdXRoL0xvZ2luQ29tcCdcblxuaW1wb3J0IGF1dGggZnJvbSAnLi9hdXRoL0xvZ2luUmVkJ1xuXG5pbXBvcnQge2NvbmZpZ3VyZVN0b3JlfSBmcm9tICcuL2hlbHBlcnMvY29uZmlndXJlU3RvcmUnXG5cbmxldCBzdG9yZSA9IGNvbmZpZ3VyZVN0b3JlKHtcblx0YXV0aDogYXV0aCxcbn0pO1xuXG5sZXQgQ29tcCA9IGxheW91dCh7Y29tcDogTG9naW5Db21wfSk7XG5yZW5kZXIoXG5cdDxQcm92aWRlciBzdG9yZT17c3RvcmV9PlxuXHRcdDxDb21wIC8+XG5cdDwvUHJvdmlkZXI+LFxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpXG4pXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy9sb2dpbi5qcyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCdcbmltcG9ydCB7YXBpLCBncmFwaHFsfSBmcm9tICcuLi9oZWxwZXJzL2FjdGlvbidcbmltcG9ydCB7QWxlcnRNZXNzYWdlLCBNYXRoQ2FwdGNoYX0gZnJvbSAnLi4vaGVscGVycy9jb21wb25lbnQnXG5cblxuY2xhc3MgTG9naW5Db21wIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBjYXB0Y2hhOiBudWxsLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuaXNBdXRoZW50aWNhdGVkKSByZXR1cm4gd2luZG93LmxvY2F0aW9uID0gJy8nO1xuICAgIH1cblxuICAgIGZvcm1TdWJtaXQgKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1x0XG5cbiAgICAgICAgaWYgKCEgdGhpcy5zdGF0ZS5jYXB0Y2hhKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0FVVEhfRVJST1InLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnQ2FwdGNoYSBpcyBub3QgdmFsaWQhJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaChncmFwaHFsKHtcbiAgICAgICAgICAgIHR5cGU6ICdBVVRIJyxcbiAgICAgICAgICAgIGxvZ2luOiBlLnRhcmdldC5lbGVtZW50cy5sb2dpbklucHV0LnZhbHVlLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IGUudGFyZ2V0LmVsZW1lbnRzLnBhc3N3b3JkSW5wdXQudmFsdWUsXG4gICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUgKCkge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5zdGF0dXMgPT09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbiA9ICcvJztcbiAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNoZWNrQ2FwdGNoYSAodikge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGNhcHRjaGE6IHYsXG4gICAgICAgIH0pXG4gICAgfVxuICAgIHJlbmRlciAoKSB7XG4gICAgICAgIGxldCBkaXNhYmxlZCA9IG51bGwsXG4gICAgICAgICAgICBhbGVydE9wdHMgPSBudWxsO1xuICAgIFxuICAgICAgICBpZiAodGhpcy5wcm9wcy5zdGF0dXMgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMuZXJyb3IgfHwgJ0Vycm9yLCB3cm9uZyBsb2dpbiBvciBwYXNzd29yZCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLnN0YXR1cyA9PT0gJ3NlbmQnKSB7XG4gICAgICAgICAgICBkaXNhYmxlZCA9ICdkaXNhYmxlZCc7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW5mbycsXG4gICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0JyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgdGV4dDogJ0xvZ2lubmVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJyb3dcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLWxnLW9mZnNldC0zIGNvbC1sZy02XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYW5lbCBwYW5lbC1kZWZhdWx0XCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFuZWwtaGVhZGluZ1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInBhbmVsLXRpdGxlXCI+QXV0aGVudGljYXRpb248L2gzPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYW5lbC1ib2R5XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgPGZvcm0gb25TdWJtaXQ9ezo6dGhpcy5mb3JtU3VibWl0fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJsb2dpbklucHV0XCI+TG9naW48L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZm9ybS1jb250cm9sXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImxvZ2luSW5wdXRcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiTG9naW5cIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZT17dGhpcy5wcm9wcy5sb2dpbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJwYXNzd29yZElucHV0XCI+UGFzc3dvcmQ8L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwicGFzc3dvcmRcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvcm0tY29udHJvbFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJwYXNzd29yZElucHV0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlBhc3N3b3JkXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e3RoaXMucHJvcHMucGFzc3dvcmR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPE1hdGhDYXB0Y2hhIGNiPXs6OnRoaXMuY2hlY2tDYXB0Y2hhfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxBbGVydE1lc3NhZ2Ugb3B0cz17YWxlcnRPcHRzfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0IGJ0bi1ibG9ja1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+TG9naW48L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSd0ZXh0LWNlbnRlcic+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0nL3JlZ2lzdHJhdGlvbic+UmVnaXN0cmF0aW9uPC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgIH1cbn1cbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IChzdGF0ZSkgPT4ge1xuICAgIHJldHVybiB7Li4uc3RhdGUuYXV0aH1cbn1cbkxvZ2luQ29tcCA9IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShMb2dpbkNvbXApXG5cbmV4cG9ydCBkZWZhdWx0IExvZ2luQ29tcFxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3N0YXRpY19zcmMvYXV0aC9Mb2dpbkNvbXAuanMiXSwic291cmNlUm9vdCI6IiJ9