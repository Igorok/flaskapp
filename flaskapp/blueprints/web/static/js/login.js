webpackJsonp([10],{314:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var r=a(2),o=n(r),l=a(11),s=a(7);a(19),a(20);var u=a(9),c=a(315),i=n(c),p=a(21),f=n(p),d=a(22),m=(0,d.configureStore)({auth:f.default}),h=(0,u.layout)({comp:i.default});(0,l.render)(o.default.createElement(s.Provider,{store:m},o.default.createElement(h,null)),document.getElementById("root"))},315:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=a(2),c=function(e){return e&&e.__esModule?e:{default:e}}(u),i=a(7),p=a(25),f=a(9),d=function(e){function t(e){n(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={captcha:null},a}return o(t,e),s(t,[{key:"componentDidMount",value:function(){if(this.props.isAuthenticated)return window.location="/"}},{key:"formSubmit",value:function(e){if(e.preventDefault(),!this.state.captcha)return this.props.dispatch({type:"AUTH_ERROR",error:"Captcha is not valid!"});this.props.dispatch((0,p.graphql)({type:"AUTH",login:e.target.elements.loginInput.value,password:e.target.elements.passwordInput.value}))}},{key:"componentDidUpdate",value:function(){"success"===this.props.status&&setTimeout(function(){return window.location="/"},1e3)}},{key:"checkCaptcha",value:function(e){this.setState({captcha:e})}},{key:"render",value:function(){var e=null,t=null;return"error"===this.props.status?t={className:"danger",text:this.props.error||"Error, wrong login or password"}:"send"===this.props.status?(e="disabled",t={className:"info",text:"Loading, please wait"}):"success"===this.props.status&&(t={className:"success",text:"Loginned successfully"}),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-lg-offset-3 col-lg-6"},c.default.createElement("div",{className:"panel panel-default"},c.default.createElement("div",{className:"panel-heading"},c.default.createElement("h3",{className:"panel-title"},"Authentication")),c.default.createElement("div",{className:"panel-body"},c.default.createElement("form",{onSubmit:this.formSubmit.bind(this)},c.default.createElement("div",{className:"form-group"},c.default.createElement("label",{htmlFor:"loginInput"},"Login"),c.default.createElement("input",{type:"text",className:"form-control",id:"loginInput",placeholder:"Login",defaultValue:this.props.login,disabled:e})),c.default.createElement("div",{className:"form-group"},c.default.createElement("label",{htmlFor:"passwordInput"},"Password"),c.default.createElement("input",{type:"password",className:"form-control",id:"passwordInput",placeholder:"Password",defaultValue:this.props.password,disabled:e})),c.default.createElement(f.MathCaptcha,{cb:this.checkCaptcha.bind(this)}),c.default.createElement(f.AlertMessage,{opts:t}),c.default.createElement("button",{type:"submit",className:"btn btn-default btn-block",disabled:e},"Login")),c.default.createElement("br",null),c.default.createElement("p",{className:"text-center"},c.default.createElement("a",{href:"/registration"},"Registration"))))))}}]),t}(c.default.Component),m=function(e){return l({},e.auth)};d=(0,i.connect)(m)(d),t.default=d}},[314]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbG9naW4uanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9sb2dpbi5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL2F1dGgvTG9naW5Db21wLmpzIl0sIm5hbWVzIjpbIndlYnBhY2tKc29ucCIsIjMxNCIsIm1vZHVsZSIsImV4cG9ydHMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX3JlYWN0IiwiX3JlYWN0MiIsIl9yZWFjdERvbSIsIl9yZWFjdFJlZHV4IiwiX2NvbXBvbmVudCIsIl9Mb2dpbkNvbXAiLCJfTG9naW5Db21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfY29uZmlndXJlU3RvcmUiLCJzdG9yZSIsImNvbmZpZ3VyZVN0b3JlIiwiYXV0aCIsIkNvbXAiLCJsYXlvdXQiLCJjb21wIiwiTG9naW5Db21wIiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIlByb3ZpZGVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIjMxNSIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsInNlbGYiLCJjYWxsIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJkZWZpbmVQcm9wZXJ0eSIsIl9leHRlbmRzIiwiYXNzaWduIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImtleSIsImhhc093blByb3BlcnR5IiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInByb3BzIiwiZGVzY3JpcHRvciIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsIl9hY3Rpb24iLCJfUmVhY3QkQ29tcG9uZW50IiwidGhpcyIsIl90aGlzIiwiZ2V0UHJvdG90eXBlT2YiLCJzdGF0ZSIsImNhcHRjaGEiLCJpc0F1dGhlbnRpY2F0ZWQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImRpc3BhdGNoIiwidHlwZSIsImVycm9yIiwiZ3JhcGhxbCIsImxvZ2luIiwiZWxlbWVudHMiLCJsb2dpbklucHV0IiwicGFzc3dvcmQiLCJwYXNzd29yZElucHV0Iiwic3RhdHVzIiwic2V0VGltZW91dCIsInYiLCJzZXRTdGF0ZSIsImRpc2FibGVkIiwiYWxlcnRPcHRzIiwiY2xhc3NOYW1lIiwidGV4dCIsIm9uU3VibWl0IiwiZm9ybVN1Ym1pdCIsImJpbmQiLCJodG1sRm9yIiwiaWQiLCJwbGFjZWhvbGRlciIsImRlZmF1bHRWYWx1ZSIsIk1hdGhDYXB0Y2hhIiwiY2IiLCJjaGVja0NhcHRjaGEiLCJBbGVydE1lc3NhZ2UiLCJvcHRzIiwiaHJlZiIsIlJlYWN0IiwiQ29tcG9uZW50IiwibWFwU3RhdGVUb1Byb3BzIiwiY29ubmVjdCJdLCJtYXBwaW5ncyI6IkFBQUFBLGNBQWMsS0FFUkMsSUFDQSxTQUFVQyxFQUFRQyxFQUFTQyxHQUVqQyxZQTJCQSxTQUFTQyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxRQUFTRixHQ2hDdkYsR0FBQUcsR0FBQUwsRUFBQSxHRFVJTSxFQUFVTCxFQUF1QkksR0NUckNFLEVBQUFQLEVBQUEsSUFDQVEsRUFBQVIsRUFBQSxFQUVBQSxHQUFBLElBQ0FBLEVBQUEsR0FFQSxJQUFBUyxHQUFBVCxFQUFBLEdBQ0FVLEVBQUFWLEVBQUEsS0RnQklXLEVBQWNWLEVBQXVCUyxHQ2R6Q0UsRUFBQVosRUFBQSxJRGtCSWEsRUFBYVosRUFBdUJXLEdDaEJ4Q0UsRUFBQWQs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LFNBQ0l1RCxLQUFLLE9BQ0xjLFVBQVUsZUFDVk0sR0FBRyxhQUNIQyxZQUFZLFFBQ1pDLGFBQWNqQyxLQUFLTixNQUFNb0IsTUFDekJTLFNBQVVBLEtBR2xCcEYsRUFBQUYsUUFBQW1CLGNBQUEsT0FBS3FFLFVBQVUsY0FDWHRGLEVBQUFGLFFBQUFtQixjQUFBLFNBQU8wRSxRQUFRLGlCQUFmLFlBQ0EzRixFQUFBRixRQUFBbUIsY0FBQSxTQUNJdUQsS0FBSyxXQUNMYyxVQUFVLGVBQ1ZNLEdBQUcsZ0JBQ0hDLFlBQVksV0FDWkMsYUFBY2pDLEtBQUtOLE1BQU11QixTQUN6Qk0sU0FBVUEsS0FHbEJwRixFQUFBRixRQUFBbUIsY0FBQ2QsRUFBQTRGLGFBQVlDLEdBQU1uQyxLQUFLb0MsYUFBWFAsS0FBTTdCLFFBQ25CN0QsRUFBQUYsUUFBQW1CLGNBQUNkLEVBQUErRixjQUFhQyxLQUFNZCxJQUNwQnJGLEVBQUFGLFFBQUFtQixjQUFBLFVBQ0l1RCxLQUFLLFNBQ0xjLFVBQVUsNEJBQ1ZGLFNBQVVBLEdBSGQsVUFNSnBGLEVBQUFGLFFBQUFtQixjQUFBLFdBQ0FqQixFQUFBRixRQUFBbUIsY0FBQSxLQUFHcUUsVUFBVSxlQUNUdEYsRUFBQUYsUUFBQW1CLGNBQUEsS0FBR21GLEtBQUssaUJBQVIseUJGcUlqQnJGLEdFN09hc0YsVUFBTUMsV0FpSHhCQyxFQUFrQixTQUFDdkMsR0FDckIsTUFBQXBCLE1BQVdvQixFQUFNckQsTUFFckJJLElBQVksRUFBQWIsRUFBQXNHLFNBQVFELEdBQWlCeEYsR0ZpSXJDdEIsRUFBUUssUUUvSE9pQixLRm1JWiIsImZpbGUiOiJsb2dpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndlYnBhY2tKc29ucChbMTBdLHtcblxuLyoqKi8gMzE0OlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG52YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfcmVhY3REb20gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7XG5cbl9fd2VicGFja19yZXF1aXJlX18oMjApO1xuXG52YXIgX2NvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cbnZhciBfTG9naW5Db21wID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMTUpO1xuXG52YXIgX0xvZ2luQ29tcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Mb2dpbkNvbXApO1xuXG52YXIgX0xvZ2luUmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7XG5cbnZhciBfTG9naW5SZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTG9naW5SZWQpO1xuXG52YXIgX2NvbmZpZ3VyZVN0b3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBzdG9yZSA9ICgwLCBfY29uZmlndXJlU3RvcmUuY29uZmlndXJlU3RvcmUpKHtcblx0YXV0aDogX0xvZ2luUmVkMi5kZWZhdWx0XG59KTtcblxudmFyIENvbXAgPSAoMCwgX2NvbXBvbmVudC5sYXlvdXQpKHsgY29tcDogX0xvZ2luQ29tcDIuZGVmYXVsdCB9KTtcbigwLCBfcmVhY3REb20ucmVuZGVyKShfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcblx0X3JlYWN0UmVkdXguUHJvdmlkZXIsXG5cdHsgc3RvcmU6IHN0b3JlIH0sXG5cdF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbXAsIG51bGwpXG4pLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpKTtcblxuLyoqKi8gfSksXG5cbi8qKiovIDMxNTpcbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfcmVhY3RSZWR1eCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cbnZhciBfYWN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSk7XG5cbnZhciBfY29tcG9uZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgTG9naW5Db21wID0gZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgICBfaW5oZXJpdHMoTG9naW5Db21wLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICAgIGZ1bmN0aW9uIExvZ2luQ29tcChwcm9wcykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTG9naW5Db21wKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTG9naW5Db21wLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTG9naW5Db21wKSkuY2FsbCh0aGlzLCBwcm9wcykpO1xuXG4gICAgICAgIF90aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgY2FwdGNoYTogbnVsbFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKExvZ2luQ29tcCwgW3tcbiAgICAgICAga2V5OiAnY29tcG9uZW50RGlkTW91bnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5pc0F1dGhlbnRpY2F0ZWQpIHJldHVybiB3aW5kb3cubG9jYXRpb24gPSAnLyc7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Zvcm1TdWJtaXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybVN1Ym1pdChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5jYXB0Y2hhKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQVVUSF9FUlJPUicsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnQ2FwdGNoYSBpcyBub3QgdmFsaWQhJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnByb3BzLmRpc3BhdGNoKCgwLCBfYWN0aW9uLmdyYXBocWwpKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnQVVUSCcsXG4gICAgICAgICAgICAgICAgbG9naW46IGUudGFyZ2V0LmVsZW1lbnRzLmxvZ2luSW5wdXQudmFsdWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGUudGFyZ2V0LmVsZW1lbnRzLnBhc3N3b3JkSW5wdXQudmFsdWVcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY29tcG9uZW50RGlkVXBkYXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLnN0YXR1cyA9PT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24gPSAnLyc7XG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NoZWNrQ2FwdGNoYScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja0NhcHRjaGEodikge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgY2FwdGNoYTogdlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbmRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICAgICAgICB2YXIgZGlzYWJsZWQgPSBudWxsLFxuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLnN0YXR1cyA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZGFuZ2VyJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wcm9wcy5lcnJvciB8fCAnRXJyb3IsIHdyb25nIGxvZ2luIG9yIHBhc3N3b3JkJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuc3RhdHVzID09PSAnc2VuZCcpIHtcbiAgICAgICAgICAgICAgICBkaXNhYmxlZCA9ICdkaXNhYmxlZCc7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdpbmZvJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuc3RhdHVzID09PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnTG9naW5uZWQgc3VjY2Vzc2Z1bGx5J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3JvdycgfSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY29sLWxnLW9mZnNldC0zIGNvbC1sZy02JyB9LFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdwYW5lbCBwYW5lbC1kZWZhdWx0JyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdwYW5lbC1oZWFkaW5nJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaDMnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ3BhbmVsLXRpdGxlJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQXV0aGVudGljYXRpb24nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAncGFuZWwtYm9keScgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IG9uU3VibWl0OiB0aGlzLmZvcm1TdWJtaXQuYmluZCh0aGlzKSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdmb3JtLWdyb3VwJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGh0bWxGb3I6ICdsb2dpbklucHV0JyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMb2dpbidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Zvcm0tY29udHJvbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICdsb2dpbklucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ0xvZ2luJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IHRoaXMucHJvcHMubG9naW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdmb3JtLWdyb3VwJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGh0bWxGb3I6ICdwYXNzd29yZElucHV0JyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdQYXNzd29yZCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdmb3JtLWNvbnRyb2wnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAncGFzc3dvcmRJbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdQYXNzd29yZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLnByb3BzLnBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudC5NYXRoQ2FwdGNoYSwgeyBjYjogdGhpcy5jaGVja0NhcHRjaGEuYmluZCh0aGlzKSB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudC5BbGVydE1lc3NhZ2UsIHsgb3B0czogYWxlcnRPcHRzIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWJtaXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCBidG4tYmxvY2snLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdMb2dpbidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ2JyJywgbnVsbCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICd0ZXh0LWNlbnRlcicgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGhyZWY6ICcvcmVnaXN0cmF0aW9uJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1JlZ2lzdHJhdGlvbidcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTG9naW5Db21wO1xufShfcmVhY3QyLmRlZmF1bHQuQ29tcG9uZW50KTtcblxudmFyIG1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcFN0YXRlVG9Qcm9wcyhzdGF0ZSkge1xuICAgIHJldHVybiBfZXh0ZW5kcyh7fSwgc3RhdGUuYXV0aCk7XG59O1xuTG9naW5Db21wID0gKDAsIF9yZWFjdFJlZHV4LmNvbm5lY3QpKG1hcFN0YXRlVG9Qcm9wcykoTG9naW5Db21wKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTG9naW5Db21wO1xuXG4vKioqLyB9KVxuXG59LFszMTRdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbG9naW4uanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyByZW5kZXIgfSBmcm9tICdyZWFjdC1kb20nXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gJ3JlYWN0LXJlZHV4J1xuXG5pbXBvcnQgJ2Jvb3RzdHJhcC9kaXN0L2Nzcy9ib290c3RyYXAuY3NzJztcbmltcG9ydCAnLi9zdHlsZXMvaW5kZXguc2NzcydcblxuaW1wb3J0IHtsYXlvdXR9IGZyb20gJy4vaGVscGVycy9jb21wb25lbnQnXG5pbXBvcnQgTG9naW5Db21wIGZyb20gJy4vYXV0aC9Mb2dpbkNvbXAnXG5cbmltcG9ydCBhdXRoIGZyb20gJy4vYXV0aC9Mb2dpblJlZCdcblxuaW1wb3J0IHtjb25maWd1cmVTdG9yZX0gZnJvbSAnLi9oZWxwZXJzL2NvbmZpZ3VyZVN0b3JlJ1xuXG5sZXQgc3RvcmUgPSBjb25maWd1cmVTdG9yZSh7XG5cdGF1dGg6IGF1dGgsXG59KTtcblxubGV0IENvbXAgPSBsYXlvdXQoe2NvbXA6IExvZ2luQ29tcH0pO1xucmVuZGVyKFxuXHQ8UHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cblx0XHQ8Q29tcCAvPlxuXHQ8L1Byb3ZpZGVyPixcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKVxuKVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3N0YXRpY19zcmMvbG9naW4uanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnXG5pbXBvcnQge2FwaSwgZ3JhcGhxbH0gZnJvbSAnLi4vaGVscGVycy9hY3Rpb24nXG5pbXBvcnQge0FsZXJ0TWVzc2FnZSwgTWF0aENhcHRjaGF9IGZyb20gJy4uL2hlbHBlcnMvY29tcG9uZW50J1xuXG5cbmNsYXNzIExvZ2luQ29tcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgY2FwdGNoYTogbnVsbCxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmlzQXV0aGVudGljYXRlZCkgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbiA9ICcvJztcbiAgICB9XG5cbiAgICBmb3JtU3VibWl0IChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcdFxuXG4gICAgICAgIGlmICghIHRoaXMuc3RhdGUuY2FwdGNoYSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdBVVRIX0VSUk9SJyxcbiAgICAgICAgICAgICAgICBlcnJvcjogJ0NhcHRjaGEgaXMgbm90IHZhbGlkIScsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnQVVUSCcsXG4gICAgICAgICAgICBsb2dpbjogZS50YXJnZXQuZWxlbWVudHMubG9naW5JbnB1dC52YWx1ZSxcbiAgICAgICAgICAgIHBhc3N3b3JkOiBlLnRhcmdldC5lbGVtZW50cy5wYXNzd29yZElucHV0LnZhbHVlLFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlICgpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuc3RhdHVzID09PSAnc3VjY2VzcycpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24gPSAnLyc7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjaGVja0NhcHRjaGEgKHYpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBjYXB0Y2hhOiB2LFxuICAgICAgICB9KVxuICAgIH1cbiAgICByZW5kZXIgKCkge1xuICAgICAgICBsZXQgZGlzYWJsZWQgPSBudWxsLFxuICAgICAgICAgICAgYWxlcnRPcHRzID0gbnVsbDtcbiAgICBcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuc3RhdHVzID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZGFuZ2VyJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnByb3BzLmVycm9yIHx8ICdFcnJvciwgd3JvbmcgbG9naW4gb3IgcGFzc3dvcmQnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5zdGF0dXMgPT09ICdzZW5kJykge1xuICAgICAgICAgICAgZGlzYWJsZWQgPSAnZGlzYWJsZWQnO1xuICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2luZm8nLFxuICAgICAgICAgICAgICAgIHRleHQ6ICdMb2FkaW5nLCBwbGVhc2Ugd2FpdCcsXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5zdGF0dXMgPT09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgIHRleHQ6ICdMb2dpbm5lZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwicm93XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC1sZy1vZmZzZXQtMyBjb2wtbGctNlwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFuZWwgcGFuZWwtZGVmYXVsdFwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhbmVsLWhlYWRpbmdcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJwYW5lbC10aXRsZVwiPkF1dGhlbnRpY2F0aW9uPC9oMz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFuZWwtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxmb3JtIG9uU3VibWl0PXs6OnRoaXMuZm9ybVN1Ym1pdH0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWdyb3VwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwibG9naW5JbnB1dFwiPkxvZ2luPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZvcm0tY29udHJvbFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJsb2dpbklucHV0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkxvZ2luXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9e3RoaXMucHJvcHMubG9naW59XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWdyb3VwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwicGFzc3dvcmRJbnB1dFwiPlBhc3N3b3JkPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cInBhc3N3b3JkXCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwicGFzc3dvcmRJbnB1dFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJQYXNzd29yZFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlPXt0aGlzLnByb3BzLnBhc3N3b3JkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxNYXRoQ2FwdGNoYSBjYj17Ojp0aGlzLmNoZWNrQ2FwdGNoYX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWxlcnRNZXNzYWdlIG9wdHM9e2FsZXJ0T3B0c30gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwic3VibWl0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdCBidG4tYmxvY2tcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPkxvZ2luPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ndGV4dC1jZW50ZXInPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9Jy9yZWdpc3RyYXRpb24nPlJlZ2lzdHJhdGlvbjwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICB9XG59XG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGUpID0+IHtcbiAgICByZXR1cm4gey4uLnN0YXRlLmF1dGh9XG59XG5Mb2dpbkNvbXAgPSBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcykoTG9naW5Db21wKVxuXG5leHBvcnQgZGVmYXVsdCBMb2dpbkNvbXBcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zdGF0aWNfc3JjL2F1dGgvTG9naW5Db21wLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==