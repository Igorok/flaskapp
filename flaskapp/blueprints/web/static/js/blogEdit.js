webpackJsonp([6],{331:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var l=a(2),i=r(l),n=a(11),o=a(8);a(21),a(145),a(22);var s=a(9),u=a(333),c=r(u),d=a(23),f=r(d),p=a(334),b=r(p),g=a(24),h=(0,g.configureStore)({auth:f.default,blogEdit:b.default}),m=(0,s.layout)({comp:c.default,forAuth:!0});(0,n.render)(i.default.createElement(o.Provider,{store:h},i.default.createElement(m,null)),document.getElementById("root"))},333:function(t,e,a){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},o=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),s=a(2),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=a(8),d=a(28),f=a(9),p=function(t){function e(t){r(this,e);var a=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.state=n({},t.blogEdit),a}return i(e,t),o(e,[{key:"componentWillMount",value:function(){-1!==this.state.id&&this.props.dispatch((0,d.graphql)({type:"BLOG_GET",id:this.state.id}))}},{key:"componentWillReceiveProps",value:function(t){"success_get"==t.blogEdit.status&&this.setState({title:t.blogEdit.title,text:t.blogEdit.text,public:t.blogEdit.public,date:t.blogEdit.date})}},{key:"fieldChange",value:function(t){var e={},a="public"==t.target.id?t.target.checked:t.target.value;e[t.target.id]=a,this.setState(e)}},{key:"formSubmit",value:function(t){if(t.preventDefault(),text&&text.length>512)return this.props.dispatch({type:"BLOG_EDIT_ERROR",error:"Text is too long!"});this.props.dispatch((0,d.graphql)({type:"BLOG_EDIT",id:this.state.id,title:this.state.title,text:this.state.text,public:this.state.public}))}},{key:"render",value:function(){var t=this,e=null;return"error"===this.props.blogEdit.status?e={className:"danger",text:this.props.blogEdit.error||"Error, wrong blog data"}:"send"===this.props.blogEdit.status?e={className:"info",text:"Loading, please wait"}:"success_edit"===this.props.blogEdit.status&&(e={className:"success",text:"Blog saved successfully"},setTimeout(function(){window.location="/blog-edit/"+t.props.blogEdit.id},1e3)),u.default.createElement("div",null,u.default.createElement("form",{onSubmit:this.formSubmit.bind(this)},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{htmlFor:"title"},"Title"),u.default.createElement("input",{required:!0,type:"text",className:"form-control",id:"title",placeholder:"Title",onChange:this.fieldChange.bind(this),value:this.state.title})),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{htmlFor:"text"},"Text"),u.default.createElement("textarea",{required:!0,className:"form-control",id:"text",placeholder:"Text",onChange:this.fieldChange.bind(this),value:this.state.text})),u.default.createElement("div",{className:"checkbox"},u.default.createElement("label",null,u.default.createElement("input",{type:"checkbox",id:"public",onChange:this.fieldChange.bind(this),checked:!!this.state.public})," Public")),u.default.createElement(f.AlertMessage,{opts:e}),u.default.createElement("hr",null),u.default.createElement("div",null,u.default.createElement("button",{type:"submit",className:"btn btn-primary"},u.default.createElement("span",{className:"glyphicon glyphicon-floppy-disk"}),"Â  Save")),u.default.createElement("br",null)))}}]),e}(u.default.Component),b=function(t){return n({},t)};p=(0,c.connect)(b)(p),e.default=p},334:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},l=window.localParams.blogId||"-1",i={id:parseInt(l),user_id:0,user_name:"",title:"",text:"",date:"",public:!1,status:null},n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e=arguments[1],a=null;switch(e.type){case"BLOG_GET_SEND":return r({status:"send"},t);case"BLOG_GET_SUCCESS":return a=r({},t),a.status="success_get",a.id=e.data.getBlog.id,a.user_id=e.data.getBlog.userId,a.user_name=e.data.getBlog.userName,a.text=e.data.getBlog.text,a.title=e.data.getBlog.title,a.date=e.data.getBlog.date,a.public=!!e.data.getBlog.public,a;case"BLOG_GET_ERROR":return r({status:"error",error:e.error},t);case"BLOG_EDIT_SEND":return a=r({},t),a.status="send",a.id=e.id,a.text=e.text,a.title=e.title,a.public=e.public,a;case"BLOG_EDIT_SUCCESS":return a=r({},t),a.status="success_edit",a.id=e.data.editBlog.id,a.text=e.data.editBlog.text,a.title=e.data.editBlog.title,a.public=e.data.editBlog.public,a;case"BLOG_EDIT_ERROR":return a=r({},t),a.status="error",a.error=e.error,a;default:return t}};e.default=n}},[331]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYmxvZ0VkaXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9ibG9nRWRpdC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL2Jsb2cvRWRpdENvbXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9ibG9nL0VkaXRSZWQuanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wIiwiMzMxIiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfcmVhY3QiLCJfcmVhY3QyIiwiX3JlYWN0RG9tIiwiX3JlYWN0UmVkdXgiLCJfY29tcG9uZW50IiwiX0VkaXRDb21wIiwiX0VkaXRDb21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfRWRpdFJlZCIsIl9FZGl0UmVkMiIsIl9jb25maWd1cmVTdG9yZSIsInN0b3JlIiwiY29uZmlndXJlU3RvcmUiLCJhdXRoIiwiYmxvZ0VkaXQiLCJDb21wIiwibGF5b3V0IiwiY29tcCIsIkVkaXRDb21wIiwiZm9yQXV0aCIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJQcm92aWRlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCIzMzMiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiZGVmaW5lUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzb3VyY2UiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfYWN0aW9uIiwiX1JlYWN0JENvbXBvbmVudCIsInRoaXMiLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwic3RhdGUiLCJpZCIsImRpc3BhdGNoIiwiZ3JhcGhxbCIsInR5cGUiLCJuZXh0UHJvcHMiLCJzdGF0dXMiLCJzZXRTdGF0ZSIsInRpdGxlIiwidGV4dCIsInB1YmxpYyIsImRhdGUiLCJlIiwic3RhdGVPYmoiLCJ2YWwiLCJjaGVja2VkIiwicHJldmVudERlZmF1bHQiLCJlcnJvciIsIl90aGlzMiIsImFsZXJ0T3B0cyIsImNsYXNzTmFtZSIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsIm9uU3VibWl0IiwiZm9ybVN1Ym1pdCIsImJpbmQiLCJodG1sRm9yIiwicmVxdWlyZWQiLCJwbGFjZWhvbGRlciIsIm9uQ2hhbmdlIiwiZmllbGRDaGFuZ2UiLCJBbGVydE1lc3NhZ2UiLCJvcHRzIiwiUmVhY3QiLCJDb21wb25lbnQiLCJtYXBTdGF0ZVRvUHJvcHMiLCJjb25uZWN0IiwiMzM0IiwiYmxvZ0lkIiwibG9jYWxQYXJhbXMiLCJpbml0U3RhdGUiLCJwYXJzZUludCIsInVzZXJfaWQiLCJ1c2VyX25hbWUiLCJ1bmRlZmluZWQiLCJhY3Rpb24iLCJkYXRhIiwiZ2V0QmxvZyIsInVzZXJJZCIsInVzZXJOYW1lIiwiZWRpdEJsb2ciXSwibWFwcGluZ3MiOiJBQUFBQSxjQUFjLElBRVJDLElBQ0EsU0FBVUMsRUFBUUMsRUFBU0MsR0FFakMsWUFpQ0EsU0FBU0MsR0FBdUJDLEdBQU8sTUFBT0EsSUFBT0EsRUFBSUMsV0FBYUQsR0FBUUUsUUFBU0YsR0N0Q3ZGLEdBQUFHLEdBQUFMLEVBQUEsR0RVSU0s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QUNkeUMsRUFBSzlCLE1BQVE2QixFQUFPN0IsTUFDYjhCLENBR1gsU0FDSSxNQUFPL0MsSUhzUm5CM0UsR0FBUUssUUdsUk9nQixLSHNSWiIsImZpbGUiOiJibG9nRWRpdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIndlYnBhY2tKc29ucChbNl0se1xuXG4vKioqLyAzMzE6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdERvbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXG52YXIgX3JlYWN0UmVkdXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDIxKTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygxNDUpO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTtcblxudmFyIF9jb21wb25lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG52YXIgX0VkaXRDb21wID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMzMpO1xuXG52YXIgX0VkaXRDb21wMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0VkaXRDb21wKTtcblxudmFyIF9Mb2dpblJlZCA9IF9fd2VicGFja19yZXF1aXJlX18oMjMpO1xuXG52YXIgX0xvZ2luUmVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0xvZ2luUmVkKTtcblxudmFyIF9FZGl0UmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMzQpO1xuXG52YXIgX0VkaXRSZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRWRpdFJlZCk7XG5cbnZhciBfY29uZmlndXJlU3RvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI0KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHN0b3JlID0gKDAsIF9jb25maWd1cmVTdG9yZS5jb25maWd1cmVTdG9yZSkoe1xuXHRhdXRoOiBfTG9naW5SZWQyLmRlZmF1bHQsXG5cdGJsb2dFZGl0OiBfRWRpdFJlZDIuZGVmYXVsdFxufSk7XG5cbnZhciBDb21wID0gKDAsIF9jb21wb25lbnQubGF5b3V0KSh7IGNvbXA6IF9FZGl0Q29tcDIuZGVmYXVsdCwgZm9yQXV0aDogdHJ1ZSB9KTtcbigwLCBfcmVhY3REb20ucmVuZGVyKShfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcblx0X3JlYWN0UmVkdXguUHJvdmlkZXIsXG5cdHsgc3RvcmU6IHN0b3JlIH0sXG5cdF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbXAsIG51bGwpXG4pLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9vdCcpKTtcblxuLyoqKi8gfSksXG5cbi8qKiovIDMzMzpcbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfcmVhY3RSZWR1eCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cbnZhciBfYWN0aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7XG5cbnZhciBfY29tcG9uZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgRWRpdENvbXAgPSBmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuICAgIF9pbmhlcml0cyhFZGl0Q29tcCwgX1JlYWN0JENvbXBvbmVudCk7XG5cbiAgICBmdW5jdGlvbiBFZGl0Q29tcChwcm9wcykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRWRpdENvbXApO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChFZGl0Q29tcC5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEVkaXRDb21wKSkuY2FsbCh0aGlzLCBwcm9wcykpO1xuXG4gICAgICAgIF90aGlzLnN0YXRlID0gX2V4dGVuZHMoe30sIHByb3BzLmJsb2dFZGl0KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhFZGl0Q29tcCwgW3tcbiAgICAgICAga2V5OiAnY29tcG9uZW50V2lsbE1vdW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlLmlkID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaCgoMCwgX2FjdGlvbi5ncmFwaHFsKSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0JMT0dfR0VUJyxcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5zdGF0ZS5pZFxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgICAgICBpZiAobmV4dFByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PSAnc3VjY2Vzc19nZXQnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBuZXh0UHJvcHMuYmxvZ0VkaXQudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IG5leHRQcm9wcy5ibG9nRWRpdC50ZXh0LFxuICAgICAgICAgICAgICAgICAgICBwdWJsaWM6IG5leHRQcm9wcy5ibG9nRWRpdC5wdWJsaWMsXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IG5leHRQcm9wcy5ibG9nRWRpdC5kYXRlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2ZpZWxkQ2hhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZpZWxkQ2hhbmdlKGUpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZU9iaiA9IHt9O1xuICAgICAgICAgICAgdmFyIHZhbCA9IGUudGFyZ2V0LmlkID09ICdwdWJsaWMnID8gZS50YXJnZXQuY2hlY2tlZCA6IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgc3RhdGVPYmpbZS50YXJnZXQuaWRdID0gdmFsO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShzdGF0ZU9iaik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Zvcm1TdWJtaXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybVN1Ym1pdChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmICh0ZXh0ICYmIHRleHQubGVuZ3RoID4gNTEyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQkxPR19FRElUX0VSUk9SJyxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdUZXh0IGlzIHRvbyBsb25nISdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaCgoMCwgX2FjdGlvbi5ncmFwaHFsKSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0JMT0dfRURJVCcsXG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuc3RhdGUuaWQsXG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMuc3RhdGUudGl0bGUsXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5zdGF0ZS50ZXh0LFxuICAgICAgICAgICAgICAgIHB1YmxpYzogdGhpcy5zdGF0ZS5wdWJsaWNcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVuZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgYWxlcnRPcHRzID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuYmxvZ0VkaXQuc3RhdHVzID09PSAnZXJyb3InKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnByb3BzLmJsb2dFZGl0LmVycm9yIHx8ICdFcnJvciwgd3JvbmcgYmxvZyBkYXRhJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuYmxvZ0VkaXQuc3RhdHVzID09PSAnc2VuZCcpIHtcbiAgICAgICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2luZm8nLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnTG9hZGluZywgcGxlYXNlIHdhaXQnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT09ICdzdWNjZXNzX2VkaXQnKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0Jsb2cgc2F2ZWQgc3VjY2Vzc2Z1bGx5J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICcvYmxvZy1lZGl0LycgKyBfdGhpczIucHJvcHMuYmxvZ0VkaXQuaWQ7XG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAnZm9ybScsXG4gICAgICAgICAgICAgICAgICAgIHsgb25TdWJtaXQ6IHRoaXMuZm9ybVN1Ym1pdC5iaW5kKHRoaXMpIH0sXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2Zvcm0tZ3JvdXAnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgaHRtbEZvcjogJ3RpdGxlJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdUaXRsZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Zvcm0tY29udHJvbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICd0aXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdUaXRsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IHRoaXMuZmllbGRDaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5zdGF0ZS50aXRsZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnZm9ybS1ncm91cCcgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBodG1sRm9yOiAndGV4dCcgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZm9ybS1jb250cm9sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ3RleHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnVGV4dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IHRoaXMuZmllbGRDaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5zdGF0ZS50ZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdjaGVja2JveCcgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjaGVja2JveCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAncHVibGljJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IHRoaXMuZmllbGRDaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZDogISF0aGlzLnN0YXRlLnB1YmxpY1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgUHVibGljJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfY29tcG9uZW50LkFsZXJ0TWVzc2FnZSwgeyBvcHRzOiBhbGVydE9wdHMgfSksXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdocicsIG51bGwpLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdHlwZTogJ3N1Ym1pdCcsIGNsYXNzTmFtZTogJ2J0biBidG4tcHJpbWFyeScgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiAnZ2x5cGhpY29uIGdseXBoaWNvbi1mbG9wcHktZGlzaycgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1xceEEwIFNhdmUnXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdicicsIG51bGwpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBFZGl0Q29tcDtcbn0oX3JlYWN0Mi5kZWZhdWx0LkNvbXBvbmVudCk7XG5cbnZhciBtYXBTdGF0ZVRvUHJvcHMgPSBmdW5jdGlvbiBtYXBTdGF0ZVRvUHJvcHMoc3RhdGUpIHtcbiAgICByZXR1cm4gX2V4dGVuZHMoe30sIHN0YXRlKTtcbn07XG5FZGl0Q29tcCA9ICgwLCBfcmVhY3RSZWR1eC5jb25uZWN0KShtYXBTdGF0ZVRvUHJvcHMpKEVkaXRDb21wKTtcbmV4cG9ydHMuZGVmYXVsdCA9IEVkaXRDb21wO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzM0OlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBibG9nSWQgPSB3aW5kb3cubG9jYWxQYXJhbXMuYmxvZ0lkIHx8ICctMSc7XG52YXIgaW5pdFN0YXRlID0ge1xuICAgIGlkOiBwYXJzZUludChibG9nSWQpLFxuICAgIHVzZXJfaWQ6IDAsXG4gICAgdXNlcl9uYW1lOiAnJyxcbiAgICB0aXRsZTogJycsXG4gICAgdGV4dDogJycsXG4gICAgZGF0ZTogJycsXG4gICAgcHVibGljOiBmYWxzZSxcbiAgICBzdGF0dXM6IG51bGxcbn07XG5cbnZhciBibG9nRWRpdCA9IGZ1bmN0aW9uIGJsb2dFZGl0KCkge1xuICAgIHZhciBzdGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogaW5pdFN0YXRlO1xuICAgIHZhciBhY3Rpb24gPSBhcmd1bWVudHNbMV07XG5cbiAgICB2YXIgZGF0YSA9IG51bGw7XG5cbiAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ0JMT0dfR0VUX1NFTkQnOlxuICAgICAgICAgICAgcmV0dXJuIF9leHRlbmRzKHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdzZW5kJ1xuICAgICAgICAgICAgfSwgc3RhdGUpO1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9TVUNDRVNTJzpcbiAgICAgICAgICAgIGRhdGEgPSBfZXh0ZW5kcyh7fSwgc3RhdGUpO1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc3VjY2Vzc19nZXQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5kYXRhLmdldEJsb2cuaWQ7XG4gICAgICAgICAgICBkYXRhLnVzZXJfaWQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnVzZXJJZDtcbiAgICAgICAgICAgIGRhdGEudXNlcl9uYW1lID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy51c2VyTmFtZTtcbiAgICAgICAgICAgIGRhdGEudGV4dCA9IGFjdGlvbi5kYXRhLmdldEJsb2cudGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnRpdGxlO1xuICAgICAgICAgICAgZGF0YS5kYXRlID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy5kYXRlO1xuICAgICAgICAgICAgZGF0YS5wdWJsaWMgPSAhIWFjdGlvbi5kYXRhLmdldEJsb2cucHVibGljO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0JMT0dfR0VUX0VSUk9SJzpcbiAgICAgICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICAgICAgICAgIGVycm9yOiBhY3Rpb24uZXJyb3JcbiAgICAgICAgICAgIH0sIHN0YXRlKTtcblxuICAgICAgICBjYXNlICdCTE9HX0VESVRfU0VORCc6XG4gICAgICAgICAgICBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3NlbmQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5pZDtcbiAgICAgICAgICAgIGRhdGEudGV4dCA9IGFjdGlvbi50ZXh0O1xuICAgICAgICAgICAgZGF0YS50aXRsZSA9IGFjdGlvbi50aXRsZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gYWN0aW9uLnB1YmxpYztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdCTE9HX0VESVRfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3NfZWRpdCc7XG4gICAgICAgICAgICBkYXRhLmlkID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cuaWQ7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy50ZXh0O1xuICAgICAgICAgICAgZGF0YS50aXRsZSA9IGFjdGlvbi5kYXRhLmVkaXRCbG9nLnRpdGxlO1xuICAgICAgICAgICAgZGF0YS5wdWJsaWMgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19FRElUX0VSUk9SJzpcbiAgICAgICAgICAgIGRhdGEgPSBfZXh0ZW5kcyh7fSwgc3RhdGUpO1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gYmxvZ0VkaXQ7XG5cbi8qKiovIH0pXG5cbn0sWzMzMV0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBibG9nRWRpdC5qcyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHJlbmRlciB9IGZyb20gJ3JlYWN0LWRvbSdcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSAncmVhY3QtcmVkdXgnXG5cbmltcG9ydCAnYm9vdHN0cmFwL2Rpc3QvY3NzL2Jvb3RzdHJhcC5jc3MnO1xuaW1wb3J0ICdyZWFjdC1kcmFmdC13eXNpd3lnL2Rpc3QvcmVhY3QtZHJhZnQtd3lzaXd5Zy5jc3MnO1xuaW1wb3J0ICcuL3N0eWxlcy9pbmRleC5zY3NzJ1xuXG5pbXBvcnQge2xheW91dH0gZnJvbSAnLi9oZWxwZXJzL2NvbXBvbmVudCdcbmltcG9ydCBFZGl0Q29tcCBmcm9tICcuL2Jsb2cvRWRpdENvbXAnXG5cbmltcG9ydCBhdXRoIGZyb20gJy4vYXV0aC9Mb2dpblJlZCdcbmltcG9ydCBibG9nRWRpdCBmcm9tICcuL2Jsb2cvRWRpdFJlZCdcblxuaW1wb3J0IHtjb25maWd1cmVTdG9yZX0gZnJvbSAnLi9oZWxwZXJzL2NvbmZpZ3VyZVN0b3JlJ1xuXG5cbmxldCBzdG9yZSA9IGNvbmZpZ3VyZVN0b3JlKHtcblx0YXV0aDogYXV0aCxcblx0YmxvZ0VkaXQ6IGJsb2dFZGl0LFxufSk7XG5cbmxldCBDb21wID0gbGF5b3V0KHtjb21wOiBFZGl0Q29tcCwgZm9yQXV0aDogdHJ1ZX0pO1xucmVuZGVyKFxuXHQ8UHJvdmlkZXIgc3RvcmU9e3N0b3JlfT5cblx0XHQ8Q29tcCAvPlxuXHQ8L1Byb3ZpZGVyPixcblx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKVxuKVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy9ibG9nRWRpdC5qcyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCdcbmltcG9ydCB7YXBpLCBncmFwaHFsfSBmcm9tICcuLi9oZWxwZXJzL2FjdGlvbidcbmltcG9ydCB7QWxlcnRNZXNzYWdlfSBmcm9tICcuLi9oZWxwZXJzL2NvbXBvbmVudCdcblxuXG5jbGFzcyBFZGl0Q29tcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0gey4uLnByb3BzLmJsb2dFZGl0fTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsTW91bnQgKCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5pZCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaChncmFwaHFsKHtcbiAgICAgICAgICAgIHR5cGU6ICdCTE9HX0dFVCcsXG4gICAgICAgICAgICBpZDogdGhpcy5zdGF0ZS5pZCxcbiAgICAgICAgfSkpO1xuXG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGlmIChuZXh0UHJvcHMuYmxvZ0VkaXQuc3RhdHVzID09ICdzdWNjZXNzX2dldCcpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiBuZXh0UHJvcHMuYmxvZ0VkaXQudGl0bGUsXG4gICAgICAgICAgICAgICAgdGV4dDogbmV4dFByb3BzLmJsb2dFZGl0LnRleHQsXG4gICAgICAgICAgICAgICAgcHVibGljOiBuZXh0UHJvcHMuYmxvZ0VkaXQucHVibGljLFxuICAgICAgICAgICAgICAgIGRhdGU6IG5leHRQcm9wcy5ibG9nRWRpdC5kYXRlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuXG4gICAgZmllbGRDaGFuZ2UgKGUpIHtcbiAgICAgICAgbGV0IHN0YXRlT2JqID0ge307XG4gICAgICAgIGxldCB2YWwgPSAoZS50YXJnZXQuaWQgPT0gJ3B1YmxpYycpID8gZS50YXJnZXQuY2hlY2tlZCA6IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICBzdGF0ZU9ialtlLnRhcmdldC5pZF0gPSB2YWw7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGVPYmopO1xuICAgIH1cbiAgICBcbiAgICBmb3JtU3VibWl0IChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBpZiAodGV4dCAmJiAodGV4dC5sZW5ndGggPiA1MTIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0JMT0dfRURJVF9FUlJPUicsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUZXh0IGlzIHRvbyBsb25nIScsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnQkxPR19FRElUJyxcbiAgICAgICAgICAgIGlkOiB0aGlzLnN0YXRlLmlkLFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuc3RhdGUudGl0bGUsXG4gICAgICAgICAgICB0ZXh0OiB0aGlzLnN0YXRlLnRleHQsXG4gICAgICAgICAgICBwdWJsaWM6IHRoaXMuc3RhdGUucHVibGljLFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgcmVuZGVyICgpIHtcbiAgICAgICAgbGV0IGFsZXJ0T3B0cyA9IG51bGw7XG4gICAgXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2RhbmdlcicsXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wcm9wcy5ibG9nRWRpdC5lcnJvciB8fCAnRXJyb3IsIHdyb25nIGJsb2cgZGF0YSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ3NlbmQnKSB7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW5mbycsXG4gICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0JyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ3N1Y2Nlc3NfZWRpdCcpIHtcbiAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnQmxvZyBzYXZlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJy9ibG9nLWVkaXQvJyArIHRoaXMucHJvcHMuYmxvZ0VkaXQuaWQ7XG4gICAgICAgICAgICB9LCAxMDAwKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDxkaXY+XG4gICAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17Ojp0aGlzLmZvcm1TdWJtaXR9ID5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0aXRsZVwiPlRpdGxlPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwidGl0bGVcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVGl0bGVcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXs6OnRoaXMuZmllbGRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS50aXRsZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0ZXh0XCI+VGV4dDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPSd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9J1RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17Ojp0aGlzLmZpZWxkQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUudGV4dH1cbiAgICAgICAgICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hlY2tib3hcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJjaGVja2JveFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSdwdWJsaWMnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXs6OnRoaXMuZmllbGRDaGFuZ2V9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQgPSB7ISEgdGhpcy5zdGF0ZS5wdWJsaWN9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPiBQdWJsaWNcbiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDxBbGVydE1lc3NhZ2Ugb3B0cz17YWxlcnRPcHRzfSAvPlxuXG4gICAgICAgICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgICAgICAgPGRpdiA+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGNsYXNzTmFtZT1cImJ0biBidG4tcHJpbWFyeVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdnbHlwaGljb24gZ2x5cGhpY29uLWZsb3BweS1kaXNrJz48L3NwYW4+Jm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICBTYXZlXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgfVxufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGUpID0+IHtcbiAgICByZXR1cm4gey4uLnN0YXRlfVxufVxuRWRpdENvbXAgPSBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcykoRWRpdENvbXApXG5leHBvcnQgZGVmYXVsdCBFZGl0Q29tcFxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy9ibG9nL0VkaXRDb21wLmpzIiwibGV0IGJsb2dJZCA9IHdpbmRvdy5sb2NhbFBhcmFtcy5ibG9nSWQgfHwgJy0xJztcbmxldCBpbml0U3RhdGUgPSB7XG4gICAgaWQ6IHBhcnNlSW50KGJsb2dJZCksXG4gICAgdXNlcl9pZDogMCxcbiAgICB1c2VyX25hbWU6ICcnLFxuICAgIHRpdGxlOiAnJyxcbiAgICB0ZXh0OiAnJyxcbiAgICBkYXRlOiAnJyxcbiAgICBwdWJsaWM6IGZhbHNlLFxuICAgIHN0YXR1czogbnVsbCxcbn07XG5cbmNvbnN0IGJsb2dFZGl0ID0gKHN0YXRlID0gaW5pdFN0YXRlLCBhY3Rpb24pID0+IHtcbiAgICBsZXQgZGF0YSA9IG51bGw7XG5cbiAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ0JMT0dfR0VUX1NFTkQnOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdzZW5kJyxcbiAgICAgICAgICAgICAgICAuLi5zdGF0ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhID0gey4uLnN0YXRlfTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3NfZ2V0JztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS51c2VyX2lkID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy51c2VySWQ7XG4gICAgICAgICAgICBkYXRhLnVzZXJfbmFtZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cudXNlck5hbWU7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnRleHQ7XG4gICAgICAgICAgICBkYXRhLnRpdGxlID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEuZGF0ZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cuZGF0ZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gISEgYWN0aW9uLmRhdGEuZ2V0QmxvZy5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfRVJST1InOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGFjdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NFTkQnOlxuICAgICAgICAgICAgZGF0YSA9IHsuLi5zdGF0ZX07XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uaWQ7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24udGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24udGl0bGU7XG4gICAgICAgICAgICBkYXRhLnB1YmxpYyA9IGFjdGlvbi5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YSA9IHsuLi5zdGF0ZX07XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzX2VkaXQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5kYXRhLmVkaXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS50ZXh0ID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cudGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cucHVibGljO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0JMT0dfRURJVF9FUlJPUic6XG4gICAgICAgICAgICBkYXRhID0gey4uLnN0YXRlfTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gc3RhdGVcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGJsb2dFZGl0XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy9ibG9nL0VkaXRSZWQuanMiXSwic291cmNlUm9vdCI6IiJ9