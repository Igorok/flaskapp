webpackJsonp([4],{328:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=a(4),l=r(i),o=a(15),n=a(9);a(25),a(145),a(26);var s=a(11),u=a(330),c=r(u),d=a(27),f=r(d),p=a(413),g=r(p),h=a(28),b=(0,h.configureStore)({auth:f.default,blogEdit:g.default}),m=(0,s.layout)({comp:c.default,forAuth:!0});(0,o.render)(l.default.createElement(n.Provider,{store:b},l.default.createElement(m,null)),document.getElementById("root"))},330:function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},s=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),u=a(4),c=r(u),d=a(9),f=a(31),p=a(11),g=a(40),h=a(171),b=r(h),m=a(172),E=r(m),y=a(173),v=function(t){function e(t){i(this,e);var a=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.state=n({},t.blogEdit),a.state.editorState=g.EditorState.createEmpty(),a}return o(e,t),s(e,[{key:"componentWillMount",value:function(){-1!==this.state.id&&this.props.dispatch((0,f.graphql)({type:"BLOG_GET",id:this.state.id}))}},{key:"componentWillReceiveProps",value:function(t){if("success_get"==t.blogEdit.status){var e=(0,E.default)(t.blogEdit.text),a=g.ContentState.createFromBlockArray(e.contentBlocks,e.entityMap);this.setState({title:t.blogEdit.title,text:t.blogEdit.text,public:t.blogEdit.public,date:t.blogEdit.date,editorState:g.EditorState.createWithContent(a)})}}},{key:"fieldChange",value:function(t){var e={},a="public"==t.target.id?t.target.checked:t.target.value;e[t.target.id]=a,this.setState(e)}},{key:"onEditorStateChange",value:function(t){this.setState({editorState:t})}},{key:"formSubmit",value:function(t){t.preventDefault();var e=(0,b.default)((0,g.convertToRaw)(this.state.editorState.getCurrentContent()));if(e&&e.length>512)return this.props.dispatch({type:"BLOG_EDIT_ERROR",error:"Text is too long!"});this.props.dispatch((0,f.graphql)({type:"BLOG_EDIT",id:this.state.id,title:this.state.title,text:(0,b.default)((0,g.convertToRaw)(this.state.editorState.getCurrentContent())),public:this.state.public}))}},{key:"render",value:function(){var t=this,e=null;return"error"===this.props.blogEdit.status?e={className:"danger",text:this.props.blogEdit.error||"Error, wrong blog data"}:"send"===this.props.blogEdit.status?e={className:"info",text:"Loading, please wait"}:"success_edit"===this.props.blogEdit.status&&(e={className:"success",text:"Blog saved successfully"},setTimeout(function(){window.location="/blog-edit/"+t.props.blogEdit.id},1e3)),c.default.createElement("div",null,c.default.createElement("form",{onSubmit:this.formSubmit.bind(this)},c.default.createElement("div",{className:"form-group"},c.default.createElement("label",{htmlFor:"title"},"Title"),c.default.createElement("input",{required:!0,type:"text",className:"form-control",id:"title",placeholder:"Title",onChange:this.fieldChange.bind(this),value:this.state.title})),c.default.createElement("div",{className:"form-group"},c.default.createElement("label",{htmlFor:"text"},"Text"),c.default.createElement(y.Editor,{editorState:this.state.editorState,editorClassName:"form-control",onEditorStateChange:this.onEditorStateChange.bind(this),toolbar:{options:["inline","list","fontSize","fontFamily","textAlign","link","history","colorPicker"]}})),c.default.createElement("div",{className:"checkbox"},c.default.createElement("label",null,c.default.createElement("input",{type:"checkbox",id:"public",onChange:this.fieldChange.bind(this),checked:!!this.state.public})," Public")),c.default.createElement(p.AlertMessage,{opts:e}),c.default.createElement("hr",null),c.default.createElement("div",null,c.default.createElement("button",{type:"submit",className:"btn btn-primary"},c.default.createElement("span",{className:"glyphicon glyphicon-floppy-disk"}),"Â  Save")),c.default.createElement("br",null)))}}]),e}(c.default.Component),_=function(t){return n({},t)};v=(0,d.connect)(_)(v),e.default=v},413:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},i=window.localParams.blogId||"-1",l={id:parseInt(i),user_id:0,user_name:"",title:"",text:"",date:"",public:!1,status:null},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,e=arguments[1],a=null;switch(e.type){case"BLOG_GET_SEND":return r({status:"send"},t);case"BLOG_GET_SUCCESS":return a=r({},t),a.status="success_get",a.id=e.data.getBlog.id,a.user_id=e.data.getBlog.userId,a.user_name=e.data.getBlog.userName,a.text=e.data.getBlog.text,a.title=e.data.getBlog.title,a.date=e.data.getBlog.date,a.public=!!e.data.getBlog.public,a;case"BLOG_GET_ERROR":return r({status:"error",error:e.error},t);case"BLOG_EDIT_SEND":return a=r({},t),a.status="send",a.id=e.id,a.text=e.text,a.title=e.title,a.public=e.public,a;case"BLOG_EDIT_SUCCESS":return a=r({},t),a.status="success_edit",a.id=e.data.editBlog.id,a.text=e.data.editBlog.text,a.title=e.data.editBlog.title,a.public=e.data.editBlog.public,a;case"BLOG_EDIT_ERROR":return a=r({},t),a.status="error",a.error=e.error,a;default:return t}};e.default=o}},[328]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYmxvZ0VkaXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9ibG9nRWRpdC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL2Jsb2cvRWRpdENvbXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9ibG9nL0VkaXRSZWQuanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wIiwiMzI4IiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfcmVhY3QiLCJfcmVhY3QyIiwiX3JlYWN0RG9tIiwiX3JlYWN0UmVkdXgiLCJfY29tcG9uZW50IiwiX0VkaXRDb21wIiwiX0VkaXRDb21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfRWRpdFJlZCIsIl9FZGl0UmVkMiIsIl9jb25maWd1cmVTdG9yZSIsInN0b3JlIiwiY29uZmlndXJlU3RvcmUiLCJhdXRoIiwiYmxvZ0VkaXQiLCJDb21wIiwibGF5b3V0IiwiY29tcCIsIkVkaXRDb21wIiwiZm9yQXV0aCIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJQcm92aWRlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCIzMzAiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiZGVmaW5lUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzb3VyY2UiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfYWN0aW9uIiwiX2RyYWZ0SnMiLCJfZHJhZnRqc1RvSHRtbCIsIl9kcmFmdGpzVG9IdG1sMiIsIl9odG1sVG9EcmFmdGpzIiwiX2h0bWxUb0RyYWZ0anMyIiwiX3JlYWN0RHJhZnRXeXNpd3lnIiwiX1JlYWN0JENvbXBvbmVudCIsInRoaXMiLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwic3RhdGUiLCJlZGl0b3JTdGF0ZSIsIkVkaXRvclN0YXRlIiwiY3JlYXRlRW1wdHkiLCJpZCIsImRpc3BhdGNoIiwiZ3JhcGhxbCIsInR5cGUiLCJuZXh0UHJvcHMiLCJzdGF0dXMiLCJibG9ja3NGcm9tSFRNTCIsInRleHQiLCJjb250ZW50IiwiQ29udGVudFN0YXRlIiwiY3JlYXRlRnJvbUJsb2NrQXJyYXkiLCJjb250ZW50QmxvY2tzIiwiZW50aXR5TWFwIiwic2V0U3RhdGUiLCJ0aXRsZSIsInB1YmxpYyIsImRhdGUiLCJjcmVhdGVXaXRoQ29udGVudCIsImUiLCJzdGF0ZU9iaiIsInZhbCIsImNoZWNrZWQiLCJwcmV2ZW50RGVmYXVsdCIsImNvbnZlcnRUb1JhdyIsImdldEN1cnJlbnRDb250ZW50IiwiZXJyb3IiLCJfdGhpczIiLCJhbGVydE9wdHMiLCJjbGFzc05hbWUiLCJzZXRUaW1lb3V0Iiwid2luZG93IiwibG9jYXRpb24iLCJvblN1Ym1pdCIsImZvcm1TdWJtaXQiLCJiaW5kIiwiaHRtbEZvciIsInJlcXVpcmVkIiwicGxhY2Vob2xkZXIiLCJvbkNoYW5nZSIsImZpZWxkQ2hhbmdlIiwiRWRpdG9yIiwiZWRpdG9yQ2xhc3NOYW1lIiwib25FZGl0b3JTdGF0ZUNoYW5nZSIsInRvb2xiYXIiLCJvcHRpb25zIiwiQWxlcnRNZXNzYWdlIiwib3B0cyIsIlJlYWN0IiwiQ29tcG9uZW50IiwibWFwU3RhdGVUb1Byb3BzIiwiY29ubmVjdCIsIjQxMyIsImJsb2dJZCIsImxvY2FsUGFyYW1zIiwiaW5pdFN0YXRlIiwicGFyc2VJbnQiLCJ1c2VyX2lkIiwidXNlcl9uYW1lIiwidW5kZWZpbmVkIiwiYWN0aW9uIiwiZGF0YSIsImdldEJsb2ciLCJ1c2VySWQiLCJ1c2VyTmFtZSIsImVkaXRCbG9nIl0sIm1hcHBpbmdzIjoiQUFBQUEsY0FBYyxJQUVSQyxJQUNBLFNBQVVDLEVBQVFDLEVBQVNDLEdBRWpDLFlBaUNBLFNBQVNDLEdBQXVCQyxHQUFPLE1BQU9BLElBQU9BLEVBQUlDLFdBQWFELEdBQVFFLFFBQVNGLEdDdEN2RixHQUFBRyxHQUFBTCxFQUFBLEdEVUlNLEVBQVVMLEVBQXVCSSxHQ1RyQ0UsRUFBQVAsRUFBQSxJQUNBUSxFQUFBUixFQUFBLEVBRUFBLEdBQUEsSUFDQUEsRUFBQSxLQUNBQSxFQUFBLEdBRUEsSUFBQVMsR0FBQVQsRUFBQSxJQUNBVSxFQUFBVixFQUFBLEtEaUJJVyxFQUFhVixFQUF1QlMsR0NmeENFLEVBQUFaLEVBQUEsSURtQklhLEVBQWFaLEVBQXVCVyxHQ2xCeENFLEVBQUFkLEVBQUEsS0RzQkllLEVBQVlkLEVBQXVCYSxHQ3BCdkNFLEVBQUFoQixFQUFBLElBR0lpQixHQUFRLEVBQUFELEVBQUFFLGlCQUNYQyxLQUFNQSxVQUNOQyxTQUFVQSxZQUdQQyxHQUFPLEVBQUFaLEVBQUFhLFNBQVFDLEtBQU1DLFVBQVVDLFNBQVMsS0FDNUMsRUFBQWxCLEVBQUFtQixRQUNDcEIsRUFBQUYsUUFBQXVCLGNBQUNuQixFQUFBb0IsVUFBU1gsTUFBT0EsR0FDaEJYLEVBQUFGLFFBQUF1QixjQUFDTixFQUFELE9BRURRLFNBQVNDLGVBQWUsVUQyQm5CQyxJQUNBLFNBQVVqQyxFQUFRQyxFQUFTQyxHQUVqQyxZQWlDQSxTQUFTQyxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxR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Q1hnRSxFQUFLdkQsT0FBUyxRQUNkdUQsRUFBS25DLE1BQVFrQyxFQUFPbEMsTUFDYm1DLENBR1gsU0FDSSxNQUFPaEUsSUgrU25CakYsR0FBUUssUUczU09nQixLSCtTWiIsImZpbGUiOiJibG9nRWRpdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIndlYnBhY2tKc29ucChbNF0se1xuXG4vKioqLyAzMjg6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdERvbSA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpO1xuXG52YXIgX3JlYWN0UmVkdXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTtcblxuX193ZWJwYWNrX3JlcXVpcmVfXygxNDUpO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTtcblxudmFyIF9jb21wb25lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcblxudmFyIF9FZGl0Q29tcCA9IF9fd2VicGFja19yZXF1aXJlX18oMzMwKTtcblxudmFyIF9FZGl0Q29tcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9FZGl0Q29tcCk7XG5cbnZhciBfTG9naW5SZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTtcblxudmFyIF9Mb2dpblJlZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9Mb2dpblJlZCk7XG5cbnZhciBfRWRpdFJlZCA9IF9fd2VicGFja19yZXF1aXJlX18oNDEzKTtcblxudmFyIF9FZGl0UmVkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0VkaXRSZWQpO1xuXG52YXIgX2NvbmZpZ3VyZVN0b3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBzdG9yZSA9ICgwLCBfY29uZmlndXJlU3RvcmUuY29uZmlndXJlU3RvcmUpKHtcblx0YXV0aDogX0xvZ2luUmVkMi5kZWZhdWx0LFxuXHRibG9nRWRpdDogX0VkaXRSZWQyLmRlZmF1bHRcbn0pO1xuXG52YXIgQ29tcCA9ICgwLCBfY29tcG9uZW50LmxheW91dCkoeyBjb21wOiBfRWRpdENvbXAyLmRlZmF1bHQsIGZvckF1dGg6IHRydWUgfSk7XG4oMCwgX3JlYWN0RG9tLnJlbmRlcikoX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG5cdF9yZWFjdFJlZHV4LlByb3ZpZGVyLFxuXHR7IHN0b3JlOiBzdG9yZSB9LFxuXHRfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChDb21wLCBudWxsKVxuKSwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jvb3QnKSk7XG5cbi8qKiovIH0pLFxuXG4vKioqLyAzMzA6XG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cbnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXG52YXIgX3JlYWN0UmVkdXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG52YXIgX2FjdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMzEpO1xuXG52YXIgX2NvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXG52YXIgX2RyYWZ0SnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQwKTtcblxudmFyIF9kcmFmdGpzVG9IdG1sID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzEpO1xuXG52YXIgX2RyYWZ0anNUb0h0bWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZHJhZnRqc1RvSHRtbCk7XG5cbnZhciBfaHRtbFRvRHJhZnRqcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTcyKTtcblxudmFyIF9odG1sVG9EcmFmdGpzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2h0bWxUb0RyYWZ0anMpO1xuXG52YXIgX3JlYWN0RHJhZnRXeXNpd3lnID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNzMpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBFZGl0Q29tcCA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gICAgX2luaGVyaXRzKEVkaXRDb21wLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICAgIGZ1bmN0aW9uIEVkaXRDb21wKHByb3BzKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFZGl0Q29tcCk7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEVkaXRDb21wLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRWRpdENvbXApKS5jYWxsKHRoaXMsIHByb3BzKSk7XG5cbiAgICAgICAgX3RoaXMuc3RhdGUgPSBfZXh0ZW5kcyh7fSwgcHJvcHMuYmxvZ0VkaXQpO1xuICAgICAgICBfdGhpcy5zdGF0ZS5lZGl0b3JTdGF0ZSA9IF9kcmFmdEpzLkVkaXRvclN0YXRlLmNyZWF0ZUVtcHR5KCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRWRpdENvbXAsIFt7XG4gICAgICAgIGtleTogJ2NvbXBvbmVudFdpbGxNb3VudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5pZCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goKDAsIF9hY3Rpb24uZ3JhcGhxbCkoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdCTE9HX0dFVCcsXG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuc3RhdGUuaWRcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICAgICAgaWYgKG5leHRQcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT0gJ3N1Y2Nlc3NfZ2V0Jykge1xuICAgICAgICAgICAgICAgIHZhciBibG9ja3NGcm9tSFRNTCA9ICgwLCBfaHRtbFRvRHJhZnRqczIuZGVmYXVsdCkobmV4dFByb3BzLmJsb2dFZGl0LnRleHQpO1xuICAgICAgICAgICAgICAgIHZhciBjb250ZW50ID0gX2RyYWZ0SnMuQ29udGVudFN0YXRlLmNyZWF0ZUZyb21CbG9ja0FycmF5KGJsb2Nrc0Zyb21IVE1MLmNvbnRlbnRCbG9ja3MsIGJsb2Nrc0Zyb21IVE1MLmVudGl0eU1hcCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG5leHRQcm9wcy5ibG9nRWRpdC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogbmV4dFByb3BzLmJsb2dFZGl0LnRleHQsXG4gICAgICAgICAgICAgICAgICAgIHB1YmxpYzogbmV4dFByb3BzLmJsb2dFZGl0LnB1YmxpYyxcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogbmV4dFByb3BzLmJsb2dFZGl0LmRhdGUsXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvclN0YXRlOiBfZHJhZnRKcy5FZGl0b3JTdGF0ZS5jcmVhdGVXaXRoQ29udGVudChjb250ZW50KVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdmaWVsZENoYW5nZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmaWVsZENoYW5nZShlKSB7XG4gICAgICAgICAgICB2YXIgc3RhdGVPYmogPSB7fTtcbiAgICAgICAgICAgIHZhciB2YWwgPSBlLnRhcmdldC5pZCA9PSAncHVibGljJyA/IGUudGFyZ2V0LmNoZWNrZWQgOiBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgIHN0YXRlT2JqW2UudGFyZ2V0LmlkXSA9IHZhbDtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGVPYmopO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkVkaXRvclN0YXRlQ2hhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uRWRpdG9yU3RhdGVDaGFuZ2UoZWRpdG9yU3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIGVkaXRvclN0YXRlOiBlZGl0b3JTdGF0ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Zvcm1TdWJtaXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybVN1Ym1pdChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB2YXIgdGV4dCA9ICgwLCBfZHJhZnRqc1RvSHRtbDIuZGVmYXVsdCkoKDAsIF9kcmFmdEpzLmNvbnZlcnRUb1JhdykodGhpcy5zdGF0ZS5lZGl0b3JTdGF0ZS5nZXRDdXJyZW50Q29udGVudCgpKSk7XG5cbiAgICAgICAgICAgIGlmICh0ZXh0ICYmIHRleHQubGVuZ3RoID4gNTEyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQkxPR19FRElUX0VSUk9SJyxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6ICdUZXh0IGlzIHRvbyBsb25nISdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaCgoMCwgX2FjdGlvbi5ncmFwaHFsKSh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0JMT0dfRURJVCcsXG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuc3RhdGUuaWQsXG4gICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMuc3RhdGUudGl0bGUsXG4gICAgICAgICAgICAgICAgdGV4dDogKDAsIF9kcmFmdGpzVG9IdG1sMi5kZWZhdWx0KSgoMCwgX2RyYWZ0SnMuY29udmVydFRvUmF3KSh0aGlzLnN0YXRlLmVkaXRvclN0YXRlLmdldEN1cnJlbnRDb250ZW50KCkpKSxcbiAgICAgICAgICAgICAgICBwdWJsaWM6IHRoaXMuc3RhdGUucHVibGljXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbmRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGFsZXJ0T3B0cyA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnZGFuZ2VyJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wcm9wcy5ibG9nRWRpdC5lcnJvciB8fCAnRXJyb3IsIHdyb25nIGJsb2cgZGF0YSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ3NlbmQnKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdpbmZvJyxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0J1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuYmxvZ0VkaXQuc3RhdHVzID09PSAnc3VjY2Vzc19lZGl0Jykge1xuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdCbG9nIHNhdmVkIHN1Y2Nlc3NmdWxseSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSAnL2Jsb2ctZWRpdC8nICsgX3RoaXMyLnByb3BzLmJsb2dFZGl0LmlkO1xuICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgJ2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICB7IG9uU3VibWl0OiB0aGlzLmZvcm1TdWJtaXQuYmluZCh0aGlzKSB9LFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdmb3JtLWdyb3VwJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGh0bWxGb3I6ICd0aXRsZScgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGl0bGUnXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdmb3JtLWNvbnRyb2wnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAndGl0bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnVGl0bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB0aGlzLmZpZWxkQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3RhdGUudGl0bGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2Zvcm0tZ3JvdXAnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgaHRtbEZvcjogJ3RleHQnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3JlYWN0RHJhZnRXeXNpd3lnLkVkaXRvciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvclN0YXRlOiB0aGlzLnN0YXRlLmVkaXRvclN0YXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvckNsYXNzTmFtZTogJ2Zvcm0tY29udHJvbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25FZGl0b3JTdGF0ZUNoYW5nZTogdGhpcy5vbkVkaXRvclN0YXRlQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhcjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBbJ2lubGluZScsICdsaXN0JywgJ2ZvbnRTaXplJywgJ2ZvbnRGYW1pbHknLCAndGV4dEFsaWduJywgJ2xpbmsnLCAnaGlzdG9yeScsICdjb2xvclBpY2tlciddXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY2hlY2tib3gnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ3B1YmxpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB0aGlzLmZpZWxkQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ6ICEhdGhpcy5zdGF0ZS5wdWJsaWNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIFB1YmxpYydcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudC5BbGVydE1lc3NhZ2UsIHsgb3B0czogYWxlcnRPcHRzIH0pLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnaHInLCBudWxsKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHR5cGU6ICdzdWJtaXQnLCBjbGFzc05hbWU6ICdidG4gYnRuLXByaW1hcnknIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tZmxvcHB5LWRpc2snIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcXHhBMCBTYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnYnInLCBudWxsKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRWRpdENvbXA7XG59KF9yZWFjdDIuZGVmYXVsdC5Db21wb25lbnQpO1xuXG52YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7XG4gICAgcmV0dXJuIF9leHRlbmRzKHt9LCBzdGF0ZSk7XG59O1xuRWRpdENvbXAgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFwU3RhdGVUb1Byb3BzKShFZGl0Q29tcCk7XG5leHBvcnRzLmRlZmF1bHQgPSBFZGl0Q29tcDtcblxuLyoqKi8gfSksXG5cbi8qKiovIDQxMzpcbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG52YXIgYmxvZ0lkID0gd2luZG93LmxvY2FsUGFyYW1zLmJsb2dJZCB8fCAnLTEnO1xudmFyIGluaXRTdGF0ZSA9IHtcbiAgICBpZDogcGFyc2VJbnQoYmxvZ0lkKSxcbiAgICB1c2VyX2lkOiAwLFxuICAgIHVzZXJfbmFtZTogJycsXG4gICAgdGl0bGU6ICcnLFxuICAgIHRleHQ6ICcnLFxuICAgIGRhdGU6ICcnLFxuICAgIHB1YmxpYzogZmFsc2UsXG4gICAgc3RhdHVzOiBudWxsXG59O1xuXG52YXIgYmxvZ0VkaXQgPSBmdW5jdGlvbiBibG9nRWRpdCgpIHtcbiAgICB2YXIgc3RhdGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGluaXRTdGF0ZTtcbiAgICB2YXIgYWN0aW9uID0gYXJndW1lbnRzWzFdO1xuXG4gICAgdmFyIGRhdGEgPSBudWxsO1xuXG4gICAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9TRU5EJzpcbiAgICAgICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAnc2VuZCdcbiAgICAgICAgICAgIH0sIHN0YXRlKTtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3NfZ2V0JztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS51c2VyX2lkID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy51c2VySWQ7XG4gICAgICAgICAgICBkYXRhLnVzZXJfbmFtZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cudXNlck5hbWU7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnRleHQ7XG4gICAgICAgICAgICBkYXRhLnRpdGxlID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEuZGF0ZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cuZGF0ZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gISFhY3Rpb24uZGF0YS5nZXRCbG9nLnB1YmxpYztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9FUlJPUic6XG4gICAgICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBlcnJvcjogYWN0aW9uLmVycm9yXG4gICAgICAgICAgICB9LCBzdGF0ZSk7XG5cbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NFTkQnOlxuICAgICAgICAgICAgZGF0YSA9IF9leHRlbmRzKHt9LCBzdGF0ZSk7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uaWQ7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24udGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24udGl0bGU7XG4gICAgICAgICAgICBkYXRhLnB1YmxpYyA9IGFjdGlvbi5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YSA9IF9leHRlbmRzKHt9LCBzdGF0ZSk7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzX2VkaXQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5kYXRhLmVkaXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS50ZXh0ID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cudGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cucHVibGljO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0JMT0dfRURJVF9FUlJPUic6XG4gICAgICAgICAgICBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGJsb2dFZGl0O1xuXG4vKioqLyB9KVxuXG59LFszMjhdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYmxvZ0VkaXQuanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyByZW5kZXIgfSBmcm9tICdyZWFjdC1kb20nXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gJ3JlYWN0LXJlZHV4J1xuXG5pbXBvcnQgJ2Jvb3RzdHJhcC9kaXN0L2Nzcy9ib290c3RyYXAuY3NzJztcbmltcG9ydCAncmVhY3QtZHJhZnQtd3lzaXd5Zy9kaXN0L3JlYWN0LWRyYWZ0LXd5c2l3eWcuY3NzJztcbmltcG9ydCAnLi9zdHlsZXMvaW5kZXguc2NzcydcblxuaW1wb3J0IHtsYXlvdXR9IGZyb20gJy4vaGVscGVycy9jb21wb25lbnQnXG5pbXBvcnQgRWRpdENvbXAgZnJvbSAnLi9ibG9nL0VkaXRDb21wJ1xuXG5pbXBvcnQgYXV0aCBmcm9tICcuL2F1dGgvTG9naW5SZWQnXG5pbXBvcnQgYmxvZ0VkaXQgZnJvbSAnLi9ibG9nL0VkaXRSZWQnXG5cbmltcG9ydCB7Y29uZmlndXJlU3RvcmV9IGZyb20gJy4vaGVscGVycy9jb25maWd1cmVTdG9yZSdcblxuXG5sZXQgc3RvcmUgPSBjb25maWd1cmVTdG9yZSh7XG5cdGF1dGg6IGF1dGgsXG5cdGJsb2dFZGl0OiBibG9nRWRpdCxcbn0pO1xuXG5sZXQgQ29tcCA9IGxheW91dCh7Y29tcDogRWRpdENvbXAsIGZvckF1dGg6IHRydWV9KTtcbnJlbmRlcihcblx0PFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XG5cdFx0PENvbXAgLz5cblx0PC9Qcm92aWRlcj4sXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JylcbilcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3N0YXRpY19zcmMvYmxvZ0VkaXQuanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnXG5pbXBvcnQge2FwaSwgZ3JhcGhxbH0gZnJvbSAnLi4vaGVscGVycy9hY3Rpb24nXG5pbXBvcnQge0FsZXJ0TWVzc2FnZX0gZnJvbSAnLi4vaGVscGVycy9jb21wb25lbnQnXG5cbmltcG9ydCB7IEVkaXRvclN0YXRlLCBjb252ZXJ0VG9SYXcsIENvbnRlbnRTdGF0ZSB9IGZyb20gJ2RyYWZ0LWpzJztcbmltcG9ydCBkcmFmdFRvSHRtbCBmcm9tICdkcmFmdGpzLXRvLWh0bWwnO1xuaW1wb3J0IGh0bWxUb0RyYWZ0IGZyb20gJ2h0bWwtdG8tZHJhZnRqcyc7XG5pbXBvcnQgeyBFZGl0b3IgfSBmcm9tICdyZWFjdC1kcmFmdC13eXNpd3lnJztcblxuXG5cbmNsYXNzIEVkaXRDb21wIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7Li4ucHJvcHMuYmxvZ0VkaXR9O1xuICAgICAgICB0aGlzLnN0YXRlLmVkaXRvclN0YXRlID0gRWRpdG9yU3RhdGUuY3JlYXRlRW1wdHkoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsTW91bnQgKCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5pZCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5wcm9wcy5kaXNwYXRjaChncmFwaHFsKHtcbiAgICAgICAgICAgIHR5cGU6ICdCTE9HX0dFVCcsXG4gICAgICAgICAgICBpZDogdGhpcy5zdGF0ZS5pZCxcbiAgICAgICAgfSkpO1xuXG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGlmIChuZXh0UHJvcHMuYmxvZ0VkaXQuc3RhdHVzID09ICdzdWNjZXNzX2dldCcpIHtcbiAgICAgICAgICAgIGNvbnN0IGJsb2Nrc0Zyb21IVE1MID0gaHRtbFRvRHJhZnQobmV4dFByb3BzLmJsb2dFZGl0LnRleHQpO1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IENvbnRlbnRTdGF0ZS5jcmVhdGVGcm9tQmxvY2tBcnJheShcbiAgICAgICAgICAgICAgICBibG9ja3NGcm9tSFRNTC5jb250ZW50QmxvY2tzLFxuICAgICAgICAgICAgICAgIGJsb2Nrc0Zyb21IVE1MLmVudGl0eU1hcFxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgdGl0bGU6IG5leHRQcm9wcy5ibG9nRWRpdC50aXRsZSxcbiAgICAgICAgICAgICAgICB0ZXh0OiBuZXh0UHJvcHMuYmxvZ0VkaXQudGV4dCxcbiAgICAgICAgICAgICAgICBwdWJsaWM6IG5leHRQcm9wcy5ibG9nRWRpdC5wdWJsaWMsXG4gICAgICAgICAgICAgICAgZGF0ZTogbmV4dFByb3BzLmJsb2dFZGl0LmRhdGUsXG4gICAgICAgICAgICAgICAgZWRpdG9yU3RhdGU6IEVkaXRvclN0YXRlLmNyZWF0ZVdpdGhDb250ZW50KGNvbnRlbnQpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuXG4gICAgZmllbGRDaGFuZ2UgKGUpIHtcbiAgICAgICAgbGV0IHN0YXRlT2JqID0ge307XG4gICAgICAgIGxldCB2YWwgPSAoZS50YXJnZXQuaWQgPT0gJ3B1YmxpYycpID8gZS50YXJnZXQuY2hlY2tlZCA6IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICBzdGF0ZU9ialtlLnRhcmdldC5pZF0gPSB2YWw7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGVPYmopO1xuICAgIH1cblxuICAgIG9uRWRpdG9yU3RhdGVDaGFuZ2UgKGVkaXRvclN0YXRlKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZWRpdG9yU3RhdGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIGZvcm1TdWJtaXQgKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBsZXQgdGV4dCA9IGRyYWZ0VG9IdG1sKGNvbnZlcnRUb1Jhdyh0aGlzLnN0YXRlLmVkaXRvclN0YXRlLmdldEN1cnJlbnRDb250ZW50KCkpKTtcblxuICAgICAgICBpZiAodGV4dCAmJiAodGV4dC5sZW5ndGggPiA1MTIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogJ0JMT0dfRURJVF9FUlJPUicsXG4gICAgICAgICAgICAgICAgZXJyb3I6ICdUZXh0IGlzIHRvbyBsb25nIScsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnQkxPR19FRElUJyxcbiAgICAgICAgICAgIGlkOiB0aGlzLnN0YXRlLmlkLFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMuc3RhdGUudGl0bGUsXG4gICAgICAgICAgICB0ZXh0OiBkcmFmdFRvSHRtbChjb252ZXJ0VG9SYXcodGhpcy5zdGF0ZS5lZGl0b3JTdGF0ZS5nZXRDdXJyZW50Q29udGVudCgpKSksXG4gICAgICAgICAgICBwdWJsaWM6IHRoaXMuc3RhdGUucHVibGljLFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgcmVuZGVyICgpIHtcbiAgICAgICAgbGV0IGFsZXJ0T3B0cyA9IG51bGw7XG4gICAgXG4gICAgICAgIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ2Vycm9yJykge1xuICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2RhbmdlcicsXG4gICAgICAgICAgICAgICAgdGV4dDogdGhpcy5wcm9wcy5ibG9nRWRpdC5lcnJvciB8fCAnRXJyb3IsIHdyb25nIGJsb2cgZGF0YSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ3NlbmQnKSB7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW5mbycsXG4gICAgICAgICAgICAgICAgdGV4dDogJ0xvYWRpbmcsIHBsZWFzZSB3YWl0JyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ3N1Y2Nlc3NfZWRpdCcpIHtcbiAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICB0ZXh0OiAnQmxvZyBzYXZlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJy9ibG9nLWVkaXQvJyArIHRoaXMucHJvcHMuYmxvZ0VkaXQuaWQ7XG4gICAgICAgICAgICB9LCAxMDAwKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDxkaXY+XG4gICAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17Ojp0aGlzLmZvcm1TdWJtaXR9ID5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0aXRsZVwiPlRpdGxlPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwidGl0bGVcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVGl0bGVcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXs6OnRoaXMuZmllbGRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS50aXRsZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0ZXh0XCI+VGV4dDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxFZGl0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRvclN0YXRlPXt0aGlzLnN0YXRlLmVkaXRvclN0YXRlfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yQ2xhc3NOYW1lPVwiZm9ybS1jb250cm9sXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRWRpdG9yU3RhdGVDaGFuZ2U9ezo6dGhpcy5vbkVkaXRvclN0YXRlQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgdG9vbGJhcj17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM6IFsnaW5saW5lJywgJ2xpc3QnLCAnZm9udFNpemUnLCAnZm9udEZhbWlseScsICd0ZXh0QWxpZ24nLCAnbGluaycsICdoaXN0b3J5JywgJ2NvbG9yUGlja2VyJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjaGVja2JveFwiPlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9J3B1YmxpYycgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9ezo6dGhpcy5maWVsZENoYW5nZX0gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZCA9IHshISB0aGlzLnN0YXRlLnB1YmxpY31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+IFB1YmxpY1xuICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgPEFsZXJ0TWVzc2FnZSBvcHRzPXthbGVydE9wdHN9IC8+XG5cbiAgICAgICAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICAgICAgICA8ZGl2ID5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgY2xhc3NOYW1lPVwiYnRuIGJ0bi1wcmltYXJ5XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9J2dseXBoaWNvbiBnbHlwaGljb24tZmxvcHB5LWRpc2snPjwvc3Bhbj4mbmJzcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFNhdmVcbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICBcbiAgICB9XG59XG5cbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IChzdGF0ZSkgPT4ge1xuICAgIHJldHVybiB7Li4uc3RhdGV9XG59XG5FZGl0Q29tcCA9IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShFZGl0Q29tcClcbmV4cG9ydCBkZWZhdWx0IEVkaXRDb21wXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zdGF0aWNfc3JjL2Jsb2cvRWRpdENvbXAuanMiLCJsZXQgYmxvZ0lkID0gd2luZG93LmxvY2FsUGFyYW1zLmJsb2dJZCB8fCAnLTEnO1xubGV0IGluaXRTdGF0ZSA9IHtcbiAgICBpZDogcGFyc2VJbnQoYmxvZ0lkKSxcbiAgICB1c2VyX2lkOiAwLFxuICAgIHVzZXJfbmFtZTogJycsXG4gICAgdGl0bGU6ICcnLFxuICAgIHRleHQ6ICcnLFxuICAgIGRhdGU6ICcnLFxuICAgIHB1YmxpYzogZmFsc2UsXG4gICAgc3RhdHVzOiBudWxsLFxufTtcblxuY29uc3QgYmxvZ0VkaXQgPSAoc3RhdGUgPSBpbml0U3RhdGUsIGFjdGlvbikgPT4ge1xuICAgIGxldCBkYXRhID0gbnVsbDtcblxuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfU0VORCc6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ3NlbmQnLFxuICAgICAgICAgICAgICAgIC4uLnN0YXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9TVUNDRVNTJzpcbiAgICAgICAgICAgIGRhdGEgPSB7Li4uc3RhdGV9O1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnc3VjY2Vzc19nZXQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5kYXRhLmdldEJsb2cuaWQ7XG4gICAgICAgICAgICBkYXRhLnVzZXJfaWQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnVzZXJJZDtcbiAgICAgICAgICAgIGRhdGEudXNlcl9uYW1lID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy51c2VyTmFtZTtcbiAgICAgICAgICAgIGRhdGEudGV4dCA9IGFjdGlvbi5kYXRhLmdldEJsb2cudGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnRpdGxlO1xuICAgICAgICAgICAgZGF0YS5kYXRlID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy5kYXRlO1xuICAgICAgICAgICAgZGF0YS5wdWJsaWMgPSAhISBhY3Rpb24uZGF0YS5nZXRCbG9nLnB1YmxpYztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9FUlJPUic6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBlcnJvcjogYWN0aW9uLmVycm9yLFxuICAgICAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICBjYXNlICdCTE9HX0VESVRfU0VORCc6XG4gICAgICAgICAgICBkYXRhID0gey4uLnN0YXRlfTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3NlbmQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5pZDtcbiAgICAgICAgICAgIGRhdGEudGV4dCA9IGFjdGlvbi50ZXh0O1xuICAgICAgICAgICAgZGF0YS50aXRsZSA9IGFjdGlvbi50aXRsZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gYWN0aW9uLnB1YmxpYztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdCTE9HX0VESVRfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhID0gey4uLnN0YXRlfTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3NfZWRpdCc7XG4gICAgICAgICAgICBkYXRhLmlkID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cuaWQ7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy50ZXh0O1xuICAgICAgICAgICAgZGF0YS50aXRsZSA9IGFjdGlvbi5kYXRhLmVkaXRCbG9nLnRpdGxlO1xuICAgICAgICAgICAgZGF0YS5wdWJsaWMgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19FRElUX0VSUk9SJzpcbiAgICAgICAgICAgIGRhdGEgPSB7Li4uc3RhdGV9O1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgICAgICAgZGF0YS5lcnJvciA9IGFjdGlvbi5lcnJvcjtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuXG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgYmxvZ0VkaXRcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zdGF0aWNfc3JjL2Jsb2cvRWRpdFJlZC5qcyJdLCJzb3VyY2VSb290IjoiIn0=