webpackJsonp([7],{331:function(t,e,a){"use strict";function l(t){return t&&t.__esModule?t:{default:t}}var r=a(2),i=l(r),n=a(11),o=a(7);a(19),a(145),a(20);var s=a(9),u=a(333),c=l(u),d=a(21),f=l(d),p=a(334),b=l(p),h=a(22),g=(0,h.configureStore)({auth:f.default,blogEdit:b.default}),m=(0,s.layout)({comp:c.default,forAuth:!0});(0,n.render)(i.default.createElement(o.Provider,{store:g},i.default.createElement(m,null)),document.getElementById("root"))},333:function(t,e,a){"use strict";function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},o=function(){function t(t,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(e,a,l){return a&&t(e.prototype,a),l&&t(e,l),e}}(),s=a(2),u=function(t){return t&&t.__esModule?t:{default:t}}(s),c=a(7),d=a(25),f=a(9),p=function(t){function e(t){l(this,e);var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return a.state=n({},t.blogEdit),a}return i(e,t),o(e,[{key:"componentWillMount",value:function(){-1!==this.state.id&&this.props.dispatch((0,d.graphql)({type:"BLOG_GET",id:this.state.id}))}},{key:"componentWillReceiveProps",value:function(t){"success_get"==t.blogEdit.status&&this.setState({title:t.blogEdit.title,text:t.blogEdit.text,public:t.blogEdit.public,date:t.blogEdit.date})}},{key:"fieldChange",value:function(t){var e={},a="public"==t.target.id?t.target.checked:t.target.value;e[t.target.id]=a,this.setState(e)}},{key:"formSubmit",value:function(t){if(t.preventDefault(),text&&text.length>512)return this.props.dispatch({type:"BLOG_EDIT_ERROR",error:"Text is too long!"});this.props.dispatch((0,d.graphql)({type:"BLOG_EDIT",id:this.state.id,title:this.state.title,text:this.state.text,public:this.state.public}))}},{key:"render",value:function(){var t=this,e=null;return"error"===this.props.blogEdit.status?e={className:"danger",text:this.props.blogEdit.error||"Error, wrong blog data"}:"send"===this.props.blogEdit.status?e={className:"info",text:"Loading, please wait"}:"success_edit"===this.props.blogEdit.status&&(e={className:"success",text:"Blog saved successfully"},setTimeout(function(){window.location="/blog-edit/"+t.props.blogEdit.id},1e3)),u.default.createElement("div",null,u.default.createElement("ol",{className:"breadcrumb"},u.default.createElement("li",null,u.default.createElement("a",{href:"/my-blogs"},"My Blogs")),u.default.createElement("li",{className:"active"},this.state.title?this.state.title:null)),u.default.createElement("form",{onSubmit:this.formSubmit.bind(this)},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{htmlFor:"title"},"Title"),u.default.createElement("input",{required:!0,type:"text",className:"form-control",id:"title",placeholder:"Title",onChange:this.fieldChange.bind(this),value:this.state.title})),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{htmlFor:"text"},"Text"),u.default.createElement("textarea",{required:!0,className:"form-control",id:"text",placeholder:"Text",onChange:this.fieldChange.bind(this),value:this.state.text})),u.default.createElement("div",{className:"checkbox"},u.default.createElement("label",null,u.default.createElement("input",{type:"checkbox",id:"public",onChange:this.fieldChange.bind(this),checked:!!this.state.public})," Public")),u.default.createElement(f.AlertMessage,{opts:e}),u.default.createElement("hr",null),u.default.createElement("div",null,u.default.createElement("button",{type:"submit",className:"btn btn-primary"},u.default.createElement("span",{className:"glyphicon glyphicon-floppy-disk"}),"Â  Save")),u.default.createElement("br",null)))}}]),e}(u.default.Component),b=function(t){return n({},t)};p=(0,c.connect)(b)(p),e.default=p},334:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},r=window.localParams.blogId||"-1",i={id:parseInt(r),user_id:0,user_name:"",title:"",text:"",date:"",public:!1,status:null},n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,e=arguments[1],a=null;switch(e.type){case"BLOG_GET_SEND":return l({status:"send"},t);case"BLOG_GET_SUCCESS":return a=l({},t),a.status="success_get",a.id=e.data.getBlog.id,a.user_id=e.data.getBlog.userId,a.user_name=e.data.getBlog.userName,a.text=e.data.getBlog.text,a.title=e.data.getBlog.title,a.date=e.data.getBlog.date,a.public=!!e.data.getBlog.public,a;case"BLOG_GET_ERROR":return l({status:"error",error:e.error},t);case"BLOG_EDIT_SEND":return a=l({},t),a.status="send",a.id=e.id,a.text=e.text,a.title=e.title,a.public=e.public,a;case"BLOG_EDIT_SUCCESS":return a=l({},t),a.status="success_edit",a.id=e.data.editBlog.id,a.text=e.data.editBlog.text,a.title=e.data.editBlog.title,a.public=e.data.editBlog.public,a;case"BLOG_EDIT_ERROR":return a=l({},t),a.status="error",a.error=e.error,a;default:return t}};e.default=n}},[331]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vYmxvZ0VkaXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9ibG9nRWRpdC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWNfc3JjL2Jsb2cvRWRpdENvbXAuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljX3NyYy9ibG9nL0VkaXRSZWQuanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wIiwiMzMxIiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfcmVhY3QiLCJfcmVhY3QyIiwiX3JlYWN0RG9tIiwiX3JlYWN0UmVkdXgiLCJfY29tcG9uZW50IiwiX0VkaXRDb21wIiwiX0VkaXRDb21wMiIsIl9Mb2dpblJlZCIsIl9Mb2dpblJlZDIiLCJfRWRpdFJlZCIsIl9FZGl0UmVkMiIsIl9jb25maWd1cmVTdG9yZSIsInN0b3JlIiwiY29uZmlndXJlU3RvcmUiLCJhdXRoIiwiYmxvZ0VkaXQiLCJDb21wIiwibGF5b3V0IiwiY29tcCIsIkVkaXRDb21wIiwiZm9yQXV0aCIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJQcm92aWRlciIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCIzMzMiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImNvbmZpZ3VyYWJsZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiZGVmaW5lUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInRhcmdldCIsImkiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJzb3VyY2UiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfYWN0aW9uIiwiX1JlYWN0JENvbXBvbmVudCIsInRoaXMiLCJfdGhpcyIsImdldFByb3RvdHlwZU9mIiwic3RhdGUiLCJpZCIsImRpc3BhdGNoIiwiZ3JhcGhxbCIsInR5cGUiLCJuZXh0UHJvcHMiLCJzdGF0dXMiLCJzZXRTdGF0ZSIsInRpdGxlIiwidGV4dCIsInB1YmxpYyIsImRhdGUiLCJlIiwic3RhdGVPYmoiLCJ2YWwiLCJjaGVja2VkIiwicHJldmVudERlZmF1bHQiLCJlcnJvciIsIl90aGlzMiIsImFsZXJ0T3B0cyIsImNsYXNzTmFtZSIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJvblN1Ym1pdCIsImZvcm1TdWJtaXQiLCJiaW5kIiwiaHRtbEZvciIsInJlcXVpcmVkIiwicGxhY2Vob2xkZXIiLCJvbkNoYW5nZSIsImZpZWxkQ2hhbmdlIiwiQWxlcnRNZXNzYWdlIiwib3B0cyIsIlJlYWN0IiwiQ29tcG9uZW50IiwibWFwU3RhdGVUb1Byb3BzIiwiY29ubmVjdCIsIjMzNCIsImJsb2dJZCIsImxvY2FsUGFyYW1zIiwiaW5pdFN0YXRlIiwicGFyc2VJbnQiLCJ1c2VyX2lkIiwidXNlcl9uYW1lIiwidW5kZWZpbmVkIiwiYWN0aW9uIiwiZGF0YSIsImdldEJsb2ciLCJ1c2VySWQiLCJ1c2VyTmFtZSIsImVkaXRCbG9nIl0sIm1hcHBpbmdzIjoiQUFBQUEsY0FBYyxJQUVSQyxJQUNBLFNBQVVDLEVBQVFDLEVBQVNDLEdBRWpDLFlBaUNBLFNBQVNDLEdBQXVCQyxHQUFPLE1BQU9BLElBQU9BLEVBQUlDLFdBQWFELEdBQVFFLFFBQVNGLEdDdEN2RixHQUFBRyxHQUFBTCxFQUFB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QUtJLFNBQVNuRCxHQUMvQitDLEVBQUt2QyxLQUFPc0MsRUFBT0MsS0FBS0ksU0FBUzNDLEtBQ2pDdUMsRUFBS3hDLE1BQVF1QyxFQUFPQyxLQUFLSSxTQUFTNUMsTUFDbEN3QyxFQUFLdEMsT0FBU3FDLEVBQU9DLEtBQUtJLFNBQVMxQyxPQUM1QnNDLENBQ1gsS0FBSyxrQkFJRCxNQUhBQSxRQUFXaEQsR0FDWGdELEVBQUsxQyxPQUFTLFFBQ2QwQyxFQUFLL0IsTUFBUThCLEVBQU85QixNQUNiK0IsQ0FHWCxTQUNJLE1BQU9oRCxJSHdTbkIzRSxHQUFRSyxRR3BTT2dCLEtId1NaIiwiZmlsZSI6ImJsb2dFZGl0LmpzIiwic291cmNlc0NvbnRlbnQiOlsid2VicGFja0pzb25wKFs3XSx7XG5cbi8qKiovIDMzMTpcbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cbnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXG52YXIgX3JlYWN0RG9tID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7XG5cbnZhciBfcmVhY3RSZWR1eCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cbl9fd2VicGFja19yZXF1aXJlX18oMTkpO1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDE0NSk7XG5cbl9fd2VicGFja19yZXF1aXJlX18oMjApO1xuXG52YXIgX2NvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cbnZhciBfRWRpdENvbXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzMyk7XG5cbnZhciBfRWRpdENvbXAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRWRpdENvbXApO1xuXG52YXIgX0xvZ2luUmVkID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7XG5cbnZhciBfTG9naW5SZWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTG9naW5SZWQpO1xuXG52YXIgX0VkaXRSZWQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzNCk7XG5cbnZhciBfRWRpdFJlZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9FZGl0UmVkKTtcblxudmFyIF9jb25maWd1cmVTdG9yZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgc3RvcmUgPSAoMCwgX2NvbmZpZ3VyZVN0b3JlLmNvbmZpZ3VyZVN0b3JlKSh7XG5cdGF1dGg6IF9Mb2dpblJlZDIuZGVmYXVsdCxcblx0YmxvZ0VkaXQ6IF9FZGl0UmVkMi5kZWZhdWx0XG59KTtcblxudmFyIENvbXAgPSAoMCwgX2NvbXBvbmVudC5sYXlvdXQpKHsgY29tcDogX0VkaXRDb21wMi5kZWZhdWx0LCBmb3JBdXRoOiB0cnVlIH0pO1xuKDAsIF9yZWFjdERvbS5yZW5kZXIpKF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuXHRfcmVhY3RSZWR1eC5Qcm92aWRlcixcblx0eyBzdG9yZTogc3RvcmUgfSxcblx0X3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29tcCwgbnVsbClcbiksIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JykpO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gMzMzOlxuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcblxuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXG52YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblxudmFyIF9yZWFjdFJlZHV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxudmFyIF9hY3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI1KTtcblxudmFyIF9jb21wb25lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBFZGl0Q29tcCA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gICAgX2luaGVyaXRzKEVkaXRDb21wLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICAgIGZ1bmN0aW9uIEVkaXRDb21wKHByb3BzKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFZGl0Q29tcCk7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEVkaXRDb21wLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRWRpdENvbXApKS5jYWxsKHRoaXMsIHByb3BzKSk7XG5cbiAgICAgICAgX3RoaXMuc3RhdGUgPSBfZXh0ZW5kcyh7fSwgcHJvcHMuYmxvZ0VkaXQpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEVkaXRDb21wLCBbe1xuICAgICAgICBrZXk6ICdjb21wb25lbnRXaWxsTW91bnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUuaWQgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnByb3BzLmRpc3BhdGNoKCgwLCBfYWN0aW9uLmdyYXBocWwpKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnQkxPR19HRVQnLFxuICAgICAgICAgICAgICAgIGlkOiB0aGlzLnN0YXRlLmlkXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgICAgIGlmIChuZXh0UHJvcHMuYmxvZ0VkaXQuc3RhdHVzID09ICdzdWNjZXNzX2dldCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IG5leHRQcm9wcy5ibG9nRWRpdC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogbmV4dFByb3BzLmJsb2dFZGl0LnRleHQsXG4gICAgICAgICAgICAgICAgICAgIHB1YmxpYzogbmV4dFByb3BzLmJsb2dFZGl0LnB1YmxpYyxcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogbmV4dFByb3BzLmJsb2dFZGl0LmRhdGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZmllbGRDaGFuZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmllbGRDaGFuZ2UoZSkge1xuICAgICAgICAgICAgdmFyIHN0YXRlT2JqID0ge307XG4gICAgICAgICAgICB2YXIgdmFsID0gZS50YXJnZXQuaWQgPT0gJ3B1YmxpYycgPyBlLnRhcmdldC5jaGVja2VkIDogZS50YXJnZXQudmFsdWU7XG4gICAgICAgICAgICBzdGF0ZU9ialtlLnRhcmdldC5pZF0gPSB2YWw7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlT2JqKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZm9ybVN1Ym1pdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtU3VibWl0KGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgaWYgKHRleHQgJiYgdGV4dC5sZW5ndGggPiA1MTIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdCTE9HX0VESVRfRVJST1InLFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ1RleHQgaXMgdG9vIGxvbmchJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnByb3BzLmRpc3BhdGNoKCgwLCBfYWN0aW9uLmdyYXBocWwpKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnQkxPR19FRElUJyxcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5zdGF0ZS5pZCxcbiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5zdGF0ZS50aXRsZSxcbiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnN0YXRlLnRleHQsXG4gICAgICAgICAgICAgICAgcHVibGljOiB0aGlzLnN0YXRlLnB1YmxpY1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW5kZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBhbGVydE9wdHMgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2RhbmdlcicsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMuYmxvZ0VkaXQuZXJyb3IgfHwgJ0Vycm9yLCB3cm9uZyBibG9nIGRhdGEnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT09ICdzZW5kJykge1xuICAgICAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnaW5mbycsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdMb2FkaW5nLCBwbGVhc2Ugd2FpdCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PT0gJ3N1Y2Nlc3NfZWRpdCcpIHtcbiAgICAgICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnQmxvZyBzYXZlZCBzdWNjZXNzZnVsbHknXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJy9ibG9nLWVkaXQvJyArIF90aGlzMi5wcm9wcy5ibG9nRWRpdC5pZDtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICdvbCcsXG4gICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnYnJlYWRjcnVtYicgfSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnbGknLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGhyZWY6ICcvbXktYmxvZ3MnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ015IEJsb2dzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdsaScsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2FjdGl2ZScgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUudGl0bGUgPyB0aGlzLnN0YXRlLnRpdGxlIDogbnVsbFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgJ2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICB7IG9uU3VibWl0OiB0aGlzLmZvcm1TdWJtaXQuYmluZCh0aGlzKSB9LFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdmb3JtLWdyb3VwJyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGh0bWxGb3I6ICd0aXRsZScgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnVGl0bGUnXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdmb3JtLWNvbnRyb2wnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiAndGl0bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnVGl0bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB0aGlzLmZpZWxkQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3RhdGUudGl0bGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2Zvcm0tZ3JvdXAnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgaHRtbEZvcjogJ3RleHQnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2Zvcm0tY29udHJvbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ1RleHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB0aGlzLmZpZWxkQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc3RhdGUudGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY2hlY2tib3gnIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGFiZWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ3B1YmxpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB0aGlzLmZpZWxkQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ6ICEhdGhpcy5zdGF0ZS5wdWJsaWNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnIFB1YmxpYydcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX2NvbXBvbmVudC5BbGVydE1lc3NhZ2UsIHsgb3B0czogYWxlcnRPcHRzIH0pLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnaHInLCBudWxsKSxcbiAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYnV0dG9uJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHR5cGU6ICdzdWJtaXQnLCBjbGFzc05hbWU6ICdidG4gYnRuLXByaW1hcnknIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogJ2dseXBoaWNvbiBnbHlwaGljb24tZmxvcHB5LWRpc2snIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdcXHhBMCBTYXZlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudCgnYnInLCBudWxsKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRWRpdENvbXA7XG59KF9yZWFjdDIuZGVmYXVsdC5Db21wb25lbnQpO1xuXG52YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7XG4gICAgcmV0dXJuIF9leHRlbmRzKHt9LCBzdGF0ZSk7XG59O1xuRWRpdENvbXAgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFwU3RhdGVUb1Byb3BzKShFZGl0Q29tcCk7XG5leHBvcnRzLmRlZmF1bHQgPSBFZGl0Q29tcDtcblxuLyoqKi8gfSksXG5cbi8qKiovIDMzNDpcbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXG52YXIgYmxvZ0lkID0gd2luZG93LmxvY2FsUGFyYW1zLmJsb2dJZCB8fCAnLTEnO1xudmFyIGluaXRTdGF0ZSA9IHtcbiAgICBpZDogcGFyc2VJbnQoYmxvZ0lkKSxcbiAgICB1c2VyX2lkOiAwLFxuICAgIHVzZXJfbmFtZTogJycsXG4gICAgdGl0bGU6ICcnLFxuICAgIHRleHQ6ICcnLFxuICAgIGRhdGU6ICcnLFxuICAgIHB1YmxpYzogZmFsc2UsXG4gICAgc3RhdHVzOiBudWxsXG59O1xuXG52YXIgYmxvZ0VkaXQgPSBmdW5jdGlvbiBibG9nRWRpdCgpIHtcbiAgICB2YXIgc3RhdGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGluaXRTdGF0ZTtcbiAgICB2YXIgYWN0aW9uID0gYXJndW1lbnRzWzFdO1xuXG4gICAgdmFyIGRhdGEgPSBudWxsO1xuXG4gICAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9TRU5EJzpcbiAgICAgICAgICAgIHJldHVybiBfZXh0ZW5kcyh7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAnc2VuZCdcbiAgICAgICAgICAgIH0sIHN0YXRlKTtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3NfZ2V0JztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS51c2VyX2lkID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy51c2VySWQ7XG4gICAgICAgICAgICBkYXRhLnVzZXJfbmFtZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cudXNlck5hbWU7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnRleHQ7XG4gICAgICAgICAgICBkYXRhLnRpdGxlID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEuZGF0ZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cuZGF0ZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gISFhY3Rpb24uZGF0YS5nZXRCbG9nLnB1YmxpYztcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICBjYXNlICdCTE9HX0dFVF9FUlJPUic6XG4gICAgICAgICAgICByZXR1cm4gX2V4dGVuZHMoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBlcnJvcjogYWN0aW9uLmVycm9yXG4gICAgICAgICAgICB9LCBzdGF0ZSk7XG5cbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NFTkQnOlxuICAgICAgICAgICAgZGF0YSA9IF9leHRlbmRzKHt9LCBzdGF0ZSk7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uaWQ7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24udGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24udGl0bGU7XG4gICAgICAgICAgICBkYXRhLnB1YmxpYyA9IGFjdGlvbi5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YSA9IF9leHRlbmRzKHt9LCBzdGF0ZSk7XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzX2VkaXQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5kYXRhLmVkaXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS50ZXh0ID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cudGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cucHVibGljO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0JMT0dfRURJVF9FUlJPUic6XG4gICAgICAgICAgICBkYXRhID0gX2V4dGVuZHMoe30sIHN0YXRlKTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGJsb2dFZGl0O1xuXG4vKioqLyB9KVxuXG59LFszMzFdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gYmxvZ0VkaXQuanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyByZW5kZXIgfSBmcm9tICdyZWFjdC1kb20nXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gJ3JlYWN0LXJlZHV4J1xuXG5pbXBvcnQgJ2Jvb3RzdHJhcC9kaXN0L2Nzcy9ib290c3RyYXAuY3NzJztcbmltcG9ydCAncmVhY3QtZHJhZnQtd3lzaXd5Zy9kaXN0L3JlYWN0LWRyYWZ0LXd5c2l3eWcuY3NzJztcbmltcG9ydCAnLi9zdHlsZXMvaW5kZXguc2NzcydcblxuaW1wb3J0IHtsYXlvdXR9IGZyb20gJy4vaGVscGVycy9jb21wb25lbnQnXG5pbXBvcnQgRWRpdENvbXAgZnJvbSAnLi9ibG9nL0VkaXRDb21wJ1xuXG5pbXBvcnQgYXV0aCBmcm9tICcuL2F1dGgvTG9naW5SZWQnXG5pbXBvcnQgYmxvZ0VkaXQgZnJvbSAnLi9ibG9nL0VkaXRSZWQnXG5cbmltcG9ydCB7Y29uZmlndXJlU3RvcmV9IGZyb20gJy4vaGVscGVycy9jb25maWd1cmVTdG9yZSdcblxuXG5sZXQgc3RvcmUgPSBjb25maWd1cmVTdG9yZSh7XG5cdGF1dGg6IGF1dGgsXG5cdGJsb2dFZGl0OiBibG9nRWRpdCxcbn0pO1xuXG5sZXQgQ29tcCA9IGxheW91dCh7Y29tcDogRWRpdENvbXAsIGZvckF1dGg6IHRydWV9KTtcbnJlbmRlcihcblx0PFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XG5cdFx0PENvbXAgLz5cblx0PC9Qcm92aWRlcj4sXG5cdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb290JylcbilcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3N0YXRpY19zcmMvYmxvZ0VkaXQuanMiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnXG5pbXBvcnQge2FwaSwgZ3JhcGhxbH0gZnJvbSAnLi4vaGVscGVycy9hY3Rpb24nXG5pbXBvcnQge0FsZXJ0TWVzc2FnZX0gZnJvbSAnLi4vaGVscGVycy9jb21wb25lbnQnXG5cblxuY2xhc3MgRWRpdENvbXAgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHsuLi5wcm9wcy5ibG9nRWRpdH07XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbE1vdW50ICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuaWQgPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMucHJvcHMuZGlzcGF0Y2goZ3JhcGhxbCh7XG4gICAgICAgICAgICB0eXBlOiAnQkxPR19HRVQnLFxuICAgICAgICAgICAgaWQ6IHRoaXMuc3RhdGUuaWQsXG4gICAgICAgIH0pKTtcblxuICAgIH1cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgICAgICBpZiAobmV4dFByb3BzLmJsb2dFZGl0LnN0YXR1cyA9PSAnc3VjY2Vzc19nZXQnKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogbmV4dFByb3BzLmJsb2dFZGl0LnRpdGxlLFxuICAgICAgICAgICAgICAgIHRleHQ6IG5leHRQcm9wcy5ibG9nRWRpdC50ZXh0LFxuICAgICAgICAgICAgICAgIHB1YmxpYzogbmV4dFByb3BzLmJsb2dFZGl0LnB1YmxpYyxcbiAgICAgICAgICAgICAgICBkYXRlOiBuZXh0UHJvcHMuYmxvZ0VkaXQuZGF0ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cblxuICAgIGZpZWxkQ2hhbmdlIChlKSB7XG4gICAgICAgIGxldCBzdGF0ZU9iaiA9IHt9O1xuICAgICAgICBsZXQgdmFsID0gKGUudGFyZ2V0LmlkID09ICdwdWJsaWMnKSA/IGUudGFyZ2V0LmNoZWNrZWQgOiBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgc3RhdGVPYmpbZS50YXJnZXQuaWRdID0gdmFsO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHN0YXRlT2JqKTtcbiAgICB9XG4gICAgXG4gICAgZm9ybVN1Ym1pdCAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKHRleHQgJiYgKHRleHQubGVuZ3RoID4gNTEyKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdCTE9HX0VESVRfRVJST1InLFxuICAgICAgICAgICAgICAgIGVycm9yOiAnVGV4dCBpcyB0b28gbG9uZyEnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb3BzLmRpc3BhdGNoKGdyYXBocWwoe1xuICAgICAgICAgICAgdHlwZTogJ0JMT0dfRURJVCcsXG4gICAgICAgICAgICBpZDogdGhpcy5zdGF0ZS5pZCxcbiAgICAgICAgICAgIHRpdGxlOiB0aGlzLnN0YXRlLnRpdGxlLFxuICAgICAgICAgICAgdGV4dDogdGhpcy5zdGF0ZS50ZXh0LFxuICAgICAgICAgICAgcHVibGljOiB0aGlzLnN0YXRlLnB1YmxpYyxcbiAgICAgICAgfSkpO1xuICAgIH1cblxuICAgIHJlbmRlciAoKSB7XG4gICAgICAgIGxldCBhbGVydE9wdHMgPSBudWxsO1xuICAgIFxuICAgICAgICBpZiAodGhpcy5wcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIGFsZXJ0T3B0cyA9IHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdkYW5nZXInLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMucHJvcHMuYmxvZ0VkaXQuZXJyb3IgfHwgJ0Vycm9yLCB3cm9uZyBibG9nIGRhdGEnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT09ICdzZW5kJykge1xuICAgICAgICAgICAgYWxlcnRPcHRzID0ge1xuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2luZm8nLFxuICAgICAgICAgICAgICAgIHRleHQ6ICdMb2FkaW5nLCBwbGVhc2Ugd2FpdCcsXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5ibG9nRWRpdC5zdGF0dXMgPT09ICdzdWNjZXNzX2VkaXQnKSB7XG4gICAgICAgICAgICBhbGVydE9wdHMgPSB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnc3VjY2VzcycsXG4gICAgICAgICAgICAgICAgdGV4dDogJ0Jsb2cgc2F2ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9ICcvYmxvZy1lZGl0LycgKyB0aGlzLnByb3BzLmJsb2dFZGl0LmlkO1xuICAgICAgICAgICAgfSwgMTAwMClcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiA8ZGl2PlxuICAgICAgICAgICAgIDxvbCBjbGFzc05hbWU9XCJicmVhZGNydW1iXCI+XG4gICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9XCIvbXktYmxvZ3NcIj5NeSBCbG9nczwvYT48L2xpPlxuICAgICAgICAgICAgICAgIDxsaSBjbGFzc05hbWU9XCJhY3RpdmVcIj57dGhpcy5zdGF0ZS50aXRsZSA/IHRoaXMuc3RhdGUudGl0bGUgOiBudWxsfTwvbGk+XG4gICAgICAgICAgICA8L29sPlxuXG4gICAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17Ojp0aGlzLmZvcm1TdWJtaXR9ID5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0aXRsZVwiPlRpdGxlPC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCIgXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwidGl0bGVcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiVGl0bGVcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXs6OnRoaXMuZmllbGRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS50aXRsZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJ0ZXh0XCI+VGV4dDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIiBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkPSd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9J1RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17Ojp0aGlzLmZpZWxkQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUudGV4dH1cbiAgICAgICAgICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2hlY2tib3hcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJjaGVja2JveFwiIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSdwdWJsaWMnIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXs6OnRoaXMuZmllbGRDaGFuZ2V9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQgPSB7ISEgdGhpcy5zdGF0ZS5wdWJsaWN9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPiBQdWJsaWNcbiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgIDxBbGVydE1lc3NhZ2Ugb3B0cz17YWxlcnRPcHRzfSAvPlxuXG4gICAgICAgICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgICAgICAgPGRpdiA+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cInN1Ym1pdFwiIGNsYXNzTmFtZT1cImJ0biBidG4tcHJpbWFyeVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdnbHlwaGljb24gZ2x5cGhpY29uLWZsb3BweS1kaXNrJz48L3NwYW4+Jm5ic3A7XG4gICAgICAgICAgICAgICAgICAgICAgICBTYXZlXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgfVxufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGUpID0+IHtcbiAgICByZXR1cm4gey4uLnN0YXRlfVxufVxuRWRpdENvbXAgPSBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcykoRWRpdENvbXApXG5leHBvcnQgZGVmYXVsdCBFZGl0Q29tcFxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy9ibG9nL0VkaXRDb21wLmpzIiwibGV0IGJsb2dJZCA9IHdpbmRvdy5sb2NhbFBhcmFtcy5ibG9nSWQgfHwgJy0xJztcbmxldCBpbml0U3RhdGUgPSB7XG4gICAgaWQ6IHBhcnNlSW50KGJsb2dJZCksXG4gICAgdXNlcl9pZDogMCxcbiAgICB1c2VyX25hbWU6ICcnLFxuICAgIHRpdGxlOiAnJyxcbiAgICB0ZXh0OiAnJyxcbiAgICBkYXRlOiAnJyxcbiAgICBwdWJsaWM6IGZhbHNlLFxuICAgIHN0YXR1czogbnVsbCxcbn07XG5cbmNvbnN0IGJsb2dFZGl0ID0gKHN0YXRlID0gaW5pdFN0YXRlLCBhY3Rpb24pID0+IHtcbiAgICBsZXQgZGF0YSA9IG51bGw7XG5cbiAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgIGNhc2UgJ0JMT0dfR0VUX1NFTkQnOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdzZW5kJyxcbiAgICAgICAgICAgICAgICAuLi5zdGF0ZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfU1VDQ0VTUyc6XG4gICAgICAgICAgICBkYXRhID0gey4uLnN0YXRlfTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ3N1Y2Nlc3NfZ2V0JztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS51c2VyX2lkID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy51c2VySWQ7XG4gICAgICAgICAgICBkYXRhLnVzZXJfbmFtZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cudXNlck5hbWU7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24uZGF0YS5nZXRCbG9nLnRleHQ7XG4gICAgICAgICAgICBkYXRhLnRpdGxlID0gYWN0aW9uLmRhdGEuZ2V0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEuZGF0ZSA9IGFjdGlvbi5kYXRhLmdldEJsb2cuZGF0ZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gISEgYWN0aW9uLmRhdGEuZ2V0QmxvZy5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19HRVRfRVJST1InOlxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGFjdGlvbi5lcnJvcixcbiAgICAgICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NFTkQnOlxuICAgICAgICAgICAgZGF0YSA9IHsuLi5zdGF0ZX07XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzZW5kJztcbiAgICAgICAgICAgIGRhdGEuaWQgPSBhY3Rpb24uaWQ7XG4gICAgICAgICAgICBkYXRhLnRleHQgPSBhY3Rpb24udGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24udGl0bGU7XG4gICAgICAgICAgICBkYXRhLnB1YmxpYyA9IGFjdGlvbi5wdWJsaWM7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgY2FzZSAnQkxPR19FRElUX1NVQ0NFU1MnOlxuICAgICAgICAgICAgZGF0YSA9IHsuLi5zdGF0ZX07XG4gICAgICAgICAgICBkYXRhLnN0YXR1cyA9ICdzdWNjZXNzX2VkaXQnO1xuICAgICAgICAgICAgZGF0YS5pZCA9IGFjdGlvbi5kYXRhLmVkaXRCbG9nLmlkO1xuICAgICAgICAgICAgZGF0YS50ZXh0ID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cudGV4dDtcbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBhY3Rpb24uZGF0YS5lZGl0QmxvZy50aXRsZTtcbiAgICAgICAgICAgIGRhdGEucHVibGljID0gYWN0aW9uLmRhdGEuZWRpdEJsb2cucHVibGljO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIGNhc2UgJ0JMT0dfRURJVF9FUlJPUic6XG4gICAgICAgICAgICBkYXRhID0gey4uLnN0YXRlfTtcbiAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgICAgICAgIGRhdGEuZXJyb3IgPSBhY3Rpb24uZXJyb3I7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcblxuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gc3RhdGVcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGJsb2dFZGl0XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3RhdGljX3NyYy9ibG9nL0VkaXRSZWQuanMiXSwic291cmNlUm9vdCI6IiJ9